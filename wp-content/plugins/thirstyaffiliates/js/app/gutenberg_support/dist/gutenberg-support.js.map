{"version":3,"sources":["webpack:///gutenberg-support.js","webpack:///webpack/bootstrap b4e546eb9d17ec651f70","webpack:///./node_modules/classnames/index.js","webpack:///./src/index.js","webpack:///./src/blocks/index.js","webpack:///./src/blocks/ta-image/index.js","webpack:///./src/blocks/ta-image/edit.js","webpack:///./src/blocks/ta-image/util.js","webpack:///./src/blocks/ta-image/image-size.js","webpack:///./src/blocks/ta-image/search-input.js","webpack:///./src/formats/index.js","webpack:///./src/formats/ta-link/index.js","webpack:///./src/formats/ta-link/inline.js","webpack:///./src/formats/ta-link/positioned-at-selection.js","webpack:///./src/formats/ta-link/utils.js","webpack:///./src/formats/ta-link/url-popover.js","webpack:///./src/formats/ta-link/url-input.js","webpack:///./node_modules/dom-scroll-into-view/lib/index.js","webpack:///./node_modules/dom-scroll-into-view/lib/dom-scroll-into-view.js","webpack:///./node_modules/dom-scroll-into-view/lib/util.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","classNames","classes","arguments","length","arg","argType","push","Array","isArray","inner","apply","key","hasOwn","join","default","undefined","__webpack_exports__","value","__WEBPACK_IMPORTED_MODULE_0__blocks__","__WEBPACK_IMPORTED_MODULE_1__formats__","__WEBPACK_IMPORTED_MODULE_2__assets_styles_index_scss__","registerBlocks","registerFormats","taimage","forEach","block","settings","registerBlockType","__WEBPACK_IMPORTED_MODULE_0__ta_image__","wp","blocks","_defineProperty","obj","writable","__WEBPACK_IMPORTED_MODULE_0_classnames__","__WEBPACK_IMPORTED_MODULE_0_classnames___default","__WEBPACK_IMPORTED_MODULE_1__edit__","Fragment","element","__","i18n","_wp$blocks","createBlock","getBlockAttributes","getPhrasingContentSchema","RichText","editor","_wp$components","components","Path","SVG","blockAttributes","url","type","source","selector","attribute","alt","caption","id","align","width","height","linkid","href","affiliateLink","imageSchema","img","attributes","schema","figure","require","children","ta","figcaption","title","description","icon","createElement","viewBox","xmlns","fill","category","keywords","transforms","from","isMatch","node","nodeName","querySelector","transform","className","alignMatches","exec","idMatches","Number","anchorElement","linkDestination","rel","linkClass","outerHTML","files","indexOf","file","createBlobURL","tag","shortcode","_ref","_document$implementat2","document","implementation","createHTMLDocument","body","innerHTML","content","removeChild","firstElementChild","trim","_ref2","named","parseInt","replace","_ref3","_ref3$named$align","getEditWrapperProps","data-align","data-resized","edit","save","_ref4","_classnames","classnames","image","src","Content","tagName","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","__WEBPACK_IMPORTED_MODULE_1__util__","__WEBPACK_IMPORTED_MODULE_2__image_size__","__WEBPACK_IMPORTED_MODULE_3__search_input__","_extends","assign","target","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","err","_createClass","defineProperties","props","descriptor","protoProps","staticProps","_lodash","lodash","isEmpty","map","last","pick","compact","getPath","_wp$i18n","sprintf","_wp$element","Component","createRef","_wp$blob","blob","getBlobByURL","revokeBlobURL","isBlobURL","Placeholder","Button","ButtonGroup","IconButton","PanelBody","ResizableBox","SelectControl","Spinner","TextControl","TextareaControl","Toolbar","withNotices","withSelect","ToggleControl","Popover","data","_wp$editor","BlockControls","InspectorControls","BlockAlignmentToolbar","MediaUpload","MediaUploadCheck","MediaPlaceholder","mediaUpload","withViewportMatch","viewport","compose","ALLOWED_MEDIA_TYPES","pickRelevantMediaFiles","imageProps","isTemporaryImage","ImageEdit","_Component","this","_this","getPrototypeOf","updateAlt","bind","updateAlignment","onFocusCaption","onImageClick","onSelectImage","updateImageURL","updateWidth","updateHeight","updateDimensions","getFilename","toggleIsEditing","onImageError","onChangeInputValue","autocompleteRef","resetInvalidLink","updateImageSelection","onSelectAffiliateImage","editAFfiliateImage","state","captionFocused","isEditing","inputValue","post","showSuggestions","imageSelection","_this2","_props","setAttributes","noticeOperations","_attributes$url","filesList","onFileChange","allowedTypes","onError","message","createErrorNotice","setState","prevProps","_prevProps$attributes","prevID","_prevProps$attributes2","prevURL","_props$attributes","_props$attributes$url","isSelected","media","link","embedBlock","createUpgradedEmbedBlock","onReplace","newAlt","nextAlign","extraUpdatedAttributes","_this3","path","split","label","_props2","imageSizes","slug","sizeUrl","invalidLink","_this4","apiFetch","addQueryArgs","context","_locale","then","source_url","images","_this5","_state","_props3","isLargeViewport","maxWidth","toggleSelection","isRTL","toolbarEditButton","onClick","controls","onChange","instructions","index","wp-block-image","is-transient","is-resized","is-focused","isResizable","imageSizeOptions","getImageSizeOptions","getInspectorControls","imageWidth","imageHeight","help","options","placeholder","min","aria-label","scale","scaledWidth","Math","round","scaledHeight","isCurrent","isSmall","isPrimary","aria-pressed","dirtynessTrigger","sizes","imageWidthWithinContainer","imageHeightWithinContainer","filename","defaultedAlt","style","currentWidth","currentHeight","ratio","minWidth","minHeight","maxWidthBuffer","showRightHandle","showLeftHandle","size","maxHeight","lockAspectRatio","enable","top","right","bottom","left","onResizeStart","onResizeStop","event","direction","elt","delta","unstableOnFocus","inlineToolbar","select","_select","getMedia","_select2","getEditorSettings","_getEditorSettings","includes","renderToString","attributesFromPreview","preview","matchingBlock","findBlock","DEFAULT_EMBED_BLOCK","html","isFromWordPress","noop","withGlobalEvents","ImageSize","bindContainer","calculateSize","ref","container","fetchImageSize","onload","window","Image","clientWidth","exceedMaxWidth","containerWidth","containerHeight","clientHeight","resize","withSpokenMessages","withInstanceId","ThirstyURLInput","inputRef","searchAffiliateLinks","suggestionNodes","posts","selectedSuggestion","loading","scrollingIntoView","scrollIntoView","current","onlyScrollIfNeeded","setTimeout","suggestionsRequest","formData","FormData","append","request","fetch","ajaxurl","method","response","json","affiliate_links","debouncedSpeak","catch","selectLink","instanceId","autoFocus","_state2","class","onSubmit","displayAffiliateImages","autocomplete","position","focusOnMount","role","tabIndex","bindSuggestionNode","is-selected","handleOnClick","aria-selected","_objectWithoutProperties","keys","taLink","registerFormatType","__WEBPACK_IMPORTED_MODULE_0__ta_link__","richText","__WEBPACK_IMPORTED_MODULE_0__inline__","_wp$richText","getTextContent","applyFormat","removeFormat","slice","isURL","RichTextToolbarButton","RichTextShortcut","LinkEdit","addLink","stopAddingLink","onRemoveFormat","addingLink","text","speak","isActive","activeAttributes","character","onUse","shortcutType","shortcutCharacter","createLinkFormat","toString","isShowingInput","editLink","__WEBPACK_IMPORTED_MODULE_1__positioned_at_selection__","__WEBPACK_IMPORTED_MODULE_2__utils__","__WEBPACK_IMPORTED_MODULE_3__url_popover__","__WEBPACK_IMPORTED_MODULE_4__url_input__","ExternalLink","_wp$keycodes","keycodes","LEFT","RIGHT","UP","DOWN","BACKSPACE","ENTER","_wp$url","prependHTTP","safeDecodeURI","filterURLForDisplay","insert","isCollapsed","stopKeyPropagation","stopPropagation","LinkEditor","onKeyDown","submitLink","onKeyPress","LinkViewerUrl","prependedURL","linkClassName","has-invalid-link","isValidHref","LinkViewer","InlineAffiliateLinkUI","onClickOutside","resetState","keyCode","preventDefault","selectedText","format","toInsert","autocompleteElement","contains","_props2$activeAttribu","showInput","start","end","onClose","updateLinkId","getCurrentCaretPositionStyle","selection","getSelection","rangeCount","rect","getRectangleFromRange","getRangeAt","offsetParent","getOffsetParent","anchorNode","parentRect","getBoundingClientRect","_wp$dom","dom","ThirstyPositionedAtSelection","trimmedHref","test","protocol","getProtocol","isValidProtocol","startsWith","authority","getAuthority","isValidAuthority","isValidPath","queryString","getQueryString","isValidQueryString","fragment","getFragment","isValidFragment","ThirstyURLPopover","toggleSettingsVisibility","isSettingsExpanded","renderSettings","_props$position","_props$focusOnMount","showSettings","aria-expanded","__WEBPACK_IMPORTED_MODULE_1_dom_scroll_into_view__","__WEBPACK_IMPORTED_MODULE_1_dom_scroll_into_view___default","throttle","TAB","stopEventPropagation","updateSuggestions","previousIndex","nextIndex","selectionStart","setSelectionRange","focus","_props$value","_props$autoFocus","_state3","required","onInput","aria-autocomplete","aria-owns","aria-activedescendant","noArrow","elem","config","nodeType","util","getWindow","allowHorizontalScroll","alignWithTop","alignWithLeft","offsetTop","offsetLeft","offsetBottom","offsetRight","isWin","isWindow","elemOffset","offset","eh","outerHeight","ew","outerWidth","containerOffset","ch","cw","containerScroll","diffTop","diffBottom","win","winScroll","ww","wh","scrollLeft","scrollTop","parseFloat","css","getClientPosition","box","x","y","doc","ownerDocument","docElem","documentElement","clientLeft","clientTop","getScroll","w","ret","getScrollLeft","getScrollTop","getOffset","el","pos","defaultView","parentWindow","_getComputedStyle","computedStyle_","val","computedStyle","getComputedStyle","getPropertyValue","_getComputedStyleIE","CURRENT_STYLE","_RE_NUM_NO_PX","RE_POS","rsLeft","RUNTIME_STYLE","pixelLeft","PX","each","fn","isBorderBoxFn","getComputedStyleX","swap","callback","old","getPBMWidth","which","prop","j","cssProp","getWH","extra","domUtils","viewportWidth","viewportHeight","docWidth","docHeight","borderBoxValue","offsetWidth","offsetHeight","isBorderBox","cssBoxValue","BORDER_INDEX","CONTENT_INDEX","borderBoxValueOrIsBorderBox","padding","PADDING_INDEX","BOX_MODELS","getWHIgnoreDisplay","args","cssShow","v","_typeof","setOffset","RE_NUM","RegExp","refWin","max","documentElementProp","compatMode","visibility","display","first","charAt","toUpperCase","includeMargin","clone","overflow","scrollTo"],"mappings":"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","file":"gutenberg-support.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 1);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n  Copyright (c) 2017 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg) && arg.length) {\n\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\tif (inner) {\n\t\t\t\t\tclasses.push(inner);\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (true) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = (function () {\n\t\t\treturn classNames;\n\t\t}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__blocks__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__formats__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__assets_styles_index_scss__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__assets_styles_index_scss___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__assets_styles_index_scss__);\n\n\n\n\n\nObject(__WEBPACK_IMPORTED_MODULE_0__blocks__[\"a\" /* default */])();\nObject(__WEBPACK_IMPORTED_MODULE_1__formats__[\"a\" /* default */])();\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = registerBlocks;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__ta_image__ = __webpack_require__(3);\n\n\nvar registerBlockType = wp.blocks.registerBlockType;\n\n/**\n * Register gutenberg blocks.\n * \n * @since 3.6\n */\n\nfunction registerBlocks() {\n\n    [__WEBPACK_IMPORTED_MODULE_0__ta_image__].forEach(function (block) {\n        if (!block) return;\n\n        var name = block.name,\n            settings = block.settings;\n\n        registerBlockType(name, settings);\n    });\n}\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"name\", function() { return name; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"settings\", function() { return settings; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_classnames__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_classnames___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_classnames__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__edit__ = __webpack_require__(4);\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\nvar Fragment = wp.element.Fragment;\nvar __ = wp.i18n.__;\nvar _wp$blocks = wp.blocks,\n    createBlock = _wp$blocks.createBlock,\n    getBlockAttributes = _wp$blocks.getBlockAttributes,\n    getPhrasingContentSchema = _wp$blocks.getPhrasingContentSchema;\nvar RichText = wp.editor.RichText;\nvar _wp$components = wp.components,\n    Path = _wp$components.Path,\n    SVG = _wp$components.SVG;\n\n\n\n\nvar name = 'ta/image';\n\nvar blockAttributes = {\n\turl: {\n\t\ttype: 'string',\n\t\tsource: 'attribute',\n\t\tselector: 'img',\n\t\tattribute: 'src'\n\t},\n\talt: {\n\t\ttype: 'string',\n\t\tsource: 'attribute',\n\t\tselector: 'img',\n\t\tattribute: 'alt',\n\t\tdefault: ''\n\t},\n\tcaption: {\n\t\ttype: 'string',\n\t\tsource: 'html',\n\t\tselector: 'figcaption'\n\t},\n\tid: {\n\t\ttype: 'number'\n\t},\n\talign: {\n\t\ttype: 'string'\n\t},\n\twidth: {\n\t\ttype: 'number'\n\t},\n\theight: {\n\t\ttype: 'number'\n\t},\n\tlinkid: {\n\t\ttype: 'number'\n\t},\n\thref: {\n\t\ttype: 'string',\n\t\tsource: 'attribute',\n\t\tselector: 'ta',\n\t\tattribute: 'href'\n\t},\n\taffiliateLink: {\n\t\ttype: 'object'\n\t}\n};\n\nvar imageSchema = {\n\timg: {\n\t\tattributes: ['src', 'alt'],\n\t\tclasses: ['alignleft', 'aligncenter', 'alignright', 'alignnone', /^wp-image-\\d+$/]\n\t}\n};\n\nvar schema = {\n\tfigure: {\n\t\trequire: ['ta', 'img'],\n\t\tchildren: {\n\t\t\tta: {\n\t\t\t\tattributes: ['href', 'linkid'],\n\t\t\t\tchildren: imageSchema\n\t\t\t},\n\t\t\tfigcaption: {\n\t\t\t\tchildren: getPhrasingContentSchema()\n\t\t\t}\n\t\t}\n\t}\n};\n\nfunction getFirstAnchorAttributeFormHTML(html, attributeName) {\n\tvar _document$implementat = document.implementation.createHTMLDocument(''),\n\t    body = _document$implementat.body;\n\n\tbody.innerHTML = html;\n\n\tvar firstElementChild = body.firstElementChild;\n\n\n\tif (firstElementChild && firstElementChild.nodeName === 'A') {\n\t\treturn firstElementChild.getAttribute(attributeName) || undefined;\n\t}\n}\n\nvar settings = {\n\ttitle: __('ThirstyAffiliates Image'),\n\n\tdescription: __('Insert an image with an affiliate link to make a visual statement.'),\n\n\ticon: wp.element.createElement(\n\t\tSVG,\n\t\t{ viewBox: \"0 0 24 24\", xmlns: \"http://www.w3.org/2000/svg\" },\n\t\twp.element.createElement(Path, { d: \"M0,0h24v24H0V0z\", fill: \"none\" }),\n\t\twp.element.createElement(Path, { d: \"m19 5v14h-14v-14h14m0-2h-14c-1.1 0-2 0.9-2 2v14c0 1.1 0.9 2 2 2h14c1.1 0 2-0.9 2-2v-14c0-1.1-0.9-2-2-2z\" }),\n\t\twp.element.createElement(Path, { d: \"m14.14 11.86l-3 3.87-2.14-2.59-3 3.86h12l-3.86-5.14z\" })\n\t),\n\n\tcategory: 'common',\n\n\tkeywords: ['img', // \"img\" is not translated as it is intended to reflect the HTML <img> tag.\n\t__('photo'), __('affiliate')],\n\n\tattributes: blockAttributes,\n\n\ttransforms: {\n\t\tfrom: [{\n\t\t\ttype: 'raw',\n\t\t\tisMatch: function isMatch(node) {\n\t\t\t\treturn node.nodeName === 'FIGURE' && !!node.querySelector('img');\n\t\t\t},\n\t\t\tschema: schema,\n\t\t\ttransform: function transform(node) {\n\n\t\t\t\t// Search both figure and image classes. Alignment could be\n\t\t\t\t// set on either. ID is set on the image.\n\t\t\t\tvar className = node.className + ' ' + node.querySelector('img').className;\n\t\t\t\tvar alignMatches = /(?:^|\\s)align(left|center|right)(?:$|\\s)/.exec(className);\n\t\t\t\tvar align = alignMatches ? alignMatches[1] : undefined;\n\t\t\t\tvar idMatches = /(?:^|\\s)wp-image-(\\d+)(?:$|\\s)/.exec(className);\n\t\t\t\tvar id = idMatches ? Number(idMatches[1]) : undefined;\n\t\t\t\tvar anchorElement = node.querySelector('a');\n\t\t\t\tvar linkDestination = anchorElement && anchorElement.href ? 'custom' : undefined;\n\t\t\t\tvar href = anchorElement && anchorElement.href ? anchorElement.href : undefined;\n\t\t\t\tvar rel = anchorElement && anchorElement.rel ? anchorElement.rel : undefined;\n\t\t\t\tvar linkClass = anchorElement && anchorElement.className ? anchorElement.className : undefined;\n\t\t\t\tvar attributes = getBlockAttributes('ta/image', node.outerHTML, { align: align, id: id, linkDestination: linkDestination, linkid: linkid, href: href, rel: rel, linkClass: linkClass });\n\t\t\t\treturn createBlock('ta/image', attributes);\n\t\t\t}\n\t\t}, {\n\t\t\ttype: 'files',\n\t\t\tisMatch: function isMatch(files) {\n\t\t\t\treturn files.length === 1 && files[0].type.indexOf('image/') === 0;\n\t\t\t},\n\t\t\ttransform: function transform(files) {\n\t\t\t\tvar file = files[0];\n\t\t\t\t// We don't need to upload the media directly here\n\t\t\t\t// It's already done as part of the `componentDidMount`\n\t\t\t\t// int the image block\n\t\t\t\tvar block = createBlock('ta/image', {\n\t\t\t\t\turl: createBlobURL(file)\n\t\t\t\t});\n\n\t\t\t\treturn block;\n\t\t\t}\n\t\t}, {\n\t\t\ttype: 'shortcode',\n\t\t\ttag: 'caption',\n\t\t\tattributes: {\n\t\t\t\turl: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tsource: 'attribute',\n\t\t\t\t\tattribute: 'src',\n\t\t\t\t\tselector: 'img'\n\t\t\t\t},\n\t\t\t\talt: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tsource: 'attribute',\n\t\t\t\t\tattribute: 'alt',\n\t\t\t\t\tselector: 'img'\n\t\t\t\t},\n\t\t\t\tcaption: {\n\t\t\t\t\tshortcode: function shortcode(attributes, _ref) {\n\t\t\t\t\t\tvar _shortcode = _ref.shortcode;\n\n\t\t\t\t\t\tvar _document$implementat2 = document.implementation.createHTMLDocument(''),\n\t\t\t\t\t\t    body = _document$implementat2.body;\n\n\t\t\t\t\t\tbody.innerHTML = _shortcode.content;\n\t\t\t\t\t\tbody.removeChild(body.firstElementChild);\n\n\t\t\t\t\t\treturn body.innerHTML.trim();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tid: {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tshortcode: function shortcode(_ref2) {\n\t\t\t\t\t\tvar id = _ref2.named.id;\n\n\t\t\t\t\t\tif (!id) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn parseInt(id.replace('attachment_', ''), 10);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\talign: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tshortcode: function shortcode(_ref3) {\n\t\t\t\t\t\tvar _ref3$named$align = _ref3.named.align,\n\t\t\t\t\t\t    align = _ref3$named$align === undefined ? 'alignnone' : _ref3$named$align;\n\n\t\t\t\t\t\treturn align.replace('align', '');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tlinkid: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tsource: 'attribute',\n\t\t\t\t\tselector: 'wp-block-ta-image > ta',\n\t\t\t\t\tattribute: 'linkid'\n\t\t\t\t},\n\t\t\t\thref: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tsource: 'attribute',\n\t\t\t\t\tselector: 'ta',\n\t\t\t\t\tattribute: 'href'\n\t\t\t\t}\n\t\t\t}\n\t\t}]\n\t},\n\n\tgetEditWrapperProps: function getEditWrapperProps(attributes) {\n\t\tvar align = attributes.align,\n\t\t    width = attributes.width;\n\n\t\tif ('left' === align || 'center' === align || 'right' === align || 'wide' === align || 'full' === align) {\n\t\t\treturn { 'data-align': align, 'data-resized': !!width };\n\t\t}\n\t},\n\n\n\tedit: __WEBPACK_IMPORTED_MODULE_1__edit__[\"a\" /* default */],\n\n\tsave: function save(_ref4) {\n\t\tvar _classnames;\n\n\t\tvar attributes = _ref4.attributes;\n\t\tvar url = attributes.url,\n\t\t    alt = attributes.alt,\n\t\t    caption = attributes.caption,\n\t\t    align = attributes.align,\n\t\t    width = attributes.width,\n\t\t    height = attributes.height,\n\t\t    id = attributes.id,\n\t\t    linkid = attributes.linkid,\n\t\t    href = attributes.href;\n\n\n\t\tvar classes = __WEBPACK_IMPORTED_MODULE_0_classnames___default()((_classnames = {}, _defineProperty(_classnames, \"align\" + align, align), _defineProperty(_classnames, 'is-resized', width || height), _classnames));\n\n\t\tvar image = wp.element.createElement(\"img\", {\n\t\t\tsrc: url,\n\t\t\talt: alt,\n\t\t\tclassName: id ? \"wp-image-\" + id : null,\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t});\n\n\t\tvar figure = wp.element.createElement(\n\t\t\tFragment,\n\t\t\tnull,\n\t\t\twp.element.createElement(\n\t\t\t\t\"ta\",\n\t\t\t\t{ linkid: linkid, href: href },\n\t\t\t\timage\n\t\t\t),\n\t\t\twp.element.createElement(RichText.Content, { tagName: \"figcaption\", value: caption })\n\t\t);\n\n\t\tif ('left' === align || 'right' === align || 'center' === align) {\n\t\t\treturn wp.element.createElement(\n\t\t\t\t\"div\",\n\t\t\t\t{ className: \"wp-block-image\" },\n\t\t\t\twp.element.createElement(\n\t\t\t\t\t\"figure\",\n\t\t\t\t\t{ className: classes },\n\t\t\t\t\tfigure\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\treturn wp.element.createElement(\n\t\t\t\"figure\",\n\t\t\t{ className: \"wp-block-image \" + classes },\n\t\t\tfigure\n\t\t);\n\t}\n};\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export pickRelevantMediaFiles */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_classnames__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_classnames___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_classnames__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__util__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__image_size__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__search_input__ = __webpack_require__(7);\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\nvar _lodash = lodash,\n    get = _lodash.get,\n    isEmpty = _lodash.isEmpty,\n    map = _lodash.map,\n    last = _lodash.last,\n    pick = _lodash.pick,\n    compact = _lodash.compact;\nvar getPath = wp.url.getPath;\nvar _wp$i18n = wp.i18n,\n    __ = _wp$i18n.__,\n    sprintf = _wp$i18n.sprintf;\nvar _wp$element = wp.element,\n    Component = _wp$element.Component,\n    Fragment = _wp$element.Fragment,\n    createRef = _wp$element.createRef;\nvar _wp$blob = wp.blob,\n    getBlobByURL = _wp$blob.getBlobByURL,\n    revokeBlobURL = _wp$blob.revokeBlobURL,\n    isBlobURL = _wp$blob.isBlobURL;\nvar _wp$components = wp.components,\n    Placeholder = _wp$components.Placeholder,\n    Button = _wp$components.Button,\n    ButtonGroup = _wp$components.ButtonGroup,\n    IconButton = _wp$components.IconButton,\n    PanelBody = _wp$components.PanelBody,\n    ResizableBox = _wp$components.ResizableBox,\n    SelectControl = _wp$components.SelectControl,\n    Spinner = _wp$components.Spinner,\n    TextControl = _wp$components.TextControl,\n    TextareaControl = _wp$components.TextareaControl,\n    Toolbar = _wp$components.Toolbar,\n    withNotices = _wp$components.withNotices,\n    ToggleControl = _wp$components.ToggleControl,\n    Popover = _wp$components.Popover;\nvar withSelect = wp.data.withSelect;\nvar _wp$editor = wp.editor,\n    RichText = _wp$editor.RichText,\n    BlockControls = _wp$editor.BlockControls,\n    InspectorControls = _wp$editor.InspectorControls,\n    MediaUpload = _wp$editor.MediaUpload,\n    MediaUploadCheck = _wp$editor.MediaUploadCheck,\n    MediaPlaceholder = _wp$editor.MediaPlaceholder,\n    BlockAlignmentToolbar = _wp$editor.BlockAlignmentToolbar,\n    mediaUpload = _wp$editor.mediaUpload;\nvar withViewportMatch = wp.viewport.withViewportMatch;\nvar compose = wp.compose.compose;\n\n\n\n\n\n\n/**\n * Module constants\n */\nvar MIN_SIZE = 20;\nvar LINK_DESTINATION_NONE = 'none';\nvar LINK_DESTINATION_MEDIA = 'media';\nvar LINK_DESTINATION_ATTACHMENT = 'attachment';\nvar LINK_DESTINATION_CUSTOM = 'custom';\nvar NEW_TAB_REL = 'noreferrer noopener';\nvar ALLOWED_MEDIA_TYPES = ['image'];\n\nvar pickRelevantMediaFiles = function pickRelevantMediaFiles(image) {\n\tvar imageProps = pick(image, ['alt', 'id', 'link', 'caption']);\n\timageProps.url = get(image, ['sizes', 'large', 'url']) || get(image, ['media_details', 'sizes', 'large', 'source_url']) || image.url;\n\treturn imageProps;\n};\n\n/**\n * Is the URL a temporary blob URL? A blob URL is one that is used temporarily\n * while the image is being uploaded and will not have an id yet allocated.\n *\n * @param {number=} id The id of the image.\n * @param {string=} url The url of the image.\n *\n * @return {boolean} Is the URL a Blob URL\n */\nvar isTemporaryImage = function isTemporaryImage(id, url) {\n\treturn !id && isBlobURL(url);\n};\n\n/**\n * Is the url for the image hosted externally. An externally hosted image has no id\n * and is not a blob url.\n *\n * @param {number=} id  The id of the image.\n * @param {string=} url The url of the image.\n *\n * @return {boolean} Is the url an externally hosted url?\n */\nvar isExternalImage = function isExternalImage(id, url) {\n\treturn url && !id && !isBlobURL(url);\n};\n\nvar ImageEdit = function (_Component) {\n\t_inherits(ImageEdit, _Component);\n\n\tfunction ImageEdit(_ref) {\n\t\tvar attributes = _ref.attributes;\n\n\t\t_classCallCheck(this, ImageEdit);\n\n\t\tvar _this = _possibleConstructorReturn(this, (ImageEdit.__proto__ || Object.getPrototypeOf(ImageEdit)).apply(this, arguments));\n\n\t\t_this.updateAlt = _this.updateAlt.bind(_this);\n\t\t_this.updateAlignment = _this.updateAlignment.bind(_this);\n\t\t_this.onFocusCaption = _this.onFocusCaption.bind(_this);\n\t\t_this.onImageClick = _this.onImageClick.bind(_this);\n\t\t_this.onSelectImage = _this.onSelectImage.bind(_this);\n\t\t_this.updateImageURL = _this.updateImageURL.bind(_this);\n\t\t_this.updateWidth = _this.updateWidth.bind(_this);\n\t\t_this.updateHeight = _this.updateHeight.bind(_this);\n\t\t_this.updateDimensions = _this.updateDimensions.bind(_this);\n\t\t_this.getFilename = _this.getFilename.bind(_this);\n\t\t_this.toggleIsEditing = _this.toggleIsEditing.bind(_this);\n\t\t_this.onImageError = _this.onImageError.bind(_this);\n\t\t_this.onChangeInputValue = _this.onChangeInputValue.bind(_this);\n\t\t_this.autocompleteRef = createRef();\n\t\t_this.resetInvalidLink = _this.resetInvalidLink.bind(_this);\n\t\t_this.updateImageSelection = _this.updateImageSelection.bind(_this);\n\t\t_this.onSelectAffiliateImage = _this.onSelectAffiliateImage.bind(_this);\n\t\t_this.editAFfiliateImage = _this.editAFfiliateImage.bind(_this);\n\n\t\t_this.state = {\n\t\t\tcaptionFocused: false,\n\t\t\tisEditing: !attributes.url,\n\t\t\tinputValue: '',\n\t\t\tlinkid: 0,\n\t\t\tpost: null,\n\t\t\tshowSuggestions: false,\n\t\t\timageSelection: [],\n\t\t\taffiliateLink: null\n\t\t};\n\t\treturn _this;\n\t}\n\n\t_createClass(ImageEdit, [{\n\t\tkey: \"componentDidMount\",\n\t\tvalue: function componentDidMount() {\n\t\t\tvar _this2 = this;\n\n\t\t\tvar _props = this.props,\n\t\t\t    attributes = _props.attributes,\n\t\t\t    setAttributes = _props.setAttributes,\n\t\t\t    noticeOperations = _props.noticeOperations;\n\t\t\tvar id = attributes.id,\n\t\t\t    _attributes$url = attributes.url,\n\t\t\t    url = _attributes$url === undefined ? '' : _attributes$url;\n\n\n\t\t\tif (isTemporaryImage(id, url)) {\n\t\t\t\tvar file = getBlobByURL(url);\n\n\t\t\t\tif (file) {\n\t\t\t\t\tmediaUpload({\n\t\t\t\t\t\tfilesList: [file],\n\t\t\t\t\t\tonFileChange: function onFileChange(_ref2) {\n\t\t\t\t\t\t\tvar _ref3 = _slicedToArray(_ref2, 1),\n\t\t\t\t\t\t\t    image = _ref3[0];\n\n\t\t\t\t\t\t\tsetAttributes(pickRelevantMediaFiles(image));\n\t\t\t\t\t\t},\n\t\t\t\t\t\tallowedTypes: ALLOWED_MEDIA_TYPES,\n\t\t\t\t\t\tonError: function onError(message) {\n\t\t\t\t\t\t\tnoticeOperations.createErrorNotice(message);\n\t\t\t\t\t\t\t_this2.setState({ isEditing: true });\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"componentDidUpdate\",\n\t\tvalue: function componentDidUpdate(prevProps) {\n\t\t\tvar _prevProps$attributes = prevProps.attributes,\n\t\t\t    prevID = _prevProps$attributes.id,\n\t\t\t    _prevProps$attributes2 = _prevProps$attributes.url,\n\t\t\t    prevURL = _prevProps$attributes2 === undefined ? '' : _prevProps$attributes2;\n\t\t\tvar _props$attributes = this.props.attributes,\n\t\t\t    id = _props$attributes.id,\n\t\t\t    _props$attributes$url = _props$attributes.url,\n\t\t\t    url = _props$attributes$url === undefined ? '' : _props$attributes$url;\n\n\n\t\t\tif (isTemporaryImage(prevID, prevURL) && !isTemporaryImage(id, url)) {\n\t\t\t\trevokeBlobURL(url);\n\t\t\t}\n\n\t\t\tif (!this.props.isSelected && prevProps.isSelected && this.state.captionFocused) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tcaptionFocused: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"onSelectImage\",\n\t\tvalue: function onSelectImage(media) {\n\n\t\t\tif (!media || !media.url) {\n\t\t\t\tthis.props.setAttributes({\n\t\t\t\t\turl: undefined,\n\t\t\t\t\talt: undefined,\n\t\t\t\t\tid: undefined,\n\t\t\t\t\tcaption: undefined\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar affiliateLink = this.state.affiliateLink;\n\n\n\t\t\tthis.setState({\n\t\t\t\tisEditing: false\n\t\t\t});\n\n\t\t\tthis.props.setAttributes(_extends({}, pickRelevantMediaFiles(media), {\n\t\t\t\tlinkid: affiliateLink.id,\n\t\t\t\thref: affiliateLink.link,\n\t\t\t\taffiliateLink: affiliateLink,\n\t\t\t\twidth: undefined,\n\t\t\t\theight: undefined\n\t\t\t}));\n\t\t}\n\t}, {\n\t\tkey: \"onImageError\",\n\t\tvalue: function onImageError(url) {\n\t\t\t// Check if there's an embed block that handles this URL.\n\t\t\tvar embedBlock = Object(__WEBPACK_IMPORTED_MODULE_1__util__[\"a\" /* createUpgradedEmbedBlock */])({ attributes: { url: url } });\n\t\t\tif (undefined !== embedBlock) {\n\t\t\t\tthis.props.onReplace(embedBlock);\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"onFocusCaption\",\n\t\tvalue: function onFocusCaption() {\n\t\t\tif (!this.state.captionFocused) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tcaptionFocused: true\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"onImageClick\",\n\t\tvalue: function onImageClick() {\n\t\t\tif (this.state.captionFocused) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tcaptionFocused: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"updateAlt\",\n\t\tvalue: function updateAlt(newAlt) {\n\t\t\tthis.props.setAttributes({ alt: newAlt });\n\t\t}\n\t}, {\n\t\tkey: \"updateAlignment\",\n\t\tvalue: function updateAlignment(nextAlign) {\n\t\t\tvar extraUpdatedAttributes = ['wide', 'full'].indexOf(nextAlign) !== -1 ? { width: undefined, height: undefined } : {};\n\t\t\tthis.props.setAttributes(_extends({}, extraUpdatedAttributes, { align: nextAlign }));\n\t\t}\n\t}, {\n\t\tkey: \"updateImageURL\",\n\t\tvalue: function updateImageURL(url) {\n\t\t\tthis.props.setAttributes({ url: url, width: undefined, height: undefined });\n\t\t}\n\t}, {\n\t\tkey: \"updateWidth\",\n\t\tvalue: function updateWidth(width) {\n\t\t\tthis.props.setAttributes({ width: parseInt(width, 10) });\n\t\t}\n\t}, {\n\t\tkey: \"updateHeight\",\n\t\tvalue: function updateHeight(height) {\n\t\t\tthis.props.setAttributes({ height: parseInt(height, 10) });\n\t\t}\n\t}, {\n\t\tkey: \"updateDimensions\",\n\t\tvalue: function updateDimensions() {\n\t\t\tvar _this3 = this;\n\n\t\t\tvar width = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\t\t\tvar height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n\n\t\t\treturn function () {\n\t\t\t\t_this3.props.setAttributes({ width: width, height: height });\n\t\t\t};\n\t\t}\n\t}, {\n\t\tkey: \"getFilename\",\n\t\tvalue: function getFilename(url) {\n\t\t\tvar path = getPath(url);\n\t\t\tif (path) {\n\t\t\t\treturn last(path.split('/'));\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"getLinkDestinationOptions\",\n\t\tvalue: function getLinkDestinationOptions() {\n\t\t\treturn [{ value: LINK_DESTINATION_NONE, label: __('None') }, { value: LINK_DESTINATION_MEDIA, label: __('Media File') }, { value: LINK_DESTINATION_ATTACHMENT, label: __('Attachment Page') }, { value: LINK_DESTINATION_CUSTOM, label: __('Custom URL') }];\n\t\t}\n\t}, {\n\t\tkey: \"toggleIsEditing\",\n\t\tvalue: function toggleIsEditing() {\n\t\t\tthis.setState({\n\t\t\t\tisEditing: !this.state.isEditing\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: \"getImageSizeOptions\",\n\t\tvalue: function getImageSizeOptions() {\n\t\t\tvar _props2 = this.props,\n\t\t\t    imageSizes = _props2.imageSizes,\n\t\t\t    image = _props2.image;\n\n\t\t\treturn compact(map(imageSizes, function (_ref4) {\n\t\t\t\tvar name = _ref4.name,\n\t\t\t\t    slug = _ref4.slug;\n\n\t\t\t\tvar sizeUrl = get(image, ['media_details', 'sizes', slug, 'source_url']);\n\t\t\t\tif (!sizeUrl) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tvalue: sizeUrl,\n\t\t\t\t\tlabel: name\n\t\t\t\t};\n\t\t\t}));\n\t\t}\n\t}, {\n\t\tkey: \"onChangeInputValue\",\n\t\tvalue: function onChangeInputValue(inputValue) {\n\t\t\tvar post = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n\t\t\tvar linkid = post ? post.id : 0;\n\t\t\tthis.setState({ inputValue: inputValue, linkid: linkid, post: post });\n\t\t}\n\t}, {\n\t\tkey: \"resetInvalidLink\",\n\t\tvalue: function resetInvalidLink() {\n\t\t\tthis.setState({ invalidLink: false });\n\t\t}\n\t}, {\n\t\tkey: \"updateImageSelection\",\n\t\tvalue: function updateImageSelection(imageSelection, affiliateLink) {\n\t\t\tthis.setState({\n\t\t\t\timageSelection: imageSelection,\n\t\t\t\taffiliateLink: affiliateLink\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: \"onSelectAffiliateImage\",\n\t\tvalue: function onSelectAffiliateImage(image) {\n\t\t\tvar _this4 = this;\n\n\t\t\tvar request = wp.apiFetch({\n\t\t\t\tpath: wp.url.addQueryArgs('wp/v2/media/' + image.id, {\n\t\t\t\t\tcontext: 'edit',\n\t\t\t\t\t_locale: 'user'\n\t\t\t\t})\n\t\t\t});\n\n\t\t\trequest.then(function (media) {\n\t\t\t\tmedia.url = media.source_url;\n\t\t\t\t_this4.onSelectImage(media);\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: \"editAFfiliateImage\",\n\t\tvalue: function editAFfiliateImage() {\n\t\t\tvar attributes = this.props.attributes;\n\t\t\tvar affiliateLink = attributes.affiliateLink;\n\n\n\t\t\tthis.setState({\n\t\t\t\tisEditing: true,\n\t\t\t\timageSelection: affiliateLink.images,\n\t\t\t\taffiliateLink: affiliateLink\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: \"render\",\n\t\tvalue: function render() {\n\t\t\tvar _this5 = this;\n\n\t\t\tvar _state = this.state,\n\t\t\t    isEditing = _state.isEditing,\n\t\t\t    imageSelection = _state.imageSelection,\n\t\t\t    affiliateLink = _state.affiliateLink;\n\t\t\tvar _props3 = this.props,\n\t\t\t    attributes = _props3.attributes,\n\t\t\t    setAttributes = _props3.setAttributes,\n\t\t\t    isLargeViewport = _props3.isLargeViewport,\n\t\t\t    isSelected = _props3.isSelected,\n\t\t\t    className = _props3.className,\n\t\t\t    maxWidth = _props3.maxWidth,\n\t\t\t    toggleSelection = _props3.toggleSelection,\n\t\t\t    isRTL = _props3.isRTL;\n\t\t\tvar url = attributes.url,\n\t\t\t    alt = attributes.alt,\n\t\t\t    caption = attributes.caption,\n\t\t\t    align = attributes.align,\n\t\t\t    linkDestination = attributes.linkDestination,\n\t\t\t    width = attributes.width,\n\t\t\t    height = attributes.height,\n\t\t\t    linkid = attributes.linkid,\n\t\t\t    href = attributes.href;\n\n\t\t\tvar toolbarEditButton = wp.element.createElement(\n\t\t\t\tToolbar,\n\t\t\t\tnull,\n\t\t\t\twp.element.createElement(IconButton, {\n\t\t\t\t\tclassName: \"ta-edit-image-button components-icon-button components-toolbar__control\",\n\t\t\t\t\tlabel: __('Edit ThirstyAffiliates Image'),\n\t\t\t\t\ticon: \"edit\",\n\t\t\t\t\tonClick: this.editAFfiliateImage\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tvar controls = wp.element.createElement(\n\t\t\t\tBlockControls,\n\t\t\t\tnull,\n\t\t\t\twp.element.createElement(BlockAlignmentToolbar, {\n\t\t\t\t\tvalue: align,\n\t\t\t\t\tonChange: this.updateAlignment\n\t\t\t\t}),\n\t\t\t\ttoolbarEditButton\n\t\t\t);\n\n\t\t\tif (isEditing) {\n\t\t\t\treturn wp.element.createElement(\n\t\t\t\t\tFragment,\n\t\t\t\t\tnull,\n\t\t\t\t\tcontrols,\n\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\tPlaceholder,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticon: \"format-image\",\n\t\t\t\t\t\t\tlabel: __(\"ThirstyAffiliates Image\"),\n\t\t\t\t\t\t\tinstructions: __(\"Search for an affiliate link and select image to insert.\")\n\t\t\t\t\t\t},\n\t\t\t\t\t\twp.element.createElement(__WEBPACK_IMPORTED_MODULE_3__search_input__[\"a\" /* default */], {\n\t\t\t\t\t\t\tupdateImageSelection: this.updateImageSelection\n\t\t\t\t\t\t}),\n\t\t\t\t\t\t!!imageSelection.length && wp.element.createElement(\n\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t{ className: \"ta-image-sel-wrap\" },\n\t\t\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t\t\t\"h3\",\n\t\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t\taffiliateLink.title + \" \" + __('attached images:')\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t{ className: \"ta-image-selection\" },\n\t\t\t\t\t\t\t\timageSelection.map(function (image, index) {\n\t\t\t\t\t\t\t\t\treturn wp.element.createElement(\n\t\t\t\t\t\t\t\t\t\t\"button\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tonClick: function onClick() {\n\t\t\t\t\t\t\t\t\t\t\t\treturn _this5.onSelectAffiliateImage(image);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\twp.element.createElement(\"img\", { src: image.src })\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tvar classes = __WEBPACK_IMPORTED_MODULE_0_classnames___default()(className, {\n\t\t\t\t'wp-block-image': true,\n\t\t\t\t'is-transient': isBlobURL(url),\n\t\t\t\t'is-resized': !!width || !!height,\n\t\t\t\t'is-focused': isSelected\n\t\t\t});\n\n\t\t\tvar isResizable = ['wide', 'full'].indexOf(align) === -1 && isLargeViewport;\n\t\t\tvar imageSizeOptions = this.getImageSizeOptions();\n\n\t\t\tvar getInspectorControls = function getInspectorControls(imageWidth, imageHeight) {\n\t\t\t\treturn wp.element.createElement(\n\t\t\t\t\tInspectorControls,\n\t\t\t\t\tnull,\n\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\tPanelBody,\n\t\t\t\t\t\t{ title: __('Image Settings') },\n\t\t\t\t\t\twp.element.createElement(TextareaControl, {\n\t\t\t\t\t\t\tlabel: __('Alt Text (Alternative Text)'),\n\t\t\t\t\t\t\tvalue: alt,\n\t\t\t\t\t\t\tonChange: _this5.updateAlt,\n\t\t\t\t\t\t\thelp: __('Alternative text describes your image to people who can’t see it. Add a short description with its key details.')\n\t\t\t\t\t\t}),\n\t\t\t\t\t\t!isEmpty(imageSizeOptions) && wp.element.createElement(SelectControl, {\n\t\t\t\t\t\t\tlabel: __('Image Size'),\n\t\t\t\t\t\t\tvalue: url,\n\t\t\t\t\t\t\toptions: imageSizeOptions,\n\t\t\t\t\t\t\tonChange: _this5.updateImageURL\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tisResizable && wp.element.createElement(\n\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t{ className: \"block-library-image__dimensions\" },\n\t\t\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t\t\t\"p\",\n\t\t\t\t\t\t\t\t{ className: \"block-library-image__dimensions__row\" },\n\t\t\t\t\t\t\t\t__('Image Dimensions')\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t{ className: \"block-library-image__dimensions__row\" },\n\t\t\t\t\t\t\t\twp.element.createElement(TextControl, {\n\t\t\t\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t\t\t\t\t\tclassName: \"block-library-image__dimensions__width\",\n\t\t\t\t\t\t\t\t\tlabel: __('Width'),\n\t\t\t\t\t\t\t\t\tvalue: width !== undefined ? width : '',\n\t\t\t\t\t\t\t\t\tplaceholder: imageWidth,\n\t\t\t\t\t\t\t\t\tmin: 1,\n\t\t\t\t\t\t\t\t\tonChange: _this5.updateWidth\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\twp.element.createElement(TextControl, {\n\t\t\t\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t\t\t\t\t\tclassName: \"block-library-image__dimensions__height\",\n\t\t\t\t\t\t\t\t\tlabel: __('Height'),\n\t\t\t\t\t\t\t\t\tvalue: height !== undefined ? height : '',\n\t\t\t\t\t\t\t\t\tplaceholder: imageHeight,\n\t\t\t\t\t\t\t\t\tmin: 1,\n\t\t\t\t\t\t\t\t\tonChange: _this5.updateHeight\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t{ className: \"block-library-image__dimensions__row\" },\n\t\t\t\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t\t\t\tButtonGroup,\n\t\t\t\t\t\t\t\t\t{ \"aria-label\": __('Image Size') },\n\t\t\t\t\t\t\t\t\t[25, 50, 75, 100].map(function (scale) {\n\t\t\t\t\t\t\t\t\t\tvar scaledWidth = Math.round(imageWidth * (scale / 100));\n\t\t\t\t\t\t\t\t\t\tvar scaledHeight = Math.round(imageHeight * (scale / 100));\n\n\t\t\t\t\t\t\t\t\t\tvar isCurrent = width === scaledWidth && height === scaledHeight;\n\n\t\t\t\t\t\t\t\t\t\treturn wp.element.createElement(\n\t\t\t\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tkey: scale,\n\t\t\t\t\t\t\t\t\t\t\t\tisSmall: true,\n\t\t\t\t\t\t\t\t\t\t\t\tisPrimary: isCurrent,\n\t\t\t\t\t\t\t\t\t\t\t\t\"aria-pressed\": isCurrent,\n\t\t\t\t\t\t\t\t\t\t\t\tonClick: _this5.updateDimensions(scaledWidth, scaledHeight)\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tscale,\n\t\t\t\t\t\t\t\t\t\t\t\"%\"\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tisSmall: true,\n\t\t\t\t\t\t\t\t\t\tonClick: _this5.updateDimensions()\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t__('Reset')\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t};\n\n\t\t\t// Disable reason: Each block can be selected by clicking on it\n\t\t\t/* eslint-disable jsx-a11y/no-static-element-interactions, jsx-a11y/onclick-has-role, jsx-a11y/click-events-have-key-events */\n\t\t\treturn wp.element.createElement(\n\t\t\t\tFragment,\n\t\t\t\tnull,\n\t\t\t\tcontrols,\n\t\t\t\twp.element.createElement(\n\t\t\t\t\t\"figure\",\n\t\t\t\t\t{ className: classes },\n\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t__WEBPACK_IMPORTED_MODULE_2__image_size__[\"a\" /* default */],\n\t\t\t\t\t\t{ src: url, dirtynessTrigger: align },\n\t\t\t\t\t\tfunction (sizes) {\n\t\t\t\t\t\t\tvar imageWidthWithinContainer = sizes.imageWidthWithinContainer,\n\t\t\t\t\t\t\t    imageHeightWithinContainer = sizes.imageHeightWithinContainer,\n\t\t\t\t\t\t\t    imageWidth = sizes.imageWidth,\n\t\t\t\t\t\t\t    imageHeight = sizes.imageHeight;\n\n\n\t\t\t\t\t\t\tvar filename = _this5.getFilename(url);\n\t\t\t\t\t\t\tvar defaultedAlt = void 0;\n\t\t\t\t\t\t\tif (alt) {\n\t\t\t\t\t\t\t\tdefaultedAlt = alt;\n\t\t\t\t\t\t\t} else if (filename) {\n\t\t\t\t\t\t\t\tdefaultedAlt = sprintf(__('This image has an empty alt attribute; its file name is %s'), filename);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdefaultedAlt = __('This image has an empty alt attribute');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar img =\n\t\t\t\t\t\t\t// Disable reason: Image itself is not meant to be interactive, but\n\t\t\t\t\t\t\t// should direct focus to block.\n\t\t\t\t\t\t\t/* eslint-disable jsx-a11y/no-noninteractive-element-interactions */\n\t\t\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t\t\tFragment,\n\t\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t\t\t\t\"ta\",\n\t\t\t\t\t\t\t\t\t{ linkid: linkid, href: href },\n\t\t\t\t\t\t\t\t\twp.element.createElement(\"img\", { src: url, alt: defaultedAlt, onClick: _this5.onImageClick, onError: function onError() {\n\t\t\t\t\t\t\t\t\t\t\treturn _this5.onImageError(url);\n\t\t\t\t\t\t\t\t\t\t} })\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tisBlobURL(url) && wp.element.createElement(Spinner, null)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t/* eslint-enable jsx-a11y/no-noninteractive-element-interactions */\n\t\t\t\t\t\t\t;\n\n\t\t\t\t\t\t\tif (!isResizable || !imageWidthWithinContainer) {\n\t\t\t\t\t\t\t\treturn wp.element.createElement(\n\t\t\t\t\t\t\t\t\tFragment,\n\t\t\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t\t\tgetInspectorControls(imageWidth, imageHeight),\n\t\t\t\t\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t\t\t{ style: { width: width, height: height } },\n\t\t\t\t\t\t\t\t\t\timg\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar currentWidth = width || imageWidthWithinContainer;\n\t\t\t\t\t\t\tvar currentHeight = height || imageHeightWithinContainer;\n\n\t\t\t\t\t\t\tvar ratio = imageWidth / imageHeight;\n\t\t\t\t\t\t\tvar minWidth = imageWidth < imageHeight ? MIN_SIZE : MIN_SIZE * ratio;\n\t\t\t\t\t\t\tvar minHeight = imageHeight < imageWidth ? MIN_SIZE : MIN_SIZE / ratio;\n\n\t\t\t\t\t\t\t// With the current implementation of ResizableBox, an image needs an explicit pixel value for the max-width.\n\t\t\t\t\t\t\t// In absence of being able to set the content-width, this max-width is currently dictated by the vanilla editor style.\n\t\t\t\t\t\t\t// The following variable adds a buffer to this vanilla style, so 3rd party themes have some wiggleroom.\n\t\t\t\t\t\t\t// This does, in most cases, allow you to scale the image beyond the width of the main column, though not infinitely.\n\t\t\t\t\t\t\t// @todo It would be good to revisit this once a content-width variable becomes available.\n\t\t\t\t\t\t\tvar maxWidthBuffer = maxWidth * 2.5;\n\n\t\t\t\t\t\t\tvar showRightHandle = false;\n\t\t\t\t\t\t\tvar showLeftHandle = false;\n\n\t\t\t\t\t\t\t/* eslint-disable no-lonely-if */\n\t\t\t\t\t\t\t// See https://github.com/WordPress/gutenberg/issues/7584.\n\t\t\t\t\t\t\tif (align === 'center') {\n\t\t\t\t\t\t\t\t// When the image is centered, show both handles.\n\t\t\t\t\t\t\t\tshowRightHandle = true;\n\t\t\t\t\t\t\t\tshowLeftHandle = true;\n\t\t\t\t\t\t\t} else if (isRTL) {\n\t\t\t\t\t\t\t\t// In RTL mode the image is on the right by default.\n\t\t\t\t\t\t\t\t// Show the right handle and hide the left handle only when it is aligned left.\n\t\t\t\t\t\t\t\t// Otherwise always show the left handle.\n\t\t\t\t\t\t\t\tif (align === 'left') {\n\t\t\t\t\t\t\t\t\tshowRightHandle = true;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tshowLeftHandle = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// Show the left handle and hide the right handle only when the image is aligned right.\n\t\t\t\t\t\t\t\t// Otherwise always show the right handle.\n\t\t\t\t\t\t\t\tif (align === 'right') {\n\t\t\t\t\t\t\t\t\tshowLeftHandle = true;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tshowRightHandle = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/* eslint-enable no-lonely-if */\n\n\t\t\t\t\t\t\treturn wp.element.createElement(\n\t\t\t\t\t\t\t\tFragment,\n\t\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t\tgetInspectorControls(imageWidth, imageHeight),\n\t\t\t\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t\t\t\tResizableBox,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tsize: width && height ? {\n\t\t\t\t\t\t\t\t\t\t\twidth: width,\n\t\t\t\t\t\t\t\t\t\t\theight: height\n\t\t\t\t\t\t\t\t\t\t} : undefined,\n\t\t\t\t\t\t\t\t\t\tminWidth: minWidth,\n\t\t\t\t\t\t\t\t\t\tmaxWidth: maxWidthBuffer,\n\t\t\t\t\t\t\t\t\t\tminHeight: minHeight,\n\t\t\t\t\t\t\t\t\t\tmaxHeight: maxWidthBuffer / ratio,\n\t\t\t\t\t\t\t\t\t\tlockAspectRatio: true,\n\t\t\t\t\t\t\t\t\t\tenable: {\n\t\t\t\t\t\t\t\t\t\t\ttop: false,\n\t\t\t\t\t\t\t\t\t\t\tright: showRightHandle,\n\t\t\t\t\t\t\t\t\t\t\tbottom: true,\n\t\t\t\t\t\t\t\t\t\t\tleft: showLeftHandle\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tonResizeStart: function onResizeStart() {\n\t\t\t\t\t\t\t\t\t\t\ttoggleSelection(false);\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tonResizeStop: function onResizeStop(event, direction, elt, delta) {\n\t\t\t\t\t\t\t\t\t\t\tsetAttributes({\n\t\t\t\t\t\t\t\t\t\t\t\twidth: parseInt(currentWidth + delta.width, 10),\n\t\t\t\t\t\t\t\t\t\t\t\theight: parseInt(currentHeight + delta.height, 10)\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\ttoggleSelection(true);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\timg\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t),\n\t\t\t\t\t(!RichText.isEmpty(caption) || isSelected) && wp.element.createElement(RichText, {\n\t\t\t\t\t\ttagName: \"figcaption\",\n\t\t\t\t\t\tplaceholder: __('Write caption…'),\n\t\t\t\t\t\tvalue: caption,\n\t\t\t\t\t\tunstableOnFocus: this.onFocusCaption,\n\t\t\t\t\t\tonChange: function onChange(value) {\n\t\t\t\t\t\t\treturn setAttributes({ caption: value });\n\t\t\t\t\t\t},\n\t\t\t\t\t\tisSelected: this.state.captionFocused,\n\t\t\t\t\t\tinlineToolbar: true\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t);\n\t\t\t/* eslint-enable jsx-a11y/no-static-element-interactions, jsx-a11y/onclick-has-role, jsx-a11y/click-events-have-key-events */\n\t\t}\n\t}]);\n\n\treturn ImageEdit;\n}(Component);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (compose([withSelect(function (select, props) {\n\tvar _select = select('core'),\n\t    getMedia = _select.getMedia;\n\n\tvar _select2 = select('core/editor'),\n\t    getEditorSettings = _select2.getEditorSettings;\n\n\tvar id = props.attributes.id;\n\n\tvar _getEditorSettings = getEditorSettings(),\n\t    maxWidth = _getEditorSettings.maxWidth,\n\t    isRTL = _getEditorSettings.isRTL,\n\t    imageSizes = _getEditorSettings.imageSizes;\n\n\treturn {\n\t\timage: id ? getMedia(id) : null,\n\t\tmaxWidth: maxWidth,\n\t\tisRTL: isRTL,\n\t\timageSizes: imageSizes\n\t};\n}), withViewportMatch({ isLargeViewport: 'medium' }), withNotices])(ImageEdit));\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return createUpgradedEmbedBlock; });\n/* unused harmony export isFromWordPress */\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar WORDPRESS_EMBED_BLOCK = 'core-embed/wordpress';\n\nvar _lodash = lodash,\n    includes = _lodash.includes;\nvar renderToString = wp.element.renderToString;\nvar createBlock = wp.blocks.createBlock;\n\n/***\n * Creates a more suitable embed block based on the passed in props\n * and attributes generated from an embed block's preview.\n *\n * We require `attributesFromPreview` to be generated from the latest attributes\n * and preview, and because of the way the react lifecycle operates, we can't\n * guarantee that the attributes contained in the block's props are the latest\n * versions, so we require that these are generated separately.\n * See `getAttributesFromPreview` in the generated embed edit component.\n *\n * @param {Object}            props                 The block's props.\n * @param {Object}            attributesFromPreview Attributes generated from the block's most up to date preview.\n * @return {Object|undefined} A more suitable embed block if one exists.\n */\n\nvar createUpgradedEmbedBlock = function createUpgradedEmbedBlock(props, attributesFromPreview) {\n\tvar preview = props.preview,\n\t    name = props.name;\n\tvar url = props.attributes.url;\n\n\n\tif (!url) {\n\t\treturn;\n\t}\n\n\tvar matchingBlock = findBlock(url);\n\n\t// WordPress blocks can work on multiple sites, and so don't have patterns,\n\t// so if we're in a WordPress block, assume the user has chosen it for a WordPress URL.\n\tif (WORDPRESS_EMBED_BLOCK !== name && DEFAULT_EMBED_BLOCK !== matchingBlock) {\n\t\t// At this point, we have discovered a more suitable block for this url, so transform it.\n\t\tif (name !== matchingBlock) {\n\t\t\treturn createBlock(matchingBlock, { url: url });\n\t\t}\n\t}\n\n\tif (preview) {\n\t\tvar html = preview.html;\n\n\t\t// We can't match the URL for WordPress embeds, we have to check the HTML instead.\n\n\t\tif (isFromWordPress(html)) {\n\t\t\t// If this is not the WordPress embed block, transform it into one.\n\t\t\tif (WORDPRESS_EMBED_BLOCK !== name) {\n\t\t\t\treturn createBlock(WORDPRESS_EMBED_BLOCK, _extends({\n\t\t\t\t\turl: url\n\t\t\t\t}, attributesFromPreview));\n\t\t\t}\n\t\t}\n\t}\n};\n\nvar isFromWordPress = function isFromWordPress(html) {\n\treturn includes(html, 'class=\"wp-embedded-content\" data-secret');\n};\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _lodash = lodash,\n    noop = _lodash.noop;\nvar withGlobalEvents = wp.compose.withGlobalEvents;\nvar Component = wp.element.Component;\n\nvar ImageSize = function (_Component) {\n\t_inherits(ImageSize, _Component);\n\n\tfunction ImageSize() {\n\t\t_classCallCheck(this, ImageSize);\n\n\t\tvar _this = _possibleConstructorReturn(this, (ImageSize.__proto__ || Object.getPrototypeOf(ImageSize)).apply(this, arguments));\n\n\t\t_this.state = {\n\t\t\twidth: undefined,\n\t\t\theight: undefined\n\t\t};\n\t\t_this.bindContainer = _this.bindContainer.bind(_this);\n\t\t_this.calculateSize = _this.calculateSize.bind(_this);\n\t\treturn _this;\n\t}\n\n\t_createClass(ImageSize, [{\n\t\tkey: 'bindContainer',\n\t\tvalue: function bindContainer(ref) {\n\t\t\tthis.container = ref;\n\t\t}\n\t}, {\n\t\tkey: 'componentDidUpdate',\n\t\tvalue: function componentDidUpdate(prevProps) {\n\t\t\tif (this.props.src !== prevProps.src) {\n\t\t\t\tthis.setState({\n\t\t\t\t\twidth: undefined,\n\t\t\t\t\theight: undefined\n\t\t\t\t});\n\t\t\t\tthis.fetchImageSize();\n\t\t\t}\n\n\t\t\tif (this.props.dirtynessTrigger !== prevProps.dirtynessTrigger) {\n\t\t\t\tthis.calculateSize();\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'componentDidMount',\n\t\tvalue: function componentDidMount() {\n\t\t\tthis.fetchImageSize();\n\t\t}\n\t}, {\n\t\tkey: 'componentWillUnmount',\n\t\tvalue: function componentWillUnmount() {\n\t\t\tif (this.image) {\n\t\t\t\tthis.image.onload = noop;\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'fetchImageSize',\n\t\tvalue: function fetchImageSize() {\n\t\t\tthis.image = new window.Image();\n\t\t\tthis.image.onload = this.calculateSize;\n\t\t\tthis.image.src = this.props.src;\n\t\t}\n\t}, {\n\t\tkey: 'calculateSize',\n\t\tvalue: function calculateSize() {\n\t\t\tvar maxWidth = this.container.clientWidth;\n\t\t\tvar exceedMaxWidth = this.image.width > maxWidth;\n\t\t\tvar ratio = this.image.height / this.image.width;\n\t\t\tvar width = exceedMaxWidth ? maxWidth : this.image.width;\n\t\t\tvar height = exceedMaxWidth ? maxWidth * ratio : this.image.height;\n\t\t\tthis.setState({ width: width, height: height });\n\t\t}\n\t}, {\n\t\tkey: 'render',\n\t\tvalue: function render() {\n\t\t\tvar sizes = {\n\t\t\t\timageWidth: this.image && this.image.width,\n\t\t\t\timageHeight: this.image && this.image.height,\n\t\t\t\tcontainerWidth: this.container && this.container.clientWidth,\n\t\t\t\tcontainerHeight: this.container && this.container.clientHeight,\n\t\t\t\timageWidthWithinContainer: this.state.width,\n\t\t\t\timageHeightWithinContainer: this.state.height\n\t\t\t};\n\t\t\treturn wp.element.createElement(\n\t\t\t\t'div',\n\t\t\t\t{ ref: this.bindContainer },\n\t\t\t\tthis.props.children(sizes)\n\t\t\t);\n\t\t}\n\t}]);\n\n\treturn ImageSize;\n}(Component);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (withGlobalEvents({\n\tresize: 'calculateSize'\n})(ImageSize));\n\n/***/ }),\n/* 7 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_classnames__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_classnames___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_classnames__);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\nvar __ = wp.i18n.__;\nvar _wp$element = wp.element,\n    Component = _wp$element.Component,\n    createRef = _wp$element.createRef;\nvar _wp$components = wp.components,\n    Spinner = _wp$components.Spinner,\n    withSpokenMessages = _wp$components.withSpokenMessages,\n    Popover = _wp$components.Popover,\n    TextControl = _wp$components.TextControl;\nvar withInstanceId = wp.compose.withInstanceId;\n\nvar ThirstyURLInput = function (_Component) {\n\t_inherits(ThirstyURLInput, _Component);\n\n\t/**\n  * Component constructor method.\n  * \n  * @since 3.6\n  * \n  * @param {*} param0 \n  */\n\tfunction ThirstyURLInput(_ref) {\n\t\tvar autocompleteRef = _ref.autocompleteRef;\n\n\t\t_classCallCheck(this, ThirstyURLInput);\n\n\t\t// this.onChange = this.onChange.bind( this );\n\t\t// this.onKeyDown = this.onKeyDown.bind( this );\n\t\tvar _this = _possibleConstructorReturn(this, (ThirstyURLInput.__proto__ || Object.getPrototypeOf(ThirstyURLInput)).apply(this, arguments));\n\n\t\t_this.autocompleteRef = autocompleteRef || createRef();\n\t\t_this.inputRef = createRef();\n\t\t_this.searchAffiliateLinks = _this.searchAffiliateLinks.bind(_this);\n\t\t// this.updateSuggestions = throttle( this.updateSuggestions.bind( this ), 200 );\n\n\t\t_this.suggestionNodes = [];\n\n\t\t_this.state = {\n\t\t\tposts: [],\n\t\t\tshowSuggestions: false,\n\t\t\tselectedSuggestion: null,\n\t\t\tloading: false\n\t\t};\n\t\treturn _this;\n\t}\n\n\t/**\n     * Component did update method.\n     * \n     * @since 3.6\n     */\n\n\n\t_createClass(ThirstyURLInput, [{\n\t\tkey: \"componentDidUpdate\",\n\t\tvalue: function componentDidUpdate() {\n\t\t\tvar _this2 = this;\n\n\t\t\tvar _state = this.state,\n\t\t\t    showSuggestions = _state.showSuggestions,\n\t\t\t    selectedSuggestion = _state.selectedSuggestion;\n\t\t\t// only have to worry about scrolling selected suggestion into view\n\t\t\t// when already expanded\n\n\t\t\tif (showSuggestions && selectedSuggestion !== null && !this.scrollingIntoView) {\n\t\t\t\tthis.scrollingIntoView = true;\n\t\t\t\tscrollIntoView(this.suggestionNodes[selectedSuggestion], this.autocompleteRef.current, {\n\t\t\t\t\tonlyScrollIfNeeded: true\n\t\t\t\t});\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t_this2.scrollingIntoView = false;\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t}\n\n\t\t/**\n      * Component unmount method.\n      * \n      * @since 3.6\n      */\n\n\t}, {\n\t\tkey: \"componentWillUnmount\",\n\t\tvalue: function componentWillUnmount() {\n\t\t\tdelete this.suggestionsRequest;\n\t\t}\n\n\t\t/**\n      * Bind suggestion to node.\n      * \n      * @param {*} index \n      */\n\n\t}, {\n\t\tkey: \"bindSuggestionNode\",\n\t\tvalue: function bindSuggestionNode(index) {\n\t\t\tvar _this3 = this;\n\n\t\t\treturn function (ref) {\n\t\t\t\t_this3.suggestionNodes[index] = ref;\n\t\t\t};\n\t\t}\n\t}, {\n\t\tkey: \"searchAffiliateLinks\",\n\t\tvalue: function searchAffiliateLinks(value) {\n\t\t\tvar _this4 = this;\n\n\t\t\t// Show the suggestions after typing at least 2 characters=\n\t\t\tif (value.length < 2) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tshowSuggestions: false,\n\t\t\t\t\tselectedSuggestion: null,\n\t\t\t\t\tloading: false\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setState({\n\t\t\t\tshowSuggestions: true,\n\t\t\t\tselectedSuggestion: null,\n\t\t\t\tloading: true\n\t\t\t});\n\n\t\t\tvar formData = new FormData();\n\t\t\tformData.append(\"action\", \"search_affiliate_links_query\");\n\t\t\tformData.append(\"keyword\", value);\n\t\t\tformData.append(\"paged\", 1);\n\t\t\tformData.append(\"gutenberg\", true);\n\t\t\tformData.append(\"with_images\", true);\n\n\t\t\t// We are getting data via the WP AJAX instead of rest API as it is not possible yet\n\t\t\t// to filter results with category value. This is to prepare next update to add category filter.\n\t\t\tvar request = fetch(ajaxurl, {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tbody: formData\n\t\t\t});\n\n\t\t\trequest.then(function (response) {\n\t\t\t\treturn response.json();\n\t\t\t}).then(function (response) {\n\n\t\t\t\tif (!response.affiliate_links) return;\n\n\t\t\t\tvar posts = response.affiliate_links;\n\n\t\t\t\t// A fetch Promise doesn't have an abort option. It's mimicked by\n\t\t\t\t// comparing the request reference in on the instance, which is\n\t\t\t\t// reset or deleted on subsequent requests or unmounting.\n\t\t\t\tif (_this4.suggestionsRequest !== request) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t_this4.setState({\n\t\t\t\t\tposts: posts,\n\t\t\t\t\tloading: false\n\t\t\t\t});\n\n\t\t\t\tif (!!posts.length) {\n\t\t\t\t\t_this4.props.debouncedSpeak(sprintf(_n('%d result found, use up and down arrow keys to navigate.', '%d results found, use up and down arrow keys to navigate.', posts.length), posts.length), 'assertive');\n\t\t\t\t} else {\n\t\t\t\t\t_this4.props.debouncedSpeak(__('No results.'), 'assertive');\n\t\t\t\t}\n\t\t\t}).catch(function () {\n\t\t\t\tif (_this4.suggestionsRequest === request) {\n\t\t\t\t\t_this4.setState({\n\t\t\t\t\t\tloading: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.suggestionsRequest = request;\n\t\t}\n\n\t\t/**\n      * Set state when an affiliate link is selected.\n      * \n      * @since 3.6\n      * \n      * @param {*} post \n      */\n\n\t}, {\n\t\tkey: \"selectLink\",\n\t\tvalue: function selectLink(post) {\n\t\t\t// this.props.onChange( post.link, post );\n\t\t\tthis.setState({\n\t\t\t\tselectedSuggestion: post,\n\t\t\t\tshowSuggestions: false\n\t\t\t});\n\n\t\t\tthis.props.updateImageSelection(post.images, post);\n\t\t}\n\n\t\t/**\n      * Callback handler for when affiliate link is selected.\n      * \n      * @param {*} post \n      */\n\n\t}, {\n\t\tkey: \"handleOnClick\",\n\t\tvalue: function handleOnClick(post) {\n\t\t\tthis.selectLink(post);\n\t\t\t// Move focus to the input field when a link suggestion is clicked.\n\t\t\t// this.inputRef.current.focus();\n\t\t}\n\t}, {\n\t\tkey: \"render\",\n\t\tvalue: function render() {\n\t\t\tvar _this5 = this;\n\n\t\t\tvar _props = this.props,\n\t\t\t    _props$value = _props.value,\n\t\t\t    value = _props$value === undefined ? '' : _props$value,\n\t\t\t    _props$autoFocus = _props.autoFocus,\n\t\t\t    autoFocus = _props$autoFocus === undefined ? true : _props$autoFocus,\n\t\t\t    instanceId = _props.instanceId;\n\t\t\tvar _state2 = this.state,\n\t\t\t    showSuggestions = _state2.showSuggestions,\n\t\t\t    posts = _state2.posts,\n\t\t\t    selectedSuggestion = _state2.selectedSuggestion,\n\t\t\t    loading = _state2.loading;\n\n\n\t\t\treturn wp.element.createElement(\n\t\t\t\t\"div\",\n\t\t\t\t{ \"class\": \"edit-search-affiliate-links\" },\n\t\t\t\twp.element.createElement(\n\t\t\t\t\t\"form\",\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"editor-format-toolbar__link-container-content ta-link-search-popover\",\n\t\t\t\t\t\tonSubmit: this.displayAffiliateImages\n\t\t\t\t\t},\n\t\t\t\t\twp.element.createElement(TextControl, {\n\t\t\t\t\t\ttype: \"text\",\n\t\t\t\t\t\tclassName: \"ta-search-affiliate-links\",\n\t\t\t\t\t\tplaceholder: __(\"Type to search affiliate links\"),\n\t\t\t\t\t\tonChange: this.searchAffiliateLinks,\n\t\t\t\t\t\tautocomplete: \"off\"\n\t\t\t\t\t}),\n\t\t\t\t\tloading && wp.element.createElement(Spinner, null),\n\t\t\t\t\tshowSuggestions && !!posts.length && wp.element.createElement(\n\t\t\t\t\t\tPopover,\n\t\t\t\t\t\t{ position: \"bottom\", focusOnMount: false },\n\t\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t{ \"class\": \"affilate-links-suggestions\" },\n\t\t\t\t\t\t\tposts.map(function (post, index) {\n\t\t\t\t\t\t\t\treturn wp.element.createElement(\n\t\t\t\t\t\t\t\t\t\"button\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tkey: post.id,\n\t\t\t\t\t\t\t\t\t\trole: \"option\",\n\t\t\t\t\t\t\t\t\t\ttabIndex: \"-1\",\n\t\t\t\t\t\t\t\t\t\tid: \"editor-url-input-suggestion-\" + instanceId + \"-\" + index,\n\t\t\t\t\t\t\t\t\t\tref: _this5.bindSuggestionNode(index),\n\t\t\t\t\t\t\t\t\t\tclassName: __WEBPACK_IMPORTED_MODULE_0_classnames___default()('editor-url-input__suggestion', {\n\t\t\t\t\t\t\t\t\t\t\t'is-selected': index === selectedSuggestion\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\tonClick: function onClick() {\n\t\t\t\t\t\t\t\t\t\t\treturn _this5.handleOnClick(post);\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\"aria-selected\": index === selectedSuggestion\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tpost.title || __('(no title)')\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}]);\n\n\treturn ThirstyURLInput;\n}(Component);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (withSpokenMessages(withInstanceId(ThirstyURLInput)));\n\n/***/ }),\n/* 8 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = registerFormats;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__ta_link__ = __webpack_require__(9);\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\n\n\nvar registerFormatType = wp.richText.registerFormatType;\n\n/**\n * Register custom formats.\n * \n * @since 3.6\n */\n\nfunction registerFormats() {\n\n    [__WEBPACK_IMPORTED_MODULE_0__ta_link__[\"a\" /* taLink */]].forEach(function (_ref) {\n        var name = _ref.name,\n            settings = _objectWithoutProperties(_ref, [\"name\"]);\n\n        return registerFormatType(name, settings);\n    });\n}\n\n/***/ }),\n/* 9 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return taLink; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__inline__ = __webpack_require__(10);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\nvar __ = wp.i18n.__;\nvar _wp$element = wp.element,\n    Component = _wp$element.Component,\n    Fragment = _wp$element.Fragment;\nvar withSpokenMessages = wp.components.withSpokenMessages;\nvar _wp$richText = wp.richText,\n    getTextContent = _wp$richText.getTextContent,\n    applyFormat = _wp$richText.applyFormat,\n    removeFormat = _wp$richText.removeFormat,\n    slice = _wp$richText.slice;\nvar isURL = wp.url.isURL;\nvar _wp$editor = wp.editor,\n    RichTextToolbarButton = _wp$editor.RichTextToolbarButton,\n    RichTextShortcut = _wp$editor.RichTextShortcut;\nvar _wp$components = wp.components,\n    Path = _wp$components.Path,\n    SVG = _wp$components.SVG;\n\n\nvar name = \"ta/link\";\n\n/**\n * Custom Affiliate link format. When applied will wrap selected text with <ta href=\"\" linkid=\"\"></ta> custom element.\n * Custom element is implemented here as we are not allowed to use <a> tag due to Gutenberg limitations.\n * Element is converted to normal <a> tag on frontend via PHP script filtered on 'the_content'.\n * \n * @since 3.6\n */\nvar taLink = {\n\tname: name,\n\ttitle: __(\"Affiliate Link\"),\n\ttagName: \"ta\",\n\tclassName: null,\n\tattributes: {\n\t\turl: \"href\",\n\t\ttarget: \"target\"\n\t},\n\tedit: withSpokenMessages(function (_Component) {\n\t\t_inherits(LinkEdit, _Component);\n\n\t\t/**\n   * Component constructor.\n   * \n   * @since 3.6\n   */\n\t\tfunction LinkEdit() {\n\t\t\t_classCallCheck(this, LinkEdit);\n\n\t\t\tvar _this = _possibleConstructorReturn(this, (LinkEdit.__proto__ || Object.getPrototypeOf(LinkEdit)).apply(this, arguments));\n\n\t\t\t_this.addLink = _this.addLink.bind(_this);\n\t\t\t_this.stopAddingLink = _this.stopAddingLink.bind(_this);\n\t\t\t_this.onRemoveFormat = _this.onRemoveFormat.bind(_this);\n\t\t\t_this.state = {\n\t\t\t\taddingLink: false\n\t\t\t};\n\t\t\treturn _this;\n\t\t}\n\n\t\t/**\n   * Callback to set state to adding link status.\n   * \n   * @since 3.6\n   */\n\n\n\t\t_createClass(LinkEdit, [{\n\t\t\tkey: \"addLink\",\n\t\t\tvalue: function addLink() {\n\t\t\t\tvar _props = this.props,\n\t\t\t\t    value = _props.value,\n\t\t\t\t    onChange = _props.onChange;\n\n\t\t\t\tvar text = getTextContent(slice(value));\n\n\t\t\t\tif (text && isURL(text)) {\n\t\t\t\t\tonChange(applyFormat(value, { type: name, attributes: { url: text } }));\n\t\t\t\t} else {\n\t\t\t\t\tthis.setState({ addingLink: true });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n    * Callback to set state to stop adding link status.\n    * \n    * @since 3.6\n    */\n\n\t\t}, {\n\t\t\tkey: \"stopAddingLink\",\n\t\t\tvalue: function stopAddingLink() {\n\t\t\t\tthis.setState({ addingLink: false });\n\t\t\t}\n\n\t\t\t/**\n    * Remove format event callback.\n    * \n    * @since 3.6\n    */\n\n\t\t}, {\n\t\t\tkey: \"onRemoveFormat\",\n\t\t\tvalue: function onRemoveFormat() {\n\t\t\t\tvar _props2 = this.props,\n\t\t\t\t    value = _props2.value,\n\t\t\t\t    onChange = _props2.onChange,\n\t\t\t\t    speak = _props2.speak;\n\n\n\t\t\t\tonChange(removeFormat(value, name));\n\t\t\t\tspeak(__(\"Affiliate Link removed.\"), \"assertive\");\n\t\t\t}\n\n\t\t\t/**\n    * Component render method.\n    * \n    * @since 3.6\n    */\n\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render() {\n\t\t\t\tvar _props3 = this.props,\n\t\t\t\t    isActive = _props3.isActive,\n\t\t\t\t    activeAttributes = _props3.activeAttributes,\n\t\t\t\t    value = _props3.value,\n\t\t\t\t    onChange = _props3.onChange;\n\n\n\t\t\t\treturn wp.element.createElement(\n\t\t\t\t\tFragment,\n\t\t\t\t\tnull,\n\t\t\t\t\twp.element.createElement(RichTextShortcut, {\n\t\t\t\t\t\ttype: \"access\",\n\t\t\t\t\t\tcharacter: \"s\",\n\t\t\t\t\t\tonUse: this.onRemoveFormat\n\t\t\t\t\t}),\n\t\t\t\t\twp.element.createElement(RichTextShortcut, {\n\t\t\t\t\t\ttype: \"primary\",\n\t\t\t\t\t\tcharacter: \"l\",\n\t\t\t\t\t\tonUse: this.addLink\n\t\t\t\t\t}),\n\t\t\t\t\twp.element.createElement(RichTextShortcut, {\n\t\t\t\t\t\ttype: \"primaryShift\",\n\t\t\t\t\t\tcharacter: \"l\",\n\t\t\t\t\t\tonUse: this.onRemoveFormat\n\t\t\t\t\t}),\n\t\t\t\t\tisActive && wp.element.createElement(RichTextToolbarButton, {\n\t\t\t\t\t\ticon: \"editor-unlink\",\n\t\t\t\t\t\ttitle: __('Remove Affiliate Link'),\n\t\t\t\t\t\tclassName: \"ta-unlink-button\",\n\t\t\t\t\t\tonClick: this.onRemoveFormat,\n\t\t\t\t\t\tisActive: isActive,\n\t\t\t\t\t\tshortcutType: \"primaryShift\",\n\t\t\t\t\t\tshortcutCharacter: \"l\"\n\t\t\t\t\t}),\n\t\t\t\t\t!isActive && wp.element.createElement(RichTextToolbarButton, {\n\t\t\t\t\t\ticon: wp.element.createElement(\n\t\t\t\t\t\t\tSVG,\n\t\t\t\t\t\t\t{ xmlns: \"http://www.w3.org/2000/svg\", width: \"16.688\", height: \"9.875\", viewBox: \"0 0 16.688 9.875\" },\n\t\t\t\t\t\t\twp.element.createElement(Path, { id: \"TA.svg\", fill: \"black\", \"class\": \"cls-1\", d: \"M2.115,15.12H4.847L6.836,7.7H9.777l0.63-2.381H1.821L1.177,7.7H4.118Zm4.758,0H9.829l1.177-1.751h3.782l0.238,1.751h2.858L16.357,5.245H13.7Zm5.5-3.866,1.835-2.816,0.35,2.816H12.378Z\", transform: \"translate(-1.188 -5.25)\" })\n\t\t\t\t\t\t),\n\t\t\t\t\t\ttitle: __('Affiliate Link'),\n\t\t\t\t\t\tclassName: \"ta-link-button\",\n\t\t\t\t\t\tonClick: this.addLink,\n\t\t\t\t\t\tshortcutType: \"primary\",\n\t\t\t\t\t\tshortcutCharacter: \"l\"\n\t\t\t\t\t}),\n\t\t\t\t\twp.element.createElement(__WEBPACK_IMPORTED_MODULE_0__inline__[\"a\" /* default */], {\n\t\t\t\t\t\taddingLink: this.state.addingLink,\n\t\t\t\t\t\tstopAddingLink: this.stopAddingLink,\n\t\t\t\t\t\tisActive: isActive,\n\t\t\t\t\t\tactiveAttributes: activeAttributes,\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\tonChange: onChange\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t}]);\n\n\t\treturn LinkEdit;\n\t}(Component))\n};\n\n/***/ }),\n/* 10 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_classnames__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_classnames___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_classnames__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__positioned_at_selection__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__url_popover__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__url_input__ = __webpack_require__(14);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\n\n\n\nvar __ = wp.i18n.__;\nvar _wp$element = wp.element,\n    Component = _wp$element.Component,\n    createRef = _wp$element.createRef;\nvar _wp$components = wp.components,\n    ExternalLink = _wp$components.ExternalLink,\n    ToggleControl = _wp$components.ToggleControl,\n    IconButton = _wp$components.IconButton,\n    withSpokenMessages = _wp$components.withSpokenMessages;\nvar _wp$keycodes = wp.keycodes,\n    LEFT = _wp$keycodes.LEFT,\n    RIGHT = _wp$keycodes.RIGHT,\n    UP = _wp$keycodes.UP,\n    DOWN = _wp$keycodes.DOWN,\n    BACKSPACE = _wp$keycodes.BACKSPACE,\n    ENTER = _wp$keycodes.ENTER;\nvar _wp$url = wp.url,\n    prependHTTP = _wp$url.prependHTTP,\n    safeDecodeURI = _wp$url.safeDecodeURI,\n    filterURLForDisplay = _wp$url.filterURLForDisplay;\nvar _wp$richText = wp.richText,\n    create = _wp$richText.create,\n    insert = _wp$richText.insert,\n    isCollapsed = _wp$richText.isCollapsed,\n    applyFormat = _wp$richText.applyFormat,\n    getTextContent = _wp$richText.getTextContent,\n    slice = _wp$richText.slice;\n\n\nvar stopKeyPropagation = function stopKeyPropagation(event) {\n\treturn event.stopPropagation();\n};\n\n/**\n * Generates the format object that will be applied to the link text.\n * \n * @since 3.6\n *\n * @param {string}  url    The href of the link.\n * @param {boolean} linkid Affiliate link ID.\n * @param {Object}  text   The text that is being hyperlinked.\n *\n * @return {Object} The final format object.\n */\nfunction createLinkFormat(_ref) {\n\tvar url = _ref.url,\n\t    linkid = _ref.linkid,\n\t    text = _ref.text;\n\n\tvar format = {\n\t\ttype: \"ta/link\",\n\t\tattributes: {\n\t\t\turl: url,\n\t\t\tlinkid: linkid.toString()\n\t\t}\n\t};\n\n\treturn format;\n}\n\n/**\n * Check if input is being show.\n * \n * @since 3.6\n * \n * @param {Object} props Component props.\n * @param {Object} state Component state.\n */\nfunction isShowingInput(props, state) {\n\treturn props.addingLink || state.editLink;\n}\n\n/**\n * Affiliate Link editor JSX element.\n * \n * @since 3.6\n * \n * @param {Object} param0 Component props (destructred).\n */\nvar LinkEditor = function LinkEditor(_ref2) {\n\tvar value = _ref2.value,\n\t    onChangeInputValue = _ref2.onChangeInputValue,\n\t    onKeyDown = _ref2.onKeyDown,\n\t    submitLink = _ref2.submitLink,\n\t    invalidLink = _ref2.invalidLink,\n\t    resetInvalidLink = _ref2.resetInvalidLink,\n\t    autocompleteRef = _ref2.autocompleteRef;\n\treturn (\n\t\t// Disable reason: KeyPress must be suppressed so the block doesn't hide the toolbar\n\t\t/* eslint-disable jsx-a11y/no-noninteractive-element-interactions */\n\t\twp.element.createElement(\n\t\t\t'form',\n\t\t\t{\n\t\t\t\tclassName: 'editor-format-toolbar__link-container-content ta-link-search-popover',\n\t\t\t\tonKeyPress: stopKeyPropagation,\n\t\t\t\tonKeyDown: onKeyDown,\n\t\t\t\tonSubmit: submitLink\n\t\t\t},\n\t\t\twp.element.createElement(__WEBPACK_IMPORTED_MODULE_4__url_input__[\"a\" /* default */], {\n\t\t\t\tvalue: value,\n\t\t\t\tonChange: onChangeInputValue,\n\t\t\t\tautocompleteRef: autocompleteRef,\n\t\t\t\tinvalidLink: invalidLink,\n\t\t\t\tresetInvalidLink: resetInvalidLink\n\t\t\t}),\n\t\t\twp.element.createElement(IconButton, { icon: 'editor-break', label: __('Apply'), type: 'submit' })\n\t\t)\n\t\t/* eslint-enable jsx-a11y/no-noninteractive-element-interactions */\n\n\t);\n};\n\n/**\n * Affiliate link url viewer JSX element.\n * \n * @param {*} param0 Component props (destructred).\n */\nvar LinkViewerUrl = function LinkViewerUrl(_ref3) {\n\tvar url = _ref3.url;\n\n\tvar prependedURL = prependHTTP(url);\n\tvar linkClassName = __WEBPACK_IMPORTED_MODULE_0_classnames___default()('editor-format-toolbar__link-container-value', {\n\t\t'has-invalid-link': !Object(__WEBPACK_IMPORTED_MODULE_2__utils__[\"a\" /* isValidHref */])(prependedURL)\n\t});\n\n\tif (!url) {\n\t\treturn wp.element.createElement('span', { className: linkClassName });\n\t}\n\n\treturn wp.element.createElement(\n\t\tExternalLink,\n\t\t{\n\t\t\tclassName: linkClassName,\n\t\t\thref: url\n\t\t},\n\t\tfilterURLForDisplay(safeDecodeURI(url))\n\t);\n};\n\n/**\n * Affiliate link viewer JSX element.\n * \n * @param {*} param0 Component props (destructred).\n */\nvar LinkViewer = function LinkViewer(_ref4) {\n\tvar url = _ref4.url,\n\t    editLink = _ref4.editLink;\n\n\treturn (\n\t\t// Disable reason: KeyPress must be suppressed so the block doesn't hide the toolbar\n\t\t/* eslint-disable jsx-a11y/no-static-element-interactions */\n\t\twp.element.createElement(\n\t\t\t'div',\n\t\t\t{\n\t\t\t\tclassName: 'editor-format-toolbar__link-container-content',\n\t\t\t\tonKeyPress: stopKeyPropagation\n\t\t\t},\n\t\t\twp.element.createElement(LinkViewerUrl, { url: url }),\n\t\t\twp.element.createElement(IconButton, { icon: 'edit', label: __('Edit'), onClick: editLink })\n\t\t)\n\t\t/* eslint-enable jsx-a11y/no-static-element-interactions */\n\n\t);\n};\n\n/**\n * Inline affiliate link UI Component.\n * \n * @since 3.6\n * \n * @param {*} param0 Component props (destructred).\n */\n\nvar InlineAffiliateLinkUI = function (_Component) {\n\t_inherits(InlineAffiliateLinkUI, _Component);\n\n\tfunction InlineAffiliateLinkUI() {\n\t\t_classCallCheck(this, InlineAffiliateLinkUI);\n\n\t\tvar _this = _possibleConstructorReturn(this, (InlineAffiliateLinkUI.__proto__ || Object.getPrototypeOf(InlineAffiliateLinkUI)).apply(this, arguments));\n\n\t\t_this.editLink = _this.editLink.bind(_this);\n\t\t_this.submitLink = _this.submitLink.bind(_this);\n\t\t_this.onKeyDown = _this.onKeyDown.bind(_this);\n\t\t_this.onChangeInputValue = _this.onChangeInputValue.bind(_this);\n\t\t_this.onClickOutside = _this.onClickOutside.bind(_this);\n\t\t_this.resetState = _this.resetState.bind(_this);\n\t\t_this.autocompleteRef = createRef();\n\t\t_this.resetInvalidLink = _this.resetInvalidLink.bind(_this);\n\n\t\t_this.state = {\n\t\t\tinputValue: '',\n\t\t\tlinkid: 0,\n\t\t\tpost: null,\n\t\t\tinvalidLink: false\n\t\t};\n\t\treturn _this;\n\t}\n\n\t/**\n  * Stop the key event from propagating up to ObserveTyping.startTypingInTextField.\n  * \n  * @since 3.6\n  * \n  * @param {Object} event Event object.\n  */\n\n\n\t_createClass(InlineAffiliateLinkUI, [{\n\t\tkey: 'onKeyDown',\n\t\tvalue: function onKeyDown(event) {\n\t\t\tif ([LEFT, DOWN, RIGHT, UP, BACKSPACE, ENTER].indexOf(event.keyCode) > -1) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t}\n\n\t\t/**\n   * Callback to set state when input value is changed.\n   * \n   * @since 3.6\n   * \n   * @param {*} inputValue \n   * @param {*} post \n   */\n\n\t}, {\n\t\tkey: 'onChangeInputValue',\n\t\tvalue: function onChangeInputValue(inputValue) {\n\t\t\tvar post = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n\t\t\tvar linkid = post ? post.id : 0;\n\t\t\tthis.setState({ inputValue: inputValue, linkid: linkid, post: post });\n\t\t}\n\n\t\t/**\n   * Callback to set state when edit affiliate link (already inserted) is triggered.\n   * \n   * @since 3.6\n   * \n   * @param {*} event \n   */\n\n\t}, {\n\t\tkey: 'editLink',\n\t\tvalue: function editLink(event) {\n\t\t\tthis.setState({ editLink: true });\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\t/**\n   * Callback to apply the affiliate link format to the selected text or position in the active block.\n   * \n   * @since 3.6\n   * \n   * @param {*} event \n   */\n\n\t}, {\n\t\tkey: 'submitLink',\n\t\tvalue: function submitLink(event) {\n\t\t\tvar _props = this.props,\n\t\t\t    isActive = _props.isActive,\n\t\t\t    value = _props.value,\n\t\t\t    onChange = _props.onChange,\n\t\t\t    speak = _props.speak;\n\t\t\tvar _state = this.state,\n\t\t\t    inputValue = _state.inputValue,\n\t\t\t    linkid = _state.linkid,\n\t\t\t    post = _state.post;\n\n\t\t\tvar url = prependHTTP(inputValue);\n\t\t\tvar selectedText = getTextContent(slice(value));\n\t\t\tvar format = createLinkFormat({\n\t\t\t\turl: url,\n\t\t\t\tlinkid: linkid,\n\t\t\t\ttext: selectedText\n\t\t\t});\n\n\t\t\tevent.preventDefault();\n\n\t\t\tif (!linkid || !post) {\n\t\t\t\tthis.setState({ invalidLink: true });\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (isCollapsed(value) && !isActive) {\n\t\t\t\tvar toInsert = applyFormat(create({ text: post.title }), format, 0, url.length);\n\t\t\t\tonChange(insert(value, toInsert));\n\t\t\t} else {\n\t\t\t\tonChange(applyFormat(value, format));\n\t\t\t}\n\n\t\t\tthis.resetState();\n\n\t\t\tif (!Object(__WEBPACK_IMPORTED_MODULE_2__utils__[\"a\" /* isValidHref */])(url)) {\n\t\t\t\tspeak(__('Warning: the link has been inserted but may have errors. Please test it.'), 'assertive');\n\t\t\t} else if (isActive) {\n\t\t\t\tspeak(__('Link edited.'), 'assertive');\n\t\t\t} else {\n\t\t\t\tspeak(__('Link inserted'), 'assertive');\n\t\t\t}\n\t\t}\n\n\t\t/**\n   * Callback to run when users clicks outside the popover UI.\n   * \n   * @since 3.6\n   * \n   * @param {*} event \n   */\n\n\t}, {\n\t\tkey: 'onClickOutside',\n\t\tvalue: function onClickOutside(event) {\n\t\t\t// The autocomplete suggestions list renders in a separate popover (in a portal),\n\t\t\t// so onClickOutside fails to detect that a click on a suggestion occured in the\n\t\t\t// LinkContainer. Detect clicks on autocomplete suggestions using a ref here, and\n\t\t\t// return to avoid the popover being closed.\n\t\t\tvar autocompleteElement = this.autocompleteRef.current;\n\t\t\tif (autocompleteElement && autocompleteElement.contains(event.target)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.resetState();\n\t\t}\n\n\t\t/**\n   * Reset state callback.\n   * \n   * @since 3.6\n   */\n\n\t}, {\n\t\tkey: 'resetState',\n\t\tvalue: function resetState() {\n\t\t\tthis.props.stopAddingLink();\n\t\t\tthis.setState({ inputValue: '', editLink: false });\n\t\t\tthis.resetInvalidLink();\n\t\t}\n\n\t\t/**\n   * Reset invalid link state callback. Separated as we need to run this independently from resetState() callback.\n   * \n   * @since 3.6\n   */\n\n\t}, {\n\t\tkey: 'resetInvalidLink',\n\t\tvalue: function resetInvalidLink() {\n\t\t\tthis.setState({ invalidLink: false });\n\t\t}\n\n\t\t/**\n   * Component render method.\n   *\n   * @since 3.6\n   */\n\n\t}, {\n\t\tkey: 'render',\n\t\tvalue: function render() {\n\t\t\tvar _props2 = this.props,\n\t\t\t    isActive = _props2.isActive,\n\t\t\t    _props2$activeAttribu = _props2.activeAttributes,\n\t\t\t    url = _props2$activeAttribu.url,\n\t\t\t    linkid = _props2$activeAttribu.linkid,\n\t\t\t    addingLink = _props2.addingLink,\n\t\t\t    value = _props2.value,\n\t\t\t    onChange = _props2.onChange;\n\n\n\t\t\tif (!isActive && !addingLink) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar _state2 = this.state,\n\t\t\t    inputValue = _state2.inputValue,\n\t\t\t    invalidLink = _state2.invalidLink;\n\n\t\t\tvar showInput = isShowingInput(this.props, this.state);\n\n\t\t\treturn wp.element.createElement(\n\t\t\t\t__WEBPACK_IMPORTED_MODULE_1__positioned_at_selection__[\"a\" /* default */],\n\t\t\t\t{\n\t\t\t\t\tkey: '' + value.start + value.end /* Used to force rerender on selection change */\n\t\t\t\t},\n\t\t\t\twp.element.createElement(\n\t\t\t\t\t__WEBPACK_IMPORTED_MODULE_3__url_popover__[\"a\" /* default */],\n\t\t\t\t\t{\n\t\t\t\t\t\tonClickOutside: this.onClickOutside,\n\t\t\t\t\t\tonClose: this.resetState,\n\t\t\t\t\t\tfocusOnMount: showInput ? 'firstElement' : false,\n\t\t\t\t\t\tinvalidLink: invalidLink\n\t\t\t\t\t},\n\t\t\t\t\tshowInput ? wp.element.createElement(LinkEditor, {\n\t\t\t\t\t\tvalue: inputValue,\n\t\t\t\t\t\tonChangeInputValue: this.onChangeInputValue,\n\t\t\t\t\t\tonKeyDown: this.onKeyDown,\n\t\t\t\t\t\tsubmitLink: this.submitLink,\n\t\t\t\t\t\tautocompleteRef: this.autocompleteRef,\n\t\t\t\t\t\tupdateLinkId: this.updateLinkId,\n\t\t\t\t\t\tinvalidLink: invalidLink,\n\t\t\t\t\t\tresetInvalidLink: this.resetInvalidLink\n\t\t\t\t\t}) : wp.element.createElement(LinkViewer, {\n\t\t\t\t\t\turl: url,\n\t\t\t\t\t\teditLink: this.editLink\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}]);\n\n\treturn InlineAffiliateLinkUI;\n}(Component);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (withSpokenMessages(InlineAffiliateLinkUI));\n\n/***/ }),\n/* 11 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Component = wp.element.Component;\nvar _wp$dom = wp.dom,\n    getOffsetParent = _wp$dom.getOffsetParent,\n    getRectangleFromRange = _wp$dom.getRectangleFromRange;\n\n/**\n * Returns a style object for applying as `position: absolute` for an element\n * relative to the bottom-center of the current selection. Includes `top` and\n * `left` style properties.\n * \n * @since 3.6\n *\n * @return {Object} Style object.\n */\n\nfunction getCurrentCaretPositionStyle() {\n\tvar selection = window.getSelection();\n\n\t// Unlikely, but in the case there is no selection, return empty styles so\n\t// as to avoid a thrown error by `Selection#getRangeAt` on invalid index.\n\tif (selection.rangeCount === 0) {\n\t\treturn {};\n\t}\n\n\t// Get position relative viewport.\n\tvar rect = getRectangleFromRange(selection.getRangeAt(0));\n\tvar top = rect.top + rect.height;\n\tvar left = rect.left + rect.width / 2;\n\n\t// Offset by positioned parent, if one exists.\n\tvar offsetParent = getOffsetParent(selection.anchorNode);\n\tif (offsetParent) {\n\t\tvar parentRect = offsetParent.getBoundingClientRect();\n\t\ttop -= parentRect.top;\n\t\tleft -= parentRect.left;\n\t}\n\n\treturn { top: top, left: left };\n}\n\n/**\n * Component which renders itself positioned under the current caret selection.\n * The position is calculated at the time of the component being mounted, so it\n * should only be mounted after the desired selection has been made.\n * \n * @since 3.6\n *\n * @type {WPComponent}\n */\n\nvar ThirstyPositionedAtSelection = function (_Component) {\n\t_inherits(ThirstyPositionedAtSelection, _Component);\n\n\t/**\n  * Component constructor method.\n  * \n  * @since 3.6\n  */\n\tfunction ThirstyPositionedAtSelection() {\n\t\t_classCallCheck(this, ThirstyPositionedAtSelection);\n\n\t\tvar _this = _possibleConstructorReturn(this, (ThirstyPositionedAtSelection.__proto__ || Object.getPrototypeOf(ThirstyPositionedAtSelection)).apply(this, arguments));\n\n\t\t_this.state = {\n\t\t\tstyle: getCurrentCaretPositionStyle()\n\t\t};\n\t\treturn _this;\n\t}\n\n\t/**\n  * Component render method.\n  * \n  * @since 3.6\n  */\n\n\n\t_createClass(ThirstyPositionedAtSelection, [{\n\t\tkey: \"render\",\n\t\tvalue: function render() {\n\t\t\tvar children = this.props.children;\n\t\t\tvar style = this.state.style;\n\n\n\t\t\treturn wp.element.createElement(\n\t\t\t\t\"div\",\n\t\t\t\t{ className: \"editor-format-toolbar__selection-position\", style: style },\n\t\t\t\tchildren\n\t\t\t);\n\t\t}\n\t}]);\n\n\treturn ThirstyPositionedAtSelection;\n}(Component);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ThirstyPositionedAtSelection);\n\n/***/ }),\n/* 12 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = isValidHref;\nvar _lodash = lodash,\n    startsWith = _lodash.startsWith;\nvar _wp$url = wp.url,\n    getProtocol = _wp$url.getProtocol,\n    isValidProtocol = _wp$url.isValidProtocol,\n    getAuthority = _wp$url.getAuthority,\n    isValidAuthority = _wp$url.isValidAuthority,\n    getPath = _wp$url.getPath,\n    isValidPath = _wp$url.isValidPath,\n    getQueryString = _wp$url.getQueryString,\n    isValidQueryString = _wp$url.isValidQueryString,\n    getFragment = _wp$url.getFragment,\n    isValidFragment = _wp$url.isValidFragment;\n\n/**\n * Check for issues with the provided href.\n * \n * @since 3.6\n *\n * @param {string} href The href.\n * @return {boolean} Is the href invalid?\n */\n\nfunction isValidHref(href) {\n\tif (!href) {\n\t\treturn false;\n\t}\n\n\tvar trimmedHref = href.trim();\n\n\tif (!trimmedHref) {\n\t\treturn false;\n\t}\n\n\t// Does the href start with something that looks like a URL protocol?\n\tif (/^\\S+:/.test(trimmedHref)) {\n\t\tvar protocol = getProtocol(trimmedHref);\n\t\tif (!isValidProtocol(protocol)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Add some extra checks for http(s) URIs, since these are the most common use-case.\n\t\t// This ensures URIs with an http protocol have exactly two forward slashes following the protocol.\n\t\tif (startsWith(protocol, 'http') && !/^https?:\\/\\/[^\\/\\s]/i.test(trimmedHref)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar authority = getAuthority(trimmedHref);\n\t\tif (!isValidAuthority(authority)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar path = getPath(trimmedHref);\n\t\tif (path && !isValidPath(path)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar queryString = getQueryString(trimmedHref);\n\t\tif (queryString && !isValidQueryString(queryString)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar fragment = getFragment(trimmedHref);\n\t\tif (fragment && !isValidFragment(fragment)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t// Validate anchor links.\n\tif (startsWith(trimmedHref, '#') && !isValidFragment(trimmedHref)) {\n\t\treturn false;\n\t}\n\n\treturn true;\n}\n\n/***/ }),\n/* 13 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar __ = wp.i18n.__;\nvar Component = wp.element.Component;\nvar _wp$components = wp.components,\n    Popover = _wp$components.Popover,\n    IconButton = _wp$components.IconButton;\n\n/**\n * Custom URL Popover component.\n * \n * @since 3.6\n */\n\nvar ThirstyURLPopover = function (_Component) {\n\t_inherits(ThirstyURLPopover, _Component);\n\n\t/**\n  * Component constructor method.\n  * \n  * @since 3.6\n  */\n\tfunction ThirstyURLPopover() {\n\t\t_classCallCheck(this, ThirstyURLPopover);\n\n\t\tvar _this = _possibleConstructorReturn(this, (ThirstyURLPopover.__proto__ || Object.getPrototypeOf(ThirstyURLPopover)).apply(this, arguments));\n\n\t\t_this.toggleSettingsVisibility = _this.toggleSettingsVisibility.bind(_this);\n\n\t\t_this.state = {\n\t\t\tisSettingsExpanded: false\n\t\t};\n\t\treturn _this;\n\t}\n\n\t/**\n  * Component constructor.\n  * \n  * @since 3.6\n  */\n\n\n\t_createClass(ThirstyURLPopover, [{\n\t\tkey: 'toggleSettingsVisibility',\n\t\tvalue: function toggleSettingsVisibility() {\n\t\t\tthis.setState({\n\t\t\t\tisSettingsExpanded: !this.state.isSettingsExpanded\n\t\t\t});\n\t\t}\n\n\t\t/**\n   * Component render method.\n   * \n   * @since 3.6\n   */\n\n\t}, {\n\t\tkey: 'render',\n\t\tvalue: function render() {\n\t\t\tvar _props = this.props,\n\t\t\t    children = _props.children,\n\t\t\t    renderSettings = _props.renderSettings,\n\t\t\t    onClose = _props.onClose,\n\t\t\t    onClickOutside = _props.onClickOutside,\n\t\t\t    invalidLink = _props.invalidLink,\n\t\t\t    _props$position = _props.position,\n\t\t\t    position = _props$position === undefined ? 'bottom center' : _props$position,\n\t\t\t    _props$focusOnMount = _props.focusOnMount,\n\t\t\t    focusOnMount = _props$focusOnMount === undefined ? 'firstElement' : _props$focusOnMount;\n\t\t\tvar isSettingsExpanded = this.state.isSettingsExpanded;\n\n\n\t\t\tvar showSettings = !!renderSettings && isSettingsExpanded;\n\n\t\t\treturn wp.element.createElement(\n\t\t\t\tPopover,\n\t\t\t\t{\n\t\t\t\t\tclassName: 'ta-url-popover editor-url-popover',\n\t\t\t\t\tfocusOnMount: focusOnMount,\n\t\t\t\t\tposition: position,\n\t\t\t\t\tonClose: onClose,\n\t\t\t\t\tonClickOutside: onClickOutside\n\t\t\t\t},\n\t\t\t\twp.element.createElement(\n\t\t\t\t\t'div',\n\t\t\t\t\t{ className: 'editor-url-popover__row' },\n\t\t\t\t\tchildren,\n\t\t\t\t\t!!renderSettings && wp.element.createElement(IconButton, {\n\t\t\t\t\t\tclassName: 'editor-url-popover__settings-toggle',\n\t\t\t\t\t\ticon: 'ellipsis',\n\t\t\t\t\t\tlabel: __('Link Settings'),\n\t\t\t\t\t\tonClick: this.toggleSettingsVisibility,\n\t\t\t\t\t\t'aria-expanded': isSettingsExpanded\n\t\t\t\t\t})\n\t\t\t\t),\n\t\t\t\tshowSettings && wp.element.createElement(\n\t\t\t\t\t'div',\n\t\t\t\t\t{ className: 'editor-url-popover__row editor-url-popover__settings' },\n\t\t\t\t\trenderSettings()\n\t\t\t\t),\n\t\t\t\tinvalidLink && wp.element.createElement(\n\t\t\t\t\t'div',\n\t\t\t\t\t{ 'class': 'ta-invalid-link' },\n\t\t\t\t\t__('Invalid affiliate link')\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}]);\n\n\treturn ThirstyURLPopover;\n}(Component);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ThirstyURLPopover);\n\n/***/ }),\n/* 14 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_classnames__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_classnames___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_classnames__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_dom_scroll_into_view__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_dom_scroll_into_view___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_dom_scroll_into_view__);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\nvar __ = wp.i18n.__;\nvar _lodash = lodash,\n    throttle = _lodash.throttle;\nvar _wp$element = wp.element,\n    Component = _wp$element.Component,\n    createRef = _wp$element.createRef;\nvar _wp$keycodes = wp.keycodes,\n    UP = _wp$keycodes.UP,\n    DOWN = _wp$keycodes.DOWN,\n    ENTER = _wp$keycodes.ENTER,\n    TAB = _wp$keycodes.TAB;\nvar _wp$components = wp.components,\n    Spinner = _wp$components.Spinner,\n    withSpokenMessages = _wp$components.withSpokenMessages,\n    Popover = _wp$components.Popover;\nvar withInstanceId = wp.compose.withInstanceId;\n\n// Since URLInput is rendered in the context of other inputs, but should be\n// considered a separate modal node, prevent keyboard events from propagating\n// as being considered from the input.\n\nvar stopEventPropagation = function stopEventPropagation(event) {\n\treturn event.stopPropagation();\n};\n\n/**\n * Custom URL Input component.\n * \n * @since 3.6\n */\n\nvar ThirstyURLInput = function (_Component) {\n\t_inherits(ThirstyURLInput, _Component);\n\n\t/**\n  * Component constructor method.\n  * \n  * @since 3.6\n  * \n  * @param {*} param0 \n  */\n\tfunction ThirstyURLInput(_ref) {\n\t\tvar autocompleteRef = _ref.autocompleteRef;\n\n\t\t_classCallCheck(this, ThirstyURLInput);\n\n\t\tvar _this = _possibleConstructorReturn(this, (ThirstyURLInput.__proto__ || Object.getPrototypeOf(ThirstyURLInput)).apply(this, arguments));\n\n\t\t_this.onChange = _this.onChange.bind(_this);\n\t\t_this.onKeyDown = _this.onKeyDown.bind(_this);\n\t\t_this.autocompleteRef = autocompleteRef || createRef();\n\t\t_this.inputRef = createRef();\n\t\t_this.updateSuggestions = throttle(_this.updateSuggestions.bind(_this), 200);\n\n\t\t_this.suggestionNodes = [];\n\n\t\t_this.state = {\n\t\t\tposts: [],\n\t\t\tshowSuggestions: false,\n\t\t\tselectedSuggestion: null\n\t\t};\n\t\treturn _this;\n\t}\n\n\t/**\n  * Component did update method.\n  * \n  * @since 3.6\n  */\n\n\n\t_createClass(ThirstyURLInput, [{\n\t\tkey: 'componentDidUpdate',\n\t\tvalue: function componentDidUpdate() {\n\t\t\tvar _this2 = this;\n\n\t\t\tvar _state = this.state,\n\t\t\t    showSuggestions = _state.showSuggestions,\n\t\t\t    selectedSuggestion = _state.selectedSuggestion;\n\t\t\t// only have to worry about scrolling selected suggestion into view\n\t\t\t// when already expanded\n\n\t\t\tif (showSuggestions && selectedSuggestion !== null && !this.scrollingIntoView) {\n\t\t\t\tthis.scrollingIntoView = true;\n\t\t\t\t__WEBPACK_IMPORTED_MODULE_1_dom_scroll_into_view___default()(this.suggestionNodes[selectedSuggestion], this.autocompleteRef.current, {\n\t\t\t\t\tonlyScrollIfNeeded: true\n\t\t\t\t});\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t_this2.scrollingIntoView = false;\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t}\n\n\t\t/**\n   * Component unmount method.\n   * \n   * @since 3.6\n   */\n\n\t}, {\n\t\tkey: 'componentWillUnmount',\n\t\tvalue: function componentWillUnmount() {\n\t\t\tdelete this.suggestionsRequest;\n\t\t}\n\n\t\t/**\n   * Bind suggestion to node.\n   * \n   * @param {*} index \n   */\n\n\t}, {\n\t\tkey: 'bindSuggestionNode',\n\t\tvalue: function bindSuggestionNode(index) {\n\t\t\tvar _this3 = this;\n\n\t\t\treturn function (ref) {\n\t\t\t\t_this3.suggestionNodes[index] = ref;\n\t\t\t};\n\t\t}\n\n\t\t/**\n   * Callback to show suggestions based on value inputted on search field.\n   * \n   * @since 3.6\n   * \n   * @param {*} value \n   */\n\n\t}, {\n\t\tkey: 'updateSuggestions',\n\t\tvalue: function updateSuggestions(value) {\n\t\t\tvar _this4 = this;\n\n\t\t\t// Show the suggestions after typing at least 2 characters\n\t\t\t// and also for URLs\n\t\t\tif (value.length < 2 || /^https?:/.test(value)) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tshowSuggestions: false,\n\t\t\t\t\tselectedSuggestion: null,\n\t\t\t\t\tloading: false\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setState({\n\t\t\t\tshowSuggestions: true,\n\t\t\t\tselectedSuggestion: null,\n\t\t\t\tloading: true\n\t\t\t});\n\n\t\t\tvar formData = new FormData();\n\t\t\tformData.append(\"action\", \"search_affiliate_links_query\");\n\t\t\tformData.append(\"keyword\", value);\n\t\t\tformData.append(\"paged\", 1);\n\t\t\tformData.append(\"gutenberg\", true);\n\n\t\t\t// We are getting data via the WP AJAX instead of rest API as it is not possible yet\n\t\t\t// to filter results with category value. This is to prepare next update to add category filter.\n\t\t\tvar request = fetch(ajaxurl, {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tbody: formData\n\t\t\t});\n\n\t\t\trequest.then(function (response) {\n\t\t\t\treturn response.json();\n\t\t\t}).then(function (response) {\n\n\t\t\t\tif (!response.affiliate_links) return;\n\n\t\t\t\tvar posts = response.affiliate_links;\n\n\t\t\t\t// A fetch Promise doesn't have an abort option. It's mimicked by\n\t\t\t\t// comparing the request reference in on the instance, which is\n\t\t\t\t// reset or deleted on subsequent requests or unmounting.\n\t\t\t\tif (_this4.suggestionsRequest !== request) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t_this4.setState({\n\t\t\t\t\tposts: posts,\n\t\t\t\t\tloading: false\n\t\t\t\t});\n\n\t\t\t\tif (!!posts.length) {\n\t\t\t\t\t_this4.props.debouncedSpeak(sprintf(_n('%d result found, use up and down arrow keys to navigate.', '%d results found, use up and down arrow keys to navigate.', posts.length), posts.length), 'assertive');\n\t\t\t\t} else {\n\t\t\t\t\t_this4.props.debouncedSpeak(__('No results.'), 'assertive');\n\t\t\t\t}\n\t\t\t}).catch(function () {\n\t\t\t\tif (_this4.suggestionsRequest === request) {\n\t\t\t\t\t_this4.setState({\n\t\t\t\t\t\tloading: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.suggestionsRequest = request;\n\t\t}\n\n\t\t/**\n   * Search input value change event callback method.\n   * \n   * @since 3.6\n   * \n   * @param {*} event \n   */\n\n\t}, {\n\t\tkey: 'onChange',\n\t\tvalue: function onChange(event) {\n\t\t\tthis.props.resetInvalidLink();\n\t\t\tvar inputValue = event.target.value;\n\t\t\tthis.props.onChange(inputValue);\n\t\t\tthis.updateSuggestions(inputValue);\n\t\t}\n\n\t\t/**\n   * Keydown event callback. Handles selecting result via keyboard.\n   * \n   * @since 3.6\n   * \n   * @param {*} event \n   */\n\n\t}, {\n\t\tkey: 'onKeyDown',\n\t\tvalue: function onKeyDown(event) {\n\t\t\tvar _state2 = this.state,\n\t\t\t    showSuggestions = _state2.showSuggestions,\n\t\t\t    selectedSuggestion = _state2.selectedSuggestion,\n\t\t\t    posts = _state2.posts,\n\t\t\t    loading = _state2.loading;\n\t\t\t// If the suggestions are not shown or loading, we shouldn't handle the arrow keys\n\t\t\t// We shouldn't preventDefault to allow block arrow keys navigation\n\n\t\t\tif (!showSuggestions || !posts.length || loading) {\n\t\t\t\t// In the Windows version of Firefox the up and down arrows don't move the caret\n\t\t\t\t// within an input field like they do for Mac Firefox/Chrome/Safari. This causes\n\t\t\t\t// a form of focus trapping that is disruptive to the user experience. This disruption\n\t\t\t\t// only happens if the caret is not in the first or last position in the text input.\n\t\t\t\t// See: https://github.com/WordPress/gutenberg/issues/5693#issuecomment-436684747\n\t\t\t\tswitch (event.keyCode) {\n\t\t\t\t\t// When UP is pressed, if the caret is at the start of the text, move it to the 0\n\t\t\t\t\t// position.\n\t\t\t\t\tcase UP:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (0 !== event.target.selectionStart) {\n\t\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\t\t\t// Set the input caret to position 0\n\t\t\t\t\t\t\t\tevent.target.setSelectionRange(0, 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t// When DOWN is pressed, if the caret is not at the end of the text, move it to the\n\t\t\t\t\t// last position.\n\t\t\t\t\tcase DOWN:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (this.props.value.length !== event.target.selectionStart) {\n\t\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\t\t\t// Set the input caret to the last position\n\t\t\t\t\t\t\t\tevent.target.setSelectionRange(this.props.value.length, this.props.value.length);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar post = this.state.posts[this.state.selectedSuggestion];\n\n\t\t\tswitch (event.keyCode) {\n\t\t\t\tcase UP:\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tvar previousIndex = !selectedSuggestion ? posts.length - 1 : selectedSuggestion - 1;\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tselectedSuggestion: previousIndex\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase DOWN:\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tvar nextIndex = selectedSuggestion === null || selectedSuggestion === posts.length - 1 ? 0 : selectedSuggestion + 1;\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tselectedSuggestion: nextIndex\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase TAB:\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.state.selectedSuggestion !== null) {\n\t\t\t\t\t\t\tthis.selectLink(post);\n\t\t\t\t\t\t\t// Announce a link has been selected when tabbing away from the input field.\n\t\t\t\t\t\t\tthis.props.speak(__('Link selected'));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase ENTER:\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.state.selectedSuggestion !== null) {\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\tthis.selectLink(post);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n   * Set state when an affiliate link is selected.\n   * \n   * @since 3.6\n   * \n   * @param {*} post \n   */\n\n\t}, {\n\t\tkey: 'selectLink',\n\t\tvalue: function selectLink(post) {\n\t\t\tthis.props.onChange(post.link, post);\n\t\t\tthis.setState({\n\t\t\t\tselectedSuggestion: null,\n\t\t\t\tshowSuggestions: false\n\t\t\t});\n\t\t}\n\n\t\t/**\n   * Callback handler for when affiliate link is selected.\n   * \n   * @param {*} post \n   */\n\n\t}, {\n\t\tkey: 'handleOnClick',\n\t\tvalue: function handleOnClick(post) {\n\t\t\tthis.selectLink(post);\n\t\t\t// Move focus to the input field when a link suggestion is clicked.\n\t\t\tthis.inputRef.current.focus();\n\t\t}\n\n\t\t/**\n   * Component render method.\n   * \n   * @since 3.6\n   */\n\n\t}, {\n\t\tkey: 'render',\n\t\tvalue: function render() {\n\t\t\tvar _this5 = this;\n\n\t\t\tvar _props = this.props,\n\t\t\t    _props$value = _props.value,\n\t\t\t    value = _props$value === undefined ? '' : _props$value,\n\t\t\t    _props$autoFocus = _props.autoFocus,\n\t\t\t    autoFocus = _props$autoFocus === undefined ? true : _props$autoFocus,\n\t\t\t    instanceId = _props.instanceId,\n\t\t\t    invalidLink = _props.invalidLink;\n\t\t\tvar _state3 = this.state,\n\t\t\t    showSuggestions = _state3.showSuggestions,\n\t\t\t    posts = _state3.posts,\n\t\t\t    selectedSuggestion = _state3.selectedSuggestion,\n\t\t\t    loading = _state3.loading;\n\t\t\t/* eslint-disable jsx-a11y/no-autofocus */\n\n\t\t\treturn wp.element.createElement(\n\t\t\t\t'div',\n\t\t\t\t{ className: 'editor-url-input' },\n\t\t\t\twp.element.createElement('input', {\n\t\t\t\t\tautoFocus: autoFocus,\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\t'aria-label': __('URL'),\n\t\t\t\t\trequired: true,\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tonChange: this.onChange,\n\t\t\t\t\tonInput: stopEventPropagation,\n\t\t\t\t\tplaceholder: __('Paste URL or type to search'),\n\t\t\t\t\tonKeyDown: this.onKeyDown,\n\t\t\t\t\trole: 'combobox',\n\t\t\t\t\t'aria-expanded': showSuggestions,\n\t\t\t\t\t'aria-autocomplete': 'list',\n\t\t\t\t\t'aria-owns': 'editor-url-input-suggestions-' + instanceId,\n\t\t\t\t\t'aria-activedescendant': selectedSuggestion !== null ? 'editor-url-input-suggestion-' + instanceId + '-' + selectedSuggestion : undefined,\n\t\t\t\t\tref: this.inputRef\n\t\t\t\t}),\n\t\t\t\tloading && wp.element.createElement(Spinner, null),\n\t\t\t\tshowSuggestions && !!posts.length && !invalidLink && wp.element.createElement(\n\t\t\t\t\tPopover,\n\t\t\t\t\t{ position: 'bottom', noArrow: true, focusOnMount: false },\n\t\t\t\t\twp.element.createElement(\n\t\t\t\t\t\t'div',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tclassName: 'editor-url-input__suggestions',\n\t\t\t\t\t\t\tid: 'editor-url-input-suggestions-' + instanceId,\n\t\t\t\t\t\t\tref: this.autocompleteRef,\n\t\t\t\t\t\t\trole: 'listbox'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tposts.map(function (post, index) {\n\t\t\t\t\t\t\treturn wp.element.createElement(\n\t\t\t\t\t\t\t\t'button',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tkey: post.id,\n\t\t\t\t\t\t\t\t\trole: 'option',\n\t\t\t\t\t\t\t\t\ttabIndex: '-1',\n\t\t\t\t\t\t\t\t\tid: 'editor-url-input-suggestion-' + instanceId + '-' + index,\n\t\t\t\t\t\t\t\t\tref: _this5.bindSuggestionNode(index),\n\t\t\t\t\t\t\t\t\tclassName: __WEBPACK_IMPORTED_MODULE_0_classnames___default()('editor-url-input__suggestion', {\n\t\t\t\t\t\t\t\t\t\t'is-selected': index === selectedSuggestion\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tonClick: function onClick() {\n\t\t\t\t\t\t\t\t\t\treturn _this5.handleOnClick(post);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t'aria-selected': index === selectedSuggestion\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tpost.title || __('(no title)')\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t\t/* eslint-enable jsx-a11y/no-autofocus */\n\t\t}\n\t}]);\n\n\treturn ThirstyURLInput;\n}(Component);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (withSpokenMessages(withInstanceId(ThirstyURLInput)));\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = __webpack_require__(16);\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar util = __webpack_require__(17);\n\nfunction scrollIntoView(elem, container, config) {\n  config = config || {};\n  // document 归一化到 window\n  if (container.nodeType === 9) {\n    container = util.getWindow(container);\n  }\n\n  var allowHorizontalScroll = config.allowHorizontalScroll;\n  var onlyScrollIfNeeded = config.onlyScrollIfNeeded;\n  var alignWithTop = config.alignWithTop;\n  var alignWithLeft = config.alignWithLeft;\n  var offsetTop = config.offsetTop || 0;\n  var offsetLeft = config.offsetLeft || 0;\n  var offsetBottom = config.offsetBottom || 0;\n  var offsetRight = config.offsetRight || 0;\n\n  allowHorizontalScroll = allowHorizontalScroll === undefined ? true : allowHorizontalScroll;\n\n  var isWin = util.isWindow(container);\n  var elemOffset = util.offset(elem);\n  var eh = util.outerHeight(elem);\n  var ew = util.outerWidth(elem);\n  var containerOffset = undefined;\n  var ch = undefined;\n  var cw = undefined;\n  var containerScroll = undefined;\n  var diffTop = undefined;\n  var diffBottom = undefined;\n  var win = undefined;\n  var winScroll = undefined;\n  var ww = undefined;\n  var wh = undefined;\n\n  if (isWin) {\n    win = container;\n    wh = util.height(win);\n    ww = util.width(win);\n    winScroll = {\n      left: util.scrollLeft(win),\n      top: util.scrollTop(win)\n    };\n    // elem 相对 container 可视视窗的距离\n    diffTop = {\n      left: elemOffset.left - winScroll.left - offsetLeft,\n      top: elemOffset.top - winScroll.top - offsetTop\n    };\n    diffBottom = {\n      left: elemOffset.left + ew - (winScroll.left + ww) + offsetRight,\n      top: elemOffset.top + eh - (winScroll.top + wh) + offsetBottom\n    };\n    containerScroll = winScroll;\n  } else {\n    containerOffset = util.offset(container);\n    ch = container.clientHeight;\n    cw = container.clientWidth;\n    containerScroll = {\n      left: container.scrollLeft,\n      top: container.scrollTop\n    };\n    // elem 相对 container 可视视窗的距离\n    // 注意边框, offset 是边框到根节点\n    diffTop = {\n      left: elemOffset.left - (containerOffset.left + (parseFloat(util.css(container, 'borderLeftWidth')) || 0)) - offsetLeft,\n      top: elemOffset.top - (containerOffset.top + (parseFloat(util.css(container, 'borderTopWidth')) || 0)) - offsetTop\n    };\n    diffBottom = {\n      left: elemOffset.left + ew - (containerOffset.left + cw + (parseFloat(util.css(container, 'borderRightWidth')) || 0)) + offsetRight,\n      top: elemOffset.top + eh - (containerOffset.top + ch + (parseFloat(util.css(container, 'borderBottomWidth')) || 0)) + offsetBottom\n    };\n  }\n\n  if (diffTop.top < 0 || diffBottom.top > 0) {\n    // 强制向上\n    if (alignWithTop === true) {\n      util.scrollTop(container, containerScroll.top + diffTop.top);\n    } else if (alignWithTop === false) {\n      util.scrollTop(container, containerScroll.top + diffBottom.top);\n    } else {\n      // 自动调整\n      if (diffTop.top < 0) {\n        util.scrollTop(container, containerScroll.top + diffTop.top);\n      } else {\n        util.scrollTop(container, containerScroll.top + diffBottom.top);\n      }\n    }\n  } else {\n    if (!onlyScrollIfNeeded) {\n      alignWithTop = alignWithTop === undefined ? true : !!alignWithTop;\n      if (alignWithTop) {\n        util.scrollTop(container, containerScroll.top + diffTop.top);\n      } else {\n        util.scrollTop(container, containerScroll.top + diffBottom.top);\n      }\n    }\n  }\n\n  if (allowHorizontalScroll) {\n    if (diffTop.left < 0 || diffBottom.left > 0) {\n      // 强制向上\n      if (alignWithLeft === true) {\n        util.scrollLeft(container, containerScroll.left + diffTop.left);\n      } else if (alignWithLeft === false) {\n        util.scrollLeft(container, containerScroll.left + diffBottom.left);\n      } else {\n        // 自动调整\n        if (diffTop.left < 0) {\n          util.scrollLeft(container, containerScroll.left + diffTop.left);\n        } else {\n          util.scrollLeft(container, containerScroll.left + diffBottom.left);\n        }\n      }\n    } else {\n      if (!onlyScrollIfNeeded) {\n        alignWithLeft = alignWithLeft === undefined ? true : !!alignWithLeft;\n        if (alignWithLeft) {\n          util.scrollLeft(container, containerScroll.left + diffTop.left);\n        } else {\n          util.scrollLeft(container, containerScroll.left + diffBottom.left);\n        }\n      }\n    }\n  }\n}\n\nmodule.exports = scrollIntoView;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar RE_NUM = /[\\-+]?(?:\\d*\\.|)\\d+(?:[eE][\\-+]?\\d+|)/.source;\n\nfunction getClientPosition(elem) {\n  var box = undefined;\n  var x = undefined;\n  var y = undefined;\n  var doc = elem.ownerDocument;\n  var body = doc.body;\n  var docElem = doc && doc.documentElement;\n  // 根据 GBS 最新数据，A-Grade Browsers 都已支持 getBoundingClientRect 方法，不用再考虑传统的实现方式\n  box = elem.getBoundingClientRect();\n\n  // 注：jQuery 还考虑减去 docElem.clientLeft/clientTop\n  // 但测试发现，这样反而会导致当 html 和 body 有边距/边框样式时，获取的值不正确\n  // 此外，ie6 会忽略 html 的 margin 值，幸运地是没有谁会去设置 html 的 margin\n\n  x = box.left;\n  y = box.top;\n\n  // In IE, most of the time, 2 extra pixels are added to the top and left\n  // due to the implicit 2-pixel inset border.  In IE6/7 quirks mode and\n  // IE6 standards mode, this border can be overridden by setting the\n  // document element's border to zero -- thus, we cannot rely on the\n  // offset always being 2 pixels.\n\n  // In quirks mode, the offset can be determined by querying the body's\n  // clientLeft/clientTop, but in standards mode, it is found by querying\n  // the document element's clientLeft/clientTop.  Since we already called\n  // getClientBoundingRect we have already forced a reflow, so it is not\n  // too expensive just to query them all.\n\n  // ie 下应该减去窗口的边框吧，毕竟默认 absolute 都是相对窗口定位的\n  // 窗口边框标准是设 documentElement ,quirks 时设置 body\n  // 最好禁止在 body 和 html 上边框 ，但 ie < 9 html 默认有 2px ，减去\n  // 但是非 ie 不可能设置窗口边框，body html 也不是窗口 ,ie 可以通过 html,body 设置\n  // 标准 ie 下 docElem.clientTop 就是 border-top\n  // ie7 html 即窗口边框改变不了。永远为 2\n  // 但标准 firefox/chrome/ie9 下 docElem.clientTop 是窗口边框，即使设了 border-top 也为 0\n\n  x -= docElem.clientLeft || body.clientLeft || 0;\n  y -= docElem.clientTop || body.clientTop || 0;\n\n  return {\n    left: x,\n    top: y\n  };\n}\n\nfunction getScroll(w, top) {\n  var ret = w['page' + (top ? 'Y' : 'X') + 'Offset'];\n  var method = 'scroll' + (top ? 'Top' : 'Left');\n  if (typeof ret !== 'number') {\n    var d = w.document;\n    // ie6,7,8 standard mode\n    ret = d.documentElement[method];\n    if (typeof ret !== 'number') {\n      // quirks mode\n      ret = d.body[method];\n    }\n  }\n  return ret;\n}\n\nfunction getScrollLeft(w) {\n  return getScroll(w);\n}\n\nfunction getScrollTop(w) {\n  return getScroll(w, true);\n}\n\nfunction getOffset(el) {\n  var pos = getClientPosition(el);\n  var doc = el.ownerDocument;\n  var w = doc.defaultView || doc.parentWindow;\n  pos.left += getScrollLeft(w);\n  pos.top += getScrollTop(w);\n  return pos;\n}\nfunction _getComputedStyle(elem, name, computedStyle_) {\n  var val = '';\n  var d = elem.ownerDocument;\n  var computedStyle = computedStyle_ || d.defaultView.getComputedStyle(elem, null);\n\n  // https://github.com/kissyteam/kissy/issues/61\n  if (computedStyle) {\n    val = computedStyle.getPropertyValue(name) || computedStyle[name];\n  }\n\n  return val;\n}\n\nvar _RE_NUM_NO_PX = new RegExp('^(' + RE_NUM + ')(?!px)[a-z%]+$', 'i');\nvar RE_POS = /^(top|right|bottom|left)$/;\nvar CURRENT_STYLE = 'currentStyle';\nvar RUNTIME_STYLE = 'runtimeStyle';\nvar LEFT = 'left';\nvar PX = 'px';\n\nfunction _getComputedStyleIE(elem, name) {\n  // currentStyle maybe null\n  // http://msdn.microsoft.com/en-us/library/ms535231.aspx\n  var ret = elem[CURRENT_STYLE] && elem[CURRENT_STYLE][name];\n\n  // 当 width/height 设置为百分比时，通过 pixelLeft 方式转换的 width/height 值\n  // 一开始就处理了! CUSTOM_STYLE.height,CUSTOM_STYLE.width ,cssHook 解决@2011-08-19\n  // 在 ie 下不对，需要直接用 offset 方式\n  // borderWidth 等值也有问题，但考虑到 borderWidth 设为百分比的概率很小，这里就不考虑了\n\n  // From the awesome hack by Dean Edwards\n  // http://erik.eae.net/archives/2007/07/27/18.54.15/#comment-102291\n  // If we're not dealing with a regular pixel number\n  // but a number that has a weird ending, we need to convert it to pixels\n  // exclude left right for relativity\n  if (_RE_NUM_NO_PX.test(ret) && !RE_POS.test(name)) {\n    // Remember the original values\n    var style = elem.style;\n    var left = style[LEFT];\n    var rsLeft = elem[RUNTIME_STYLE][LEFT];\n\n    // prevent flashing of content\n    elem[RUNTIME_STYLE][LEFT] = elem[CURRENT_STYLE][LEFT];\n\n    // Put in the new values to get a computed value out\n    style[LEFT] = name === 'fontSize' ? '1em' : ret || 0;\n    ret = style.pixelLeft + PX;\n\n    // Revert the changed values\n    style[LEFT] = left;\n\n    elem[RUNTIME_STYLE][LEFT] = rsLeft;\n  }\n  return ret === '' ? 'auto' : ret;\n}\n\nvar getComputedStyleX = undefined;\nif (typeof window !== 'undefined') {\n  getComputedStyleX = window.getComputedStyle ? _getComputedStyle : _getComputedStyleIE;\n}\n\nfunction each(arr, fn) {\n  for (var i = 0; i < arr.length; i++) {\n    fn(arr[i]);\n  }\n}\n\nfunction isBorderBoxFn(elem) {\n  return getComputedStyleX(elem, 'boxSizing') === 'border-box';\n}\n\nvar BOX_MODELS = ['margin', 'border', 'padding'];\nvar CONTENT_INDEX = -1;\nvar PADDING_INDEX = 2;\nvar BORDER_INDEX = 1;\nvar MARGIN_INDEX = 0;\n\nfunction swap(elem, options, callback) {\n  var old = {};\n  var style = elem.style;\n  var name = undefined;\n\n  // Remember the old values, and insert the new ones\n  for (name in options) {\n    if (options.hasOwnProperty(name)) {\n      old[name] = style[name];\n      style[name] = options[name];\n    }\n  }\n\n  callback.call(elem);\n\n  // Revert the old values\n  for (name in options) {\n    if (options.hasOwnProperty(name)) {\n      style[name] = old[name];\n    }\n  }\n}\n\nfunction getPBMWidth(elem, props, which) {\n  var value = 0;\n  var prop = undefined;\n  var j = undefined;\n  var i = undefined;\n  for (j = 0; j < props.length; j++) {\n    prop = props[j];\n    if (prop) {\n      for (i = 0; i < which.length; i++) {\n        var cssProp = undefined;\n        if (prop === 'border') {\n          cssProp = prop + which[i] + 'Width';\n        } else {\n          cssProp = prop + which[i];\n        }\n        value += parseFloat(getComputedStyleX(elem, cssProp)) || 0;\n      }\n    }\n  }\n  return value;\n}\n\n/**\n * A crude way of determining if an object is a window\n * @member util\n */\nfunction isWindow(obj) {\n  // must use == for ie8\n  /* eslint eqeqeq:0 */\n  return obj != null && obj == obj.window;\n}\n\nvar domUtils = {};\n\neach(['Width', 'Height'], function (name) {\n  domUtils['doc' + name] = function (refWin) {\n    var d = refWin.document;\n    return Math.max(\n    // firefox chrome documentElement.scrollHeight< body.scrollHeight\n    // ie standard mode : documentElement.scrollHeight> body.scrollHeight\n    d.documentElement['scroll' + name],\n    // quirks : documentElement.scrollHeight 最大等于可视窗口多一点？\n    d.body['scroll' + name], domUtils['viewport' + name](d));\n  };\n\n  domUtils['viewport' + name] = function (win) {\n    // pc browser includes scrollbar in window.innerWidth\n    var prop = 'client' + name;\n    var doc = win.document;\n    var body = doc.body;\n    var documentElement = doc.documentElement;\n    var documentElementProp = documentElement[prop];\n    // 标准模式取 documentElement\n    // backcompat 取 body\n    return doc.compatMode === 'CSS1Compat' && documentElementProp || body && body[prop] || documentElementProp;\n  };\n});\n\n/*\n 得到元素的大小信息\n @param elem\n @param name\n @param {String} [extra]  'padding' : (css width) + padding\n 'border' : (css width) + padding + border\n 'margin' : (css width) + padding + border + margin\n */\nfunction getWH(elem, name, extra) {\n  if (isWindow(elem)) {\n    return name === 'width' ? domUtils.viewportWidth(elem) : domUtils.viewportHeight(elem);\n  } else if (elem.nodeType === 9) {\n    return name === 'width' ? domUtils.docWidth(elem) : domUtils.docHeight(elem);\n  }\n  var which = name === 'width' ? ['Left', 'Right'] : ['Top', 'Bottom'];\n  var borderBoxValue = name === 'width' ? elem.offsetWidth : elem.offsetHeight;\n  var computedStyle = getComputedStyleX(elem);\n  var isBorderBox = isBorderBoxFn(elem, computedStyle);\n  var cssBoxValue = 0;\n  if (borderBoxValue == null || borderBoxValue <= 0) {\n    borderBoxValue = undefined;\n    // Fall back to computed then un computed css if necessary\n    cssBoxValue = getComputedStyleX(elem, name);\n    if (cssBoxValue == null || Number(cssBoxValue) < 0) {\n      cssBoxValue = elem.style[name] || 0;\n    }\n    // Normalize '', auto, and prepare for extra\n    cssBoxValue = parseFloat(cssBoxValue) || 0;\n  }\n  if (extra === undefined) {\n    extra = isBorderBox ? BORDER_INDEX : CONTENT_INDEX;\n  }\n  var borderBoxValueOrIsBorderBox = borderBoxValue !== undefined || isBorderBox;\n  var val = borderBoxValue || cssBoxValue;\n  if (extra === CONTENT_INDEX) {\n    if (borderBoxValueOrIsBorderBox) {\n      return val - getPBMWidth(elem, ['border', 'padding'], which, computedStyle);\n    }\n    return cssBoxValue;\n  }\n  if (borderBoxValueOrIsBorderBox) {\n    var padding = extra === PADDING_INDEX ? -getPBMWidth(elem, ['border'], which, computedStyle) : getPBMWidth(elem, ['margin'], which, computedStyle);\n    return val + (extra === BORDER_INDEX ? 0 : padding);\n  }\n  return cssBoxValue + getPBMWidth(elem, BOX_MODELS.slice(extra), which, computedStyle);\n}\n\nvar cssShow = {\n  position: 'absolute',\n  visibility: 'hidden',\n  display: 'block'\n};\n\n// fix #119 : https://github.com/kissyteam/kissy/issues/119\nfunction getWHIgnoreDisplay(elem) {\n  var val = undefined;\n  var args = arguments;\n  // in case elem is window\n  // elem.offsetWidth === undefined\n  if (elem.offsetWidth !== 0) {\n    val = getWH.apply(undefined, args);\n  } else {\n    swap(elem, cssShow, function () {\n      val = getWH.apply(undefined, args);\n    });\n  }\n  return val;\n}\n\nfunction css(el, name, v) {\n  var value = v;\n  if ((typeof name === 'undefined' ? 'undefined' : _typeof(name)) === 'object') {\n    for (var i in name) {\n      if (name.hasOwnProperty(i)) {\n        css(el, i, name[i]);\n      }\n    }\n    return undefined;\n  }\n  if (typeof value !== 'undefined') {\n    if (typeof value === 'number') {\n      value += 'px';\n    }\n    el.style[name] = value;\n    return undefined;\n  }\n  return getComputedStyleX(el, name);\n}\n\neach(['width', 'height'], function (name) {\n  var first = name.charAt(0).toUpperCase() + name.slice(1);\n  domUtils['outer' + first] = function (el, includeMargin) {\n    return el && getWHIgnoreDisplay(el, name, includeMargin ? MARGIN_INDEX : BORDER_INDEX);\n  };\n  var which = name === 'width' ? ['Left', 'Right'] : ['Top', 'Bottom'];\n\n  domUtils[name] = function (elem, val) {\n    if (val !== undefined) {\n      if (elem) {\n        var computedStyle = getComputedStyleX(elem);\n        var isBorderBox = isBorderBoxFn(elem);\n        if (isBorderBox) {\n          val += getPBMWidth(elem, ['padding', 'border'], which, computedStyle);\n        }\n        return css(elem, name, val);\n      }\n      return undefined;\n    }\n    return elem && getWHIgnoreDisplay(elem, name, CONTENT_INDEX);\n  };\n});\n\n// 设置 elem 相对 elem.ownerDocument 的坐标\nfunction setOffset(elem, offset) {\n  // set position first, in-case top/left are set even on static elem\n  if (css(elem, 'position') === 'static') {\n    elem.style.position = 'relative';\n  }\n\n  var old = getOffset(elem);\n  var ret = {};\n  var current = undefined;\n  var key = undefined;\n\n  for (key in offset) {\n    if (offset.hasOwnProperty(key)) {\n      current = parseFloat(css(elem, key)) || 0;\n      ret[key] = current + offset[key] - old[key];\n    }\n  }\n  css(elem, ret);\n}\n\nmodule.exports = _extends({\n  getWindow: function getWindow(node) {\n    var doc = node.ownerDocument || node;\n    return doc.defaultView || doc.parentWindow;\n  },\n  offset: function offset(el, value) {\n    if (typeof value !== 'undefined') {\n      setOffset(el, value);\n    } else {\n      return getOffset(el);\n    }\n  },\n\n  isWindow: isWindow,\n  each: each,\n  css: css,\n  clone: function clone(obj) {\n    var ret = {};\n    for (var i in obj) {\n      if (obj.hasOwnProperty(i)) {\n        ret[i] = obj[i];\n      }\n    }\n    var overflow = obj.overflow;\n    if (overflow) {\n      for (var i in obj) {\n        if (obj.hasOwnProperty(i)) {\n          ret.overflow[i] = obj.overflow[i];\n        }\n      }\n    }\n    return ret;\n  },\n  scrollLeft: function scrollLeft(w, v) {\n    if (isWindow(w)) {\n      if (v === undefined) {\n        return getScrollLeft(w);\n      }\n      window.scrollTo(v, getScrollTop(w));\n    } else {\n      if (v === undefined) {\n        return w.scrollLeft;\n      }\n      w.scrollLeft = v;\n    }\n  },\n  scrollTop: function scrollTop(w, v) {\n    if (isWindow(w)) {\n      if (v === undefined) {\n        return getScrollTop(w);\n      }\n      window.scrollTo(getScrollLeft(w), v);\n    } else {\n      if (v === undefined) {\n        return w.scrollTop;\n      }\n      w.scrollTop = v;\n    }\n  },\n\n  viewportWidth: 0,\n  viewportHeight: 0\n}, domUtils);\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// gutenberg-support.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b4e546eb9d17ec651f70","/*!\n  Copyright (c) 2017 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg) && arg.length) {\n\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\tif (inner) {\n\t\t\t\t\tclasses.push(inner);\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/classnames/index.js\n// module id = 0\n// module chunks = 0","import registerBlocks from \"./blocks\";\nimport registerFormats from \"./formats\";\n\nimport \"./assets/styles/index.scss\";\n\nregisterBlocks();\nregisterFormats();\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import * as taimage from \"./ta-image\";\n\nconst { registerBlockType } = wp.blocks;\n\n/**\n * Register gutenberg blocks.\n * \n * @since 3.6\n */\nexport default function registerBlocks() {\n\n    [\n        taimage\n    ].forEach( ( block ) => {\n        if ( ! block ) return;\n\n        const { name , settings } = block;\n        registerBlockType( name , settings );\n    } );\n}\n\n\n// WEBPACK FOOTER //\n// ./src/blocks/index.js","import classnames from \"classnames\";\n\nconst { Fragment } = wp.element;\nconst { __ } = wp.i18n;\nconst { createBlock, getBlockAttributes, getPhrasingContentSchema } = wp.blocks;\nconst { RichText } = wp.editor;\nconst { Path , SVG } = wp.components;\n\nimport edit from \"./edit\";\n\nexport const name = 'ta/image';\n\nconst blockAttributes = {\n\turl: {\n\t\ttype: 'string',\n\t\tsource: 'attribute',\n\t\tselector: 'img',\n\t\tattribute: 'src',\n\t},\n\talt: {\n\t\ttype: 'string',\n\t\tsource: 'attribute',\n\t\tselector: 'img',\n\t\tattribute: 'alt',\n\t\tdefault: '',\n\t},\n\tcaption: {\n\t\ttype: 'string',\n\t\tsource: 'html',\n\t\tselector: 'figcaption',\n\t},\n\tid: {\n\t\ttype: 'number',\n\t},\n\talign: {\n\t\ttype: 'string',\n\t},\n\twidth: {\n\t\ttype: 'number',\n\t},\n\theight: {\n\t\ttype: 'number',\n\t},\n\tlinkid: {\n\t\ttype: 'number',\n\t},\n\thref: {\n\t\ttype: 'string',\n\t\tsource: 'attribute',\n\t\tselector: 'ta',\n\t\tattribute: 'href'\n\t},\n\taffiliateLink: {\n\t\ttype: 'object'\n\t}\n};\n\nconst imageSchema = {\n\timg: {\n\t\tattributes: [ 'src', 'alt' ],\n\t\tclasses: [ 'alignleft', 'aligncenter', 'alignright', 'alignnone', /^wp-image-\\d+$/ ],\n\t},\n};\n\nconst schema = {\n\tfigure: {\n\t\trequire: [ 'ta' , 'img' ],\n\t\tchildren: {\n\t\t\tta: {\n\t\t\t\tattributes: [ 'href', 'linkid' ],\n\t\t\t\tchildren: imageSchema,\n\t\t\t},\n\t\t\tfigcaption: {\n\t\t\t\tchildren: getPhrasingContentSchema(),\n\t\t\t},\n\t\t},\n\t},\n};\n\nfunction getFirstAnchorAttributeFormHTML( html, attributeName ) {\n\tconst { body } = document.implementation.createHTMLDocument( '' );\n\n\tbody.innerHTML = html;\n\n\tconst { firstElementChild } = body;\n\n\tif (\n\t\tfirstElementChild &&\n\t\tfirstElementChild.nodeName === 'A'\n\t) {\n\t\treturn firstElementChild.getAttribute( attributeName ) || undefined;\n\t}\n}\n\nexport const settings = {\n\ttitle: __( 'ThirstyAffiliates Image' ),\n\n\tdescription: __( 'Insert an image with an affiliate link to make a visual statement.' ),\n\n\ticon: <SVG viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><Path d=\"M0,0h24v24H0V0z\" fill=\"none\" /><Path d=\"m19 5v14h-14v-14h14m0-2h-14c-1.1 0-2 0.9-2 2v14c0 1.1 0.9 2 2 2h14c1.1 0 2-0.9 2-2v-14c0-1.1-0.9-2-2-2z\" /><Path d=\"m14.14 11.86l-3 3.87-2.14-2.59-3 3.86h12l-3.86-5.14z\" /></SVG>,\n\n\tcategory: 'common',\n\n\tkeywords: [\n\t\t'img', // \"img\" is not translated as it is intended to reflect the HTML <img> tag.\n\t\t__( 'photo' ),\n\t\t__( 'affiliate' )\n\t],\n\n\tattributes: blockAttributes,\n\n\ttransforms: {\n\t\tfrom: [\n\t\t\t{\n\t\t\t\ttype: 'raw',\n\t\t\t\tisMatch: ( node ) => node.nodeName === 'FIGURE' && !! node.querySelector( 'img' ),\n\t\t\t\tschema,\n\t\t\t\ttransform: ( node ) => {\n\n\t\t\t\t\t// Search both figure and image classes. Alignment could be\n\t\t\t\t\t// set on either. ID is set on the image.\n\t\t\t\t\tconst className = node.className + ' ' + node.querySelector( 'img' ).className;\n\t\t\t\t\tconst alignMatches = /(?:^|\\s)align(left|center|right)(?:$|\\s)/.exec( className );\n\t\t\t\t\tconst align = alignMatches ? alignMatches[ 1 ] : undefined;\n\t\t\t\t\tconst idMatches = /(?:^|\\s)wp-image-(\\d+)(?:$|\\s)/.exec( className );\n\t\t\t\t\tconst id = idMatches ? Number( idMatches[ 1 ] ) : undefined;\n\t\t\t\t\tconst anchorElement = node.querySelector( 'a' );\n\t\t\t\t\tconst linkDestination = anchorElement && anchorElement.href ? 'custom' : undefined;\n\t\t\t\t\tconst href = anchorElement && anchorElement.href ? anchorElement.href : undefined;\n\t\t\t\t\tconst rel = anchorElement && anchorElement.rel ? anchorElement.rel : undefined;\n\t\t\t\t\tconst linkClass = anchorElement && anchorElement.className ? anchorElement.className : undefined;\n\t\t\t\t\tconst attributes = getBlockAttributes( 'ta/image', node.outerHTML, { align, id, linkDestination, linkid , href, rel, linkClass } );\n\t\t\t\t\treturn createBlock( 'ta/image', attributes );\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'files',\n\t\t\t\tisMatch( files ) {\n\t\t\t\t\treturn files.length === 1 && files[ 0 ].type.indexOf( 'image/' ) === 0;\n\t\t\t\t},\n\t\t\t\ttransform( files ) {\n\t\t\t\t\tconst file = files[ 0 ];\n\t\t\t\t\t// We don't need to upload the media directly here\n\t\t\t\t\t// It's already done as part of the `componentDidMount`\n\t\t\t\t\t// int the image block\n\t\t\t\t\tconst block = createBlock( 'ta/image', {\n\t\t\t\t\t\turl: createBlobURL( file ),\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn block;\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'shortcode',\n\t\t\t\ttag: 'caption',\n\t\t\t\tattributes: {\n\t\t\t\t\turl: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tsource: 'attribute',\n\t\t\t\t\t\tattribute: 'src',\n\t\t\t\t\t\tselector: 'img',\n\t\t\t\t\t},\n\t\t\t\t\talt: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tsource: 'attribute',\n\t\t\t\t\t\tattribute: 'alt',\n\t\t\t\t\t\tselector: 'img',\n\t\t\t\t\t},\n\t\t\t\t\tcaption: {\n\t\t\t\t\t\tshortcode: ( attributes, { shortcode } ) => {\n\t\t\t\t\t\t\tconst { body } = document.implementation.createHTMLDocument( '' );\n\n\t\t\t\t\t\t\tbody.innerHTML = shortcode.content;\n\t\t\t\t\t\t\tbody.removeChild( body.firstElementChild );\n\n\t\t\t\t\t\t\treturn body.innerHTML.trim();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tid: {\n\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\tshortcode: ( { named: { id } } ) => {\n\t\t\t\t\t\t\tif ( ! id ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn parseInt( id.replace( 'attachment_', '' ), 10 );\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\talign: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tshortcode: ( { named: { align = 'alignnone' } } ) => {\n\t\t\t\t\t\t\treturn align.replace( 'align', '' );\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tlinkid: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tsource: 'attribute',\n\t\t\t\t\t\tselector: 'wp-block-ta-image > ta',\n\t\t\t\t\t\tattribute: 'linkid'\n\t\t\t\t\t},\n\t\t\t\t\thref: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tsource: 'attribute',\n\t\t\t\t\t\tselector: 'ta',\n\t\t\t\t\t\tattribute: 'href'\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t},\n\n\tgetEditWrapperProps( attributes ) {\n\t\tconst { align, width } = attributes;\n\t\tif ( 'left' === align || 'center' === align || 'right' === align || 'wide' === align || 'full' === align ) {\n\t\t\treturn { 'data-align': align, 'data-resized': !! width };\n\t\t}\n\t},\n\n\tedit,\n\n\tsave( { attributes } ) {\n\t\tconst {\n\t\t\turl,\n\t\t\talt,\n\t\t\tcaption,\n\t\t\talign,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tid,\n\t\t\tlinkid,\n\t\t\thref\n\t\t} = attributes;\n\n\t\tconst classes = classnames( {\n\t\t\t[ `align${ align }` ]: align,\n\t\t\t'is-resized': width || height,\n\t\t} );\n\n\t\tconst image = (\n\t\t\t<img\n\t\t\t\tsrc={ url }\n\t\t\t\talt={ alt }\n\t\t\t\tclassName={ id ? `wp-image-${ id }` : null }\n\t\t\t\twidth={ width }\n\t\t\t\theight={ height }\n\t\t\t/>\n\t\t);\n\n\t\tconst figure = (\n\t\t\t<Fragment>\n\t\t\t\t<ta linkid={ linkid } href={ href }>\n\t\t\t\t{ image }\n\t\t\t\t</ta>\n\t\t\t\t<RichText.Content tagName=\"figcaption\" value={ caption } />\n\t\t\t</Fragment>\n\t\t);\n\n\t\tif ( 'left' === align || 'right' === align || 'center' === align ) {\n\t\t\treturn (\n\t\t\t\t<div className='wp-block-image'>\n\t\t\t\t\t<figure className={ classes }>\n\t\t\t\t\t\t{ figure }\n\t\t\t\t\t</figure>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<figure className={ `wp-block-image ${classes}` }>\n\t\t\t\t{ figure }\n\t\t\t</figure>\n\t\t);\n\t}\n};\n\n\n// WEBPACK FOOTER //\n// ./src/blocks/ta-image/index.js","import classnames from \"classnames\";\n\nconst { get , isEmpty , map , last , pick , compact } = lodash;\nconst { getPath } = wp.url;\nconst { __, sprintf } = wp.i18n;\nconst { Component, Fragment , createRef } = wp.element;\nconst { getBlobByURL, revokeBlobURL, isBlobURL } = wp.blob;\nconst { Placeholder , Button , ButtonGroup , IconButton , PanelBody , ResizableBox , SelectControl , Spinner , TextControl , TextareaControl , Toolbar , withNotices , ToggleControl , Popover } = wp.components;\nconst { withSelect  } = wp.data;\nconst { RichText , BlockControls , InspectorControls , MediaUpload , MediaUploadCheck , MediaPlaceholder , BlockAlignmentToolbar , mediaUpload } = wp.editor;\nconst { withViewportMatch } = wp.viewport;\nconst { compose } = wp.compose;\n\nimport { createUpgradedEmbedBlock } from \"./util\";\nimport ImageSize from \"./image-size\";\nimport ThirstyURLInput from './search-input';\n\n/**\n * Module constants\n */\nconst MIN_SIZE = 20;\nconst LINK_DESTINATION_NONE = 'none';\nconst LINK_DESTINATION_MEDIA = 'media';\nconst LINK_DESTINATION_ATTACHMENT = 'attachment';\nconst LINK_DESTINATION_CUSTOM = 'custom';\nconst NEW_TAB_REL = 'noreferrer noopener';\nconst ALLOWED_MEDIA_TYPES = [ 'image' ];\n\nexport const pickRelevantMediaFiles = ( image ) => {\n\tconst imageProps = pick( image, [ 'alt', 'id', 'link', 'caption' ] );\n\timageProps.url = get( image, [ 'sizes', 'large', 'url' ] ) || get( image, [ 'media_details', 'sizes', 'large', 'source_url' ] ) || image.url;\n\treturn imageProps;\n};\n\n/**\n * Is the URL a temporary blob URL? A blob URL is one that is used temporarily\n * while the image is being uploaded and will not have an id yet allocated.\n *\n * @param {number=} id The id of the image.\n * @param {string=} url The url of the image.\n *\n * @return {boolean} Is the URL a Blob URL\n */\nconst isTemporaryImage = ( id, url ) => ! id && isBlobURL( url );\n\n/**\n * Is the url for the image hosted externally. An externally hosted image has no id\n * and is not a blob url.\n *\n * @param {number=} id  The id of the image.\n * @param {string=} url The url of the image.\n *\n * @return {boolean} Is the url an externally hosted url?\n */\nconst isExternalImage = ( id, url ) => url && ! id && ! isBlobURL( url );\n\nclass ImageEdit extends Component {\n\tconstructor( { attributes } ) {\n\t\tsuper( ...arguments );\n\t\tthis.updateAlt = this.updateAlt.bind( this );\n\t\tthis.updateAlignment = this.updateAlignment.bind( this );\n\t\tthis.onFocusCaption = this.onFocusCaption.bind( this );\n\t\tthis.onImageClick = this.onImageClick.bind( this );\n\t\tthis.onSelectImage = this.onSelectImage.bind( this );\n\t\tthis.updateImageURL = this.updateImageURL.bind( this );\n\t\tthis.updateWidth = this.updateWidth.bind( this );\n\t\tthis.updateHeight = this.updateHeight.bind( this );\n\t\tthis.updateDimensions = this.updateDimensions.bind( this );\n\t\tthis.getFilename = this.getFilename.bind( this );\n\t\tthis.toggleIsEditing = this.toggleIsEditing.bind( this );\n\t\tthis.onImageError = this.onImageError.bind( this );\n\t\tthis.onChangeInputValue = this.onChangeInputValue.bind( this );\n\t\tthis.autocompleteRef = createRef();\n\t\tthis.resetInvalidLink = this.resetInvalidLink.bind( this );\n\t\tthis.updateImageSelection = this.updateImageSelection.bind( this );\n\t\tthis.onSelectAffiliateImage = this.onSelectAffiliateImage.bind( this );\n\t\tthis.editAFfiliateImage = this.editAFfiliateImage.bind( this );\n\n\t\tthis.state = {\n\t\t\tcaptionFocused: false,\n\t\t\tisEditing: ! attributes.url,\n\t\t\tinputValue : '',\n\t\t\tlinkid : 0,\n\t\t\tpost : null,\n\t\t\tshowSuggestions : false,\n\t\t\timageSelection : [],\n\t\t\taffiliateLink : null\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { attributes, setAttributes, noticeOperations } = this.props;\n\t\tconst { id, url = '' } = attributes;\n\n\t\tif ( isTemporaryImage( id, url ) ) {\n\t\t\tconst file = getBlobByURL( url );\n\n\t\t\tif ( file ) {\n\t\t\t\tmediaUpload( {\n\t\t\t\t\tfilesList: [ file ],\n\t\t\t\t\tonFileChange: ( [ image ] ) => {\n\t\t\t\t\t\tsetAttributes( pickRelevantMediaFiles( image ) );\n\t\t\t\t\t},\n\t\t\t\t\tallowedTypes: ALLOWED_MEDIA_TYPES,\n\t\t\t\t\tonError: ( message ) => {\n\t\t\t\t\t\tnoticeOperations.createErrorNotice( message );\n\t\t\t\t\t\tthis.setState( { isEditing: true } );\n\t\t\t\t\t},\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tconst { id: prevID, url: prevURL = '' } = prevProps.attributes;\n\t\tconst { id, url = '' } = this.props.attributes;\n\n\t\tif ( isTemporaryImage( prevID, prevURL ) && ! isTemporaryImage( id, url ) ) {\n\t\t\trevokeBlobURL( url );\n\t\t}\n\n\t\tif ( ! this.props.isSelected && prevProps.isSelected && this.state.captionFocused ) {\n\t\t\tthis.setState( {\n\t\t\t\tcaptionFocused: false,\n\t\t\t} );\n\t\t}\n\t}\n\n\tonSelectImage( media ) {\n\n\t\tif ( ! media || ! media.url ) {\n\t\t\tthis.props.setAttributes( {\n\t\t\t\turl: undefined,\n\t\t\t\talt: undefined,\n\t\t\t\tid: undefined,\n\t\t\t\tcaption: undefined\n\t\t\t} );\n\t\t\treturn;\n\t\t}\n\n\t\tconst { affiliateLink } = this.state;\n\n\t\tthis.setState( {\n\t\t\tisEditing: false,\n\t\t} );\n\n\t\tthis.props.setAttributes( {\n\t\t\t...pickRelevantMediaFiles( media ),\n\t\t\tlinkid: affiliateLink.id,\n\t\t\thref: affiliateLink.link,\n\t\t\taffiliateLink : affiliateLink,\n\t\t\twidth: undefined,\n\t\t\theight: undefined,\n\t\t} );\n\t}\n\n\tonImageError( url ) {\n\t\t// Check if there's an embed block that handles this URL.\n\t\tconst embedBlock = createUpgradedEmbedBlock(\n\t\t\t{ attributes: { url } }\n\t\t);\n\t\tif ( undefined !== embedBlock ) {\n\t\t\tthis.props.onReplace( embedBlock );\n\t\t}\n\t}\n\n\tonFocusCaption() {\n\t\tif ( ! this.state.captionFocused ) {\n\t\t\tthis.setState( {\n\t\t\t\tcaptionFocused: true,\n\t\t\t} );\n\t\t}\n\t}\n\n\tonImageClick() {\n\t\tif ( this.state.captionFocused ) {\n\t\t\tthis.setState( {\n\t\t\t\tcaptionFocused: false,\n\t\t\t} );\n\t\t}\n\t}\n\n\tupdateAlt( newAlt ) {\n\t\tthis.props.setAttributes( { alt: newAlt } );\n\t}\n\n\tupdateAlignment( nextAlign ) {\n\t\tconst extraUpdatedAttributes = [ 'wide', 'full' ].indexOf( nextAlign ) !== -1 ?\n\t\t\t{ width: undefined, height: undefined } :\n\t\t\t{};\n\t\tthis.props.setAttributes( { ...extraUpdatedAttributes, align: nextAlign } );\n\t}\n\n\tupdateImageURL( url ) {\n\t\tthis.props.setAttributes( { url, width: undefined, height: undefined } );\n\t}\n\n\tupdateWidth( width ) {\n\t\tthis.props.setAttributes( { width: parseInt( width, 10 ) } );\n\t}\n\n\tupdateHeight( height ) {\n\t\tthis.props.setAttributes( { height: parseInt( height, 10 ) } );\n\t}\n\n\tupdateDimensions( width = undefined, height = undefined ) {\n\t\treturn () => {\n\t\t\tthis.props.setAttributes( { width, height } );\n\t\t};\n\t}\n\n\tgetFilename( url ) {\n\t\tconst path = getPath( url );\n\t\tif ( path ) {\n\t\t\treturn last( path.split( '/' ) );\n\t\t}\n\t}\n\n\tgetLinkDestinationOptions() {\n\t\treturn [\n\t\t\t{ value: LINK_DESTINATION_NONE, label: __( 'None' ) },\n\t\t\t{ value: LINK_DESTINATION_MEDIA, label: __( 'Media File' ) },\n\t\t\t{ value: LINK_DESTINATION_ATTACHMENT, label: __( 'Attachment Page' ) },\n\t\t\t{ value: LINK_DESTINATION_CUSTOM, label: __( 'Custom URL' ) },\n\t\t];\n\t}\n\n\ttoggleIsEditing() {\n\t\tthis.setState( {\n\t\t\tisEditing: ! this.state.isEditing,\n\t\t} );\n\t}\n\n\tgetImageSizeOptions() {\n\t\tconst { imageSizes, image } = this.props;\n\t\treturn compact( map( imageSizes, ( { name, slug } ) => {\n\t\t\tconst sizeUrl = get( image, [ 'media_details', 'sizes', slug, 'source_url' ] );\n\t\t\tif ( ! sizeUrl ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tvalue: sizeUrl,\n\t\t\t\tlabel: name,\n\t\t\t};\n\t\t} ) );\n\t}\n\n\tonChangeInputValue( inputValue , post = null ) {\n\t\tconst linkid = post ? post.id : 0;\n\t\tthis.setState( { inputValue , linkid , post } );\n\t}\n\n\tresetInvalidLink() {\n\t\tthis.setState( { invalidLink : false } );\n\t}\n\n\tupdateImageSelection( imageSelection , affiliateLink ) {\n\t\tthis.setState({\n\t\t\timageSelection,\n\t\t\taffiliateLink\n\t\t});\n\t}\n\n\tonSelectAffiliateImage( image ) {\n\n\t\tconst request = wp.apiFetch( {\n\t\t\tpath: wp.url.addQueryArgs( 'wp/v2/media/' + image.id , {\n\t\t\t\tcontext: 'edit',\n\t\t\t\t_locale: 'user'\n\t\t\t} ),\n\t\t} );\n\n\t\trequest.then( (media) => {\n\t\t\tmedia.url = media.source_url;\n\t\t\tthis.onSelectImage( media );\n\t\t} );\n\t}\n\n\teditAFfiliateImage() {\n\n\t\tconst { attributes } = this.props;\n\t\tconst { affiliateLink } = attributes;\n\n\t\tthis.setState({\n\t\t\tisEditing : true,\n\t\t\timageSelection : affiliateLink.images,\n\t\t\taffiliateLink\n\t\t});\n\t}\n\n\trender() {\n\t\tconst { \n\t\t\tisEditing,\n\t\t\timageSelection,\n\t\t\taffiliateLink,\n\t\t} = this.state;\n\t\tconst {\n\t\t\tattributes,\n\t\t\tsetAttributes,\n\t\t\tisLargeViewport,\n\t\t\tisSelected,\n\t\t\tclassName,\n\t\t\tmaxWidth,\n\t\t\ttoggleSelection,\n\t\t\tisRTL,\n\t\t} = this.props;\n\t\tconst {\n\t\t\turl,\n\t\t\talt,\n\t\t\tcaption,\n\t\t\talign,\n\t\t\tlinkDestination,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tlinkid,\n\t\t\thref\n\t\t} = attributes;\n\t\tconst toolbarEditButton = (\n\t\t\t<Toolbar>\n\t\t\t\t<IconButton\n\t\t\t\t\tclassName=\"ta-edit-image-button components-icon-button components-toolbar__control\"\n\t\t\t\t\tlabel={ __( 'Edit ThirstyAffiliates Image' ) }\n\t\t\t\t\ticon=\"edit\"\n\t\t\t\t\tonClick={ this.editAFfiliateImage }\n\t\t\t\t/>\n\t\t\t</Toolbar>\n\t\t);\n\n\t\tconst controls = (\n\t\t\t<BlockControls>\n\t\t\t\t<BlockAlignmentToolbar\n\t\t\t\t\tvalue={ align }\n\t\t\t\t\tonChange={ this.updateAlignment }\n\t\t\t\t/>\n\t\t\t\t{ toolbarEditButton }\n\t\t\t</BlockControls>\n\t\t);\n\n\t\tif ( isEditing ) {\n\t\t\treturn (\n\t\t\t\t<Fragment>\n\t\t\t\t\t{ controls }\n\t\t\t\t\t<Placeholder\n\t\t\t\t\t\ticon={ \"format-image\" }\n\t\t\t\t\t\tlabel={ __( \"ThirstyAffiliates Image\" ) }\n\t\t\t\t\t\tinstructions={ __( \"Search for an affiliate link and select image to insert.\" ) } \n\t\t\t\t\t>\t\n\n\t\t\t\t\t\t<ThirstyURLInput\n\t\t\t\t\t\t\tupdateImageSelection={ this.updateImageSelection }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t\n\t\t\t\t\t\t{ !! imageSelection.length &&\n\t\t\t\t\t\t\t<div className=\"ta-image-sel-wrap\">\n\t\t\t\t\t\t\t\t<h3>{ `${affiliateLink.title} ${ __( 'attached images:' ) }` }</h3>\n\t\t\t\t\t\t\t\t<div className=\"ta-image-selection\">\n\t\t\t\t\t\t\t\t\t{ imageSelection.map( ( image , index ) => (\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tonClick={ () => this.onSelectAffiliateImage( image ) }\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<img src={ image.src } />\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t) ) }\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t</Placeholder>\n\t\t\t\t</Fragment>\n\t\t\t);\n\t\t}\n\n\t\tconst classes = classnames( className, {\n\t\t\t'wp-block-image' : true,\n\t\t\t'is-transient': isBlobURL( url ),\n\t\t\t'is-resized': !! width || !! height,\n\t\t\t'is-focused': isSelected,\n\t\t} );\n\n\t\tconst isResizable = [ 'wide', 'full' ].indexOf( align ) === -1 && isLargeViewport;\n\t\tconst imageSizeOptions = this.getImageSizeOptions();\n\n\t\tconst getInspectorControls = ( imageWidth, imageHeight ) => (\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Image Settings' ) }>\n\t\t\t\t\t<TextareaControl\n\t\t\t\t\t\tlabel={ __( 'Alt Text (Alternative Text)' ) }\n\t\t\t\t\t\tvalue={ alt }\n\t\t\t\t\t\tonChange={ this.updateAlt }\n\t\t\t\t\t\thelp={ __( 'Alternative text describes your image to people who can’t see it. Add a short description with its key details.' ) }\n\t\t\t\t\t/>\n\t\t\t\t\t{ ! isEmpty( imageSizeOptions ) && (\n\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\tlabel={ __( 'Image Size' ) }\n\t\t\t\t\t\t\tvalue={ url }\n\t\t\t\t\t\t\toptions={ imageSizeOptions }\n\t\t\t\t\t\t\tonChange={ this.updateImageURL }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ isResizable && (\n\t\t\t\t\t\t<div className=\"block-library-image__dimensions\">\n\t\t\t\t\t\t\t<p className=\"block-library-image__dimensions__row\">\n\t\t\t\t\t\t\t\t{ __( 'Image Dimensions' ) }\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<div className=\"block-library-image__dimensions__row\">\n\t\t\t\t\t\t\t\t<TextControl\n\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\tclassName=\"block-library-image__dimensions__width\"\n\t\t\t\t\t\t\t\t\tlabel={ __( 'Width' ) }\n\t\t\t\t\t\t\t\t\tvalue={ width !== undefined ? width : '' }\n\t\t\t\t\t\t\t\t\tplaceholder={ imageWidth }\n\t\t\t\t\t\t\t\t\tmin={ 1 }\n\t\t\t\t\t\t\t\t\tonChange={ this.updateWidth }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<TextControl\n\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\tclassName=\"block-library-image__dimensions__height\"\n\t\t\t\t\t\t\t\t\tlabel={ __( 'Height' ) }\n\t\t\t\t\t\t\t\t\tvalue={ height !== undefined ? height : '' }\n\t\t\t\t\t\t\t\t\tplaceholder={ imageHeight }\n\t\t\t\t\t\t\t\t\tmin={ 1 }\n\t\t\t\t\t\t\t\t\tonChange={ this.updateHeight }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"block-library-image__dimensions__row\">\n\t\t\t\t\t\t\t\t<ButtonGroup aria-label={ __( 'Image Size' ) }>\n\t\t\t\t\t\t\t\t\t{ [ 25, 50, 75, 100 ].map( ( scale ) => {\n\t\t\t\t\t\t\t\t\t\tconst scaledWidth = Math.round( imageWidth * ( scale / 100 ) );\n\t\t\t\t\t\t\t\t\t\tconst scaledHeight = Math.round( imageHeight * ( scale / 100 ) );\n\n\t\t\t\t\t\t\t\t\t\tconst isCurrent = width === scaledWidth && height === scaledHeight;\n\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\tkey={ scale }\n\t\t\t\t\t\t\t\t\t\t\t\tisSmall\n\t\t\t\t\t\t\t\t\t\t\t\tisPrimary={ isCurrent }\n\t\t\t\t\t\t\t\t\t\t\t\taria-pressed={ isCurrent }\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={ this.updateDimensions( scaledWidth, scaledHeight ) }\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{ scale }%\n\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} ) }\n\t\t\t\t\t\t\t\t</ButtonGroup>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tisSmall\n\t\t\t\t\t\t\t\t\tonClick={ this.updateDimensions() }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ __( 'Reset' ) }\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) }\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t);\n\n\t\t// Disable reason: Each block can be selected by clicking on it\n\t\t/* eslint-disable jsx-a11y/no-static-element-interactions, jsx-a11y/onclick-has-role, jsx-a11y/click-events-have-key-events */\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t{ controls }\n\t\t\t\t<figure className={ classes }>\n\t\t\t\t\t<ImageSize src={ url } dirtynessTrigger={ align }>\n\t\t\t\t\t\t{ ( sizes ) => {\n\t\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\t\timageWidthWithinContainer,\n\t\t\t\t\t\t\t\timageHeightWithinContainer,\n\t\t\t\t\t\t\t\timageWidth,\n\t\t\t\t\t\t\t\timageHeight,\n\t\t\t\t\t\t\t} = sizes;\n\n\t\t\t\t\t\t\tconst filename = this.getFilename( url );\n\t\t\t\t\t\t\tlet defaultedAlt;\n\t\t\t\t\t\t\tif ( alt ) {\n\t\t\t\t\t\t\t\tdefaultedAlt = alt;\n\t\t\t\t\t\t\t} else if ( filename ) {\n\t\t\t\t\t\t\t\tdefaultedAlt = sprintf( __( 'This image has an empty alt attribute; its file name is %s' ), filename );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdefaultedAlt = __( 'This image has an empty alt attribute' );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst img = (\n\t\t\t\t\t\t\t\t// Disable reason: Image itself is not meant to be interactive, but\n\t\t\t\t\t\t\t\t// should direct focus to block.\n\t\t\t\t\t\t\t\t/* eslint-disable jsx-a11y/no-noninteractive-element-interactions */\n\t\t\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t\t\t<ta linkid={ linkid } href={ href }>\n\t\t\t\t\t\t\t\t\t\t<img src={ url } alt={ defaultedAlt } onClick={ this.onImageClick } onError={ () => this.onImageError( url ) } />\n\t\t\t\t\t\t\t\t\t</ta>\n\t\t\t\t\t\t\t\t\t{ isBlobURL( url ) && <Spinner /> }\n\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t\t/* eslint-enable jsx-a11y/no-noninteractive-element-interactions */\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif ( ! isResizable || ! imageWidthWithinContainer ) {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t\t\t\t{ getInspectorControls( imageWidth, imageHeight ) }\n\t\t\t\t\t\t\t\t\t\t<div style={ { width, height } }>\n\t\t\t\t\t\t\t\t\t\t\t{ img }\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst currentWidth = width || imageWidthWithinContainer;\n\t\t\t\t\t\t\tconst currentHeight = height || imageHeightWithinContainer;\n\n\t\t\t\t\t\t\tconst ratio = imageWidth / imageHeight;\n\t\t\t\t\t\t\tconst minWidth = imageWidth < imageHeight ? MIN_SIZE : MIN_SIZE * ratio;\n\t\t\t\t\t\t\tconst minHeight = imageHeight < imageWidth ? MIN_SIZE : MIN_SIZE / ratio;\n\n\t\t\t\t\t\t\t// With the current implementation of ResizableBox, an image needs an explicit pixel value for the max-width.\n\t\t\t\t\t\t\t// In absence of being able to set the content-width, this max-width is currently dictated by the vanilla editor style.\n\t\t\t\t\t\t\t// The following variable adds a buffer to this vanilla style, so 3rd party themes have some wiggleroom.\n\t\t\t\t\t\t\t// This does, in most cases, allow you to scale the image beyond the width of the main column, though not infinitely.\n\t\t\t\t\t\t\t// @todo It would be good to revisit this once a content-width variable becomes available.\n\t\t\t\t\t\t\tconst maxWidthBuffer = maxWidth * 2.5;\n\n\t\t\t\t\t\t\tlet showRightHandle = false;\n\t\t\t\t\t\t\tlet showLeftHandle = false;\n\n\t\t\t\t\t\t\t/* eslint-disable no-lonely-if */\n\t\t\t\t\t\t\t// See https://github.com/WordPress/gutenberg/issues/7584.\n\t\t\t\t\t\t\tif ( align === 'center' ) {\n\t\t\t\t\t\t\t\t// When the image is centered, show both handles.\n\t\t\t\t\t\t\t\tshowRightHandle = true;\n\t\t\t\t\t\t\t\tshowLeftHandle = true;\n\t\t\t\t\t\t\t} else if ( isRTL ) {\n\t\t\t\t\t\t\t\t// In RTL mode the image is on the right by default.\n\t\t\t\t\t\t\t\t// Show the right handle and hide the left handle only when it is aligned left.\n\t\t\t\t\t\t\t\t// Otherwise always show the left handle.\n\t\t\t\t\t\t\t\tif ( align === 'left' ) {\n\t\t\t\t\t\t\t\t\tshowRightHandle = true;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tshowLeftHandle = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// Show the left handle and hide the right handle only when the image is aligned right.\n\t\t\t\t\t\t\t\t// Otherwise always show the right handle.\n\t\t\t\t\t\t\t\tif ( align === 'right' ) {\n\t\t\t\t\t\t\t\t\tshowLeftHandle = true;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tshowRightHandle = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/* eslint-enable no-lonely-if */\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t\t\t{ getInspectorControls( imageWidth, imageHeight ) }\n\t\t\t\t\t\t\t\t\t<ResizableBox\n\t\t\t\t\t\t\t\t\t\tsize={\n\t\t\t\t\t\t\t\t\t\t\twidth && height ? {\n\t\t\t\t\t\t\t\t\t\t\t\twidth,\n\t\t\t\t\t\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t\t\t\t\t\t} : undefined\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tminWidth={ minWidth }\n\t\t\t\t\t\t\t\t\t\tmaxWidth={ maxWidthBuffer }\n\t\t\t\t\t\t\t\t\t\tminHeight={ minHeight }\n\t\t\t\t\t\t\t\t\t\tmaxHeight={ maxWidthBuffer / ratio }\n\t\t\t\t\t\t\t\t\t\tlockAspectRatio\n\t\t\t\t\t\t\t\t\t\tenable={ {\n\t\t\t\t\t\t\t\t\t\t\ttop: false,\n\t\t\t\t\t\t\t\t\t\t\tright: showRightHandle,\n\t\t\t\t\t\t\t\t\t\t\tbottom: true,\n\t\t\t\t\t\t\t\t\t\t\tleft: showLeftHandle,\n\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t\tonResizeStart={ () => {\n\t\t\t\t\t\t\t\t\t\t\ttoggleSelection( false );\n\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t\tonResizeStop={ ( event, direction, elt, delta ) => {\n\t\t\t\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\t\t\t\twidth: parseInt( currentWidth + delta.width, 10 ),\n\t\t\t\t\t\t\t\t\t\t\t\theight: parseInt( currentHeight + delta.height, 10 ),\n\t\t\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t\t\t\ttoggleSelection( true );\n\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ img }\n\t\t\t\t\t\t\t\t\t</ResizableBox>\n\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} }\n\t\t\t\t\t</ImageSize>\n\t\t\t\t\t{ ( ! RichText.isEmpty( caption ) || isSelected ) && (\n\t\t\t\t\t\t<RichText\n\t\t\t\t\t\t\ttagName=\"figcaption\"\n\t\t\t\t\t\t\tplaceholder={ __( 'Write caption…' ) }\n\t\t\t\t\t\t\tvalue={ caption }\n\t\t\t\t\t\t\tunstableOnFocus={ this.onFocusCaption }\n\t\t\t\t\t\t\tonChange={ ( value ) => setAttributes( { caption: value } ) }\n\t\t\t\t\t\t\tisSelected={ this.state.captionFocused }\n\t\t\t\t\t\t\tinlineToolbar\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</figure>\n\t\t\t</Fragment>\n\t\t);\n\t\t/* eslint-enable jsx-a11y/no-static-element-interactions, jsx-a11y/onclick-has-role, jsx-a11y/click-events-have-key-events */\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select, props ) => {\n\t\tconst { getMedia } = select( 'core' );\n\t\tconst { getEditorSettings } = select( 'core/editor' );\n\t\tconst { id } = props.attributes;\n\t\tconst { maxWidth, isRTL, imageSizes } = getEditorSettings();\n\n\t\treturn {\n\t\t\timage: id ? getMedia( id ) : null,\n\t\t\tmaxWidth,\n\t\t\tisRTL,\n\t\t\timageSizes,\n\t\t};\n\t} ),\n\twithViewportMatch( { isLargeViewport: 'medium' } ),\n\twithNotices,\n] )( ImageEdit );\n\n\n// WEBPACK FOOTER //\n// ./src/blocks/ta-image/edit.js","const WORDPRESS_EMBED_BLOCK = 'core-embed/wordpress';\n\nconst { includes } = lodash;\nconst { renderToString } = wp.element;\nconst { createBlock } = wp.blocks;\n\n/***\n * Creates a more suitable embed block based on the passed in props\n * and attributes generated from an embed block's preview.\n *\n * We require `attributesFromPreview` to be generated from the latest attributes\n * and preview, and because of the way the react lifecycle operates, we can't\n * guarantee that the attributes contained in the block's props are the latest\n * versions, so we require that these are generated separately.\n * See `getAttributesFromPreview` in the generated embed edit component.\n *\n * @param {Object}            props                 The block's props.\n * @param {Object}            attributesFromPreview Attributes generated from the block's most up to date preview.\n * @return {Object|undefined} A more suitable embed block if one exists.\n */\nexport const createUpgradedEmbedBlock = ( props, attributesFromPreview ) => {\n\tconst { preview, name } = props;\n\tconst { url } = props.attributes;\n\n\tif ( ! url ) {\n\t\treturn;\n\t}\n\n\tconst matchingBlock = findBlock( url );\n\n\t// WordPress blocks can work on multiple sites, and so don't have patterns,\n\t// so if we're in a WordPress block, assume the user has chosen it for a WordPress URL.\n\tif ( WORDPRESS_EMBED_BLOCK !== name && DEFAULT_EMBED_BLOCK !== matchingBlock ) {\n\t\t// At this point, we have discovered a more suitable block for this url, so transform it.\n\t\tif ( name !== matchingBlock ) {\n\t\t\treturn createBlock( matchingBlock, { url } );\n\t\t}\n\t}\n\n\tif ( preview ) {\n\t\tconst { html } = preview;\n\n\t\t// We can't match the URL for WordPress embeds, we have to check the HTML instead.\n\t\tif ( isFromWordPress( html ) ) {\n\t\t\t// If this is not the WordPress embed block, transform it into one.\n\t\t\tif ( WORDPRESS_EMBED_BLOCK !== name ) {\n\t\t\t\treturn createBlock(\n\t\t\t\t\tWORDPRESS_EMBED_BLOCK,\n\t\t\t\t\t{\n\t\t\t\t\t\turl,\n\t\t\t\t\t\t// By now we have the preview, but when the new block first renders, it\n\t\t\t\t\t\t// won't have had all the attributes set, and so won't get the correct\n\t\t\t\t\t\t// type and it won't render correctly. So, we pass through the current attributes\n\t\t\t\t\t\t// here so that the initial render works when we switch to the WordPress\n\t\t\t\t\t\t// block. This only affects the WordPress block because it can't be\n\t\t\t\t\t\t// rendered in the usual Sandbox (it has a sandbox of its own) and it\n\t\t\t\t\t\t// relies on the preview to set the correct render type.\n\t\t\t\t\t\t...attributesFromPreview,\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n};\n\nexport const isFromWordPress = ( html ) => {\n\treturn includes( html, 'class=\"wp-embedded-content\" data-secret' );\n};\n\n\n// WEBPACK FOOTER //\n// ./src/blocks/ta-image/util.js","const { noop } = lodash;\n\nconst { withGlobalEvents  } = wp.compose;\nconst { Component } = wp.element;\n\nclass ImageSize extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\twidth: undefined,\n\t\t\theight: undefined,\n\t\t};\n\t\tthis.bindContainer = this.bindContainer.bind( this );\n\t\tthis.calculateSize = this.calculateSize.bind( this );\n\t}\n\n\tbindContainer( ref ) {\n\t\tthis.container = ref;\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( this.props.src !== prevProps.src ) {\n\t\t\tthis.setState( {\n\t\t\t\twidth: undefined,\n\t\t\t\theight: undefined,\n\t\t\t} );\n\t\t\tthis.fetchImageSize();\n\t\t}\n\n\t\tif ( this.props.dirtynessTrigger !== prevProps.dirtynessTrigger ) {\n\t\t\tthis.calculateSize();\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.fetchImageSize();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif ( this.image ) {\n\t\t\tthis.image.onload = noop;\n\t\t}\n\t}\n\n\tfetchImageSize() {\n\t\tthis.image = new window.Image();\n\t\tthis.image.onload = this.calculateSize;\n\t\tthis.image.src = this.props.src;\n\t}\n\n\tcalculateSize() {\n\t\tconst maxWidth = this.container.clientWidth;\n\t\tconst exceedMaxWidth = this.image.width > maxWidth;\n\t\tconst ratio = this.image.height / this.image.width;\n\t\tconst width = exceedMaxWidth ? maxWidth : this.image.width;\n\t\tconst height = exceedMaxWidth ? maxWidth * ratio : this.image.height;\n\t\tthis.setState( { width, height } );\n\t}\n\n\trender() {\n\t\tconst sizes = {\n\t\t\timageWidth: this.image && this.image.width,\n\t\t\timageHeight: this.image && this.image.height,\n\t\t\tcontainerWidth: this.container && this.container.clientWidth,\n\t\t\tcontainerHeight: this.container && this.container.clientHeight,\n\t\t\timageWidthWithinContainer: this.state.width,\n\t\t\timageHeightWithinContainer: this.state.height,\n\t\t};\n\t\treturn (\n\t\t\t<div ref={ this.bindContainer }>\n\t\t\t\t{ this.props.children( sizes ) }\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default withGlobalEvents( {\n\tresize: 'calculateSize',\n} )( ImageSize );\n\n\n// WEBPACK FOOTER //\n// ./src/blocks/ta-image/image-size.js","import classnames from \"classnames\";\n\nconst { __ } = wp.i18n;\nconst { Component , createRef } = wp.element;\nconst { Spinner, withSpokenMessages, Popover , TextControl } = wp.components;\nconst { withInstanceId } = wp.compose;\n\nclass ThirstyURLInput extends Component {\n\n    /**\n     * Component constructor method.\n     * \n     * @since 3.6\n     * \n     * @param {*} param0 \n     */\n\tconstructor( { autocompleteRef } ) {\n\t\tsuper( ...arguments );\n\n\t\t// this.onChange = this.onChange.bind( this );\n\t\t// this.onKeyDown = this.onKeyDown.bind( this );\n\t\tthis.autocompleteRef = autocompleteRef || createRef();\n\t\tthis.inputRef = createRef();\n\t\tthis.searchAffiliateLinks = this.searchAffiliateLinks.bind( this );\n\t\t// this.updateSuggestions = throttle( this.updateSuggestions.bind( this ), 200 );\n\n\t\tthis.suggestionNodes = [];\n\n\t\tthis.state = {\n\t\t\tposts : [],\n\t\t\tshowSuggestions : false,\n\t\t\tselectedSuggestion : null,\n\t\t\tloading : false\n\t\t};\n\t}\n\n\t/**\n     * Component did update method.\n     * \n     * @since 3.6\n     */\n\tcomponentDidUpdate() {\n\t\tconst { showSuggestions, selectedSuggestion } = this.state;\n\t\t// only have to worry about scrolling selected suggestion into view\n\t\t// when already expanded\n\t\tif ( showSuggestions && selectedSuggestion !== null && ! this.scrollingIntoView ) {\n\t\t\tthis.scrollingIntoView = true;\n\t\t\tscrollIntoView( this.suggestionNodes[ selectedSuggestion ], this.autocompleteRef.current, {\n\t\t\t\tonlyScrollIfNeeded: true,\n\t\t\t} );\n\n\t\t\tsetTimeout( () => {\n\t\t\t\tthis.scrollingIntoView = false;\n\t\t\t}, 100 );\n\t\t}\n\t}\n\n\t/**\n     * Component unmount method.\n     * \n     * @since 3.6\n     */\n\tcomponentWillUnmount() {\n\t\tdelete this.suggestionsRequest;\n\t}\n\n\t/**\n     * Bind suggestion to node.\n     * \n     * @param {*} index \n     */\n\tbindSuggestionNode( index ) {\n\t\treturn ( ref ) => {\n\t\t\tthis.suggestionNodes[ index ] = ref;\n\t\t};\n\t}\n\t\n\tsearchAffiliateLinks( value ) {\n\n\t\t// Show the suggestions after typing at least 2 characters=\n\t\tif ( value.length < 2 ) {\n\t\t\tthis.setState( {\n\t\t\t\tshowSuggestions: false,\n\t\t\t\tselectedSuggestion: null,\n\t\t\t\tloading: false,\n\t\t\t} );\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setState({\n\t\t\tshowSuggestions : true,\n\t\t\tselectedSuggestion : null,\n\t\t\tloading : true\n\t\t});\n\n\t\tconst formData = new FormData();\n        formData.append( \"action\" , \"search_affiliate_links_query\" );\n        formData.append( \"keyword\" , value );\n        formData.append( \"paged\" , 1 );\n\t\tformData.append( \"gutenberg\" , true );\n\t\tformData.append( \"with_images\" , true );\n\t\t\n\t\t// We are getting data via the WP AJAX instead of rest API as it is not possible yet\n        // to filter results with category value. This is to prepare next update to add category filter.\n        const request = fetch( ajaxurl , {\n            method : \"POST\",\n            body   : formData\n\t\t} );\n\t\t\n\t\trequest\n        .then( response => response.json() )\n        .then( ( response ) => {\n\n            if ( ! response.affiliate_links ) return;\n\n            const posts = response.affiliate_links;\n\n\t\t\t// A fetch Promise doesn't have an abort option. It's mimicked by\n\t\t\t// comparing the request reference in on the instance, which is\n\t\t\t// reset or deleted on subsequent requests or unmounting.\n\t\t\tif ( this.suggestionsRequest !== request ) {\n\t\t\t\treturn;\n            }\n\n\t\t\tthis.setState( {\n\t\t\t\tposts,\n\t\t\t\tloading: false,\n            } );\n\n\t\t\tif ( !! posts.length ) {\n\t\t\t\tthis.props.debouncedSpeak( sprintf( _n(\n\t\t\t\t\t'%d result found, use up and down arrow keys to navigate.',\n\t\t\t\t\t'%d results found, use up and down arrow keys to navigate.',\n\t\t\t\t\tposts.length\n\t\t\t\t), posts.length ), 'assertive' );\n\t\t\t} else {\n\t\t\t\tthis.props.debouncedSpeak( __( 'No results.' ), 'assertive' );\n            }\n\n\t\t} ).catch( () => {\n\t\t\tif ( this.suggestionsRequest === request ) {\n\t\t\t\tthis.setState( {\n\t\t\t\t\tloading: false,\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\n\t\tthis.suggestionsRequest = request;\n\t}\n\n\t/**\n     * Set state when an affiliate link is selected.\n     * \n     * @since 3.6\n     * \n     * @param {*} post \n     */\n\tselectLink( post ) {\n\t\t// this.props.onChange( post.link, post );\n\t\tthis.setState( {\n\t\t\tselectedSuggestion: post,\n\t\t\tshowSuggestions: false,\n\t\t} );\n\n\t\tthis.props.updateImageSelection( post.images , post );\n\t}\n\n\t/**\n     * Callback handler for when affiliate link is selected.\n     * \n     * @param {*} post \n     */\n\thandleOnClick( post ) {\n\t\tthis.selectLink( post );\n\t\t// Move focus to the input field when a link suggestion is clicked.\n\t\t// this.inputRef.current.focus();\n\t}\n\n    render() {\n        const { value = '', autoFocus = true, instanceId } = this.props;\n        const { showSuggestions , posts, selectedSuggestion , loading } = this.state;\n        \n        return (\n            <div class=\"edit-search-affiliate-links\">\n\t\t\t\t<form\n\t\t\t\t\tclassName=\"editor-format-toolbar__link-container-content ta-link-search-popover\"\n\t\t\t\t\tonSubmit={ this.displayAffiliateImages }\n\t\t\t\t>\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tclassName=\"ta-search-affiliate-links\"\n\t\t\t\t\t\tplaceholder={ __( \"Type to search affiliate links\" ) }\n\t\t\t\t\t\tonChange={ this.searchAffiliateLinks }\n\t\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t{ ( loading ) && <Spinner /> }\n\n\t\t\t\t\t{ showSuggestions && !! posts.length && \n\t\t\t\t\t\t<Popover position=\"bottom\" focusOnMount={ false }>\n\t\t\t\t\t\t\t<div class=\"affilate-links-suggestions\">\n\t\t\t\t\t\t\t\t{ posts.map( ( post, index ) => (\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tkey={ post.id }\n\t\t\t\t\t\t\t\t\t\trole=\"option\"\n\t\t\t\t\t\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t\t\t\t\t\t\tid={ `editor-url-input-suggestion-${ instanceId }-${ index }` }\n\t\t\t\t\t\t\t\t\t\tref={ this.bindSuggestionNode( index ) }\n\t\t\t\t\t\t\t\t\t\tclassName={ classnames( 'editor-url-input__suggestion', {\n\t\t\t\t\t\t\t\t\t\t\t'is-selected': index === selectedSuggestion,\n\t\t\t\t\t\t\t\t\t\t} ) }\n\t\t\t\t\t\t\t\t\t\tonClick={ () => this.handleOnClick( post ) }\n\t\t\t\t\t\t\t\t\t\taria-selected={ index === selectedSuggestion }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ post.title || __( '(no title)' ) }\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t) ) }\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Popover>\n\t\t\t\t\t}\n\t\t\t\t</form>\n            </div>\n        );\n    }\n}\n\nexport default withSpokenMessages( withInstanceId( ThirstyURLInput ) );\n\n\n// WEBPACK FOOTER //\n// ./src/blocks/ta-image/search-input.js","import { taLink } from \"./ta-link\";\n\nconst { registerFormatType } = wp.richText;\n\n/**\n * Register custom formats.\n * \n * @since 3.6\n */\nexport default function registerFormats() {\n\n    [\n        taLink\n    ].forEach( ( { name , ...settings } ) => registerFormatType( name , settings ) );\n}\n\n\n// WEBPACK FOOTER //\n// ./src/formats/index.js","import InlineAffiliateLinkUI from './inline';\n\nconst { __ } = wp.i18n;\nconst { Component , Fragment } = wp.element;\nconst { withSpokenMessages } = wp.components;\nconst { getTextContent , applyFormat , removeFormat , slice } = wp.richText;\nconst { isURL } = wp.url;\nconst { RichTextToolbarButton , RichTextShortcut } = wp.editor;\nconst { Path , SVG } = wp.components;\n\nconst name = \"ta/link\";\n\n/**\n * Custom Affiliate link format. When applied will wrap selected text with <ta href=\"\" linkid=\"\"></ta> custom element.\n * Custom element is implemented here as we are not allowed to use <a> tag due to Gutenberg limitations.\n * Element is converted to normal <a> tag on frontend via PHP script filtered on 'the_content'.\n * \n * @since 3.6\n */\nexport const taLink = {\n    name,\n    title      : __( \"Affiliate Link\" ),\n    tagName    : \"ta\",\n    className  : null,\n    attributes : {\n\t\turl    : \"href\",\n\t\ttarget : \"target\"\n    },\n    edit : withSpokenMessages( class LinkEdit extends Component {\n\t\t\n\t\t/**\n\t\t * Component constructor.\n\t\t * \n\t\t * @since 3.6\n\t\t */\n\t\tconstructor() {\n\t\t\tsuper( ...arguments );\n\n\t\t\tthis.addLink = this.addLink.bind( this );\n\t\t\tthis.stopAddingLink = this.stopAddingLink.bind( this );\n\t\t\tthis.onRemoveFormat = this.onRemoveFormat.bind( this );\n\t\t\tthis.state = {\n\t\t\t\taddingLink: false,\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * Callback to set state to adding link status.\n\t\t * \n\t\t * @since 3.6\n\t\t */\n\t\taddLink() {\n\t\t\tconst { value, onChange } = this.props;\n\t\t\tconst text = getTextContent( slice( value ) );\n\n\t\t\tif ( text && isURL( text ) ) {\n\t\t\t\tonChange( applyFormat( value, { type: name, attributes: { url: text } } ) );\n\t\t\t} else {\n\t\t\t\tthis.setState( { addingLink: true } );\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Callback to set state to stop adding link status.\n\t\t * \n\t\t * @since 3.6\n\t\t */\n\t\tstopAddingLink() {\n\t\t\tthis.setState( { addingLink: false } );\n\t\t}\n\n\t\t/**\n\t\t * Remove format event callback.\n\t\t * \n\t\t * @since 3.6\n\t\t */\n\t\tonRemoveFormat() {\n\t\t\tconst { value , onChange , speak } = this.props;\n\n\t\t\tonChange( removeFormat( value , name ) );\n\t\t\tspeak( __( \"Affiliate Link removed.\" ), \"assertive\" );\n\t\t}\n\n\t\t/**\n\t\t * Component render method.\n\t\t * \n\t\t * @since 3.6\n\t\t */\n\t\trender() {\n\t\t\tconst { isActive , activeAttributes , value , onChange } = this.props;\n\n\t\t\treturn (\n\t\t\t\t<Fragment>\n\t\t\t\t\t<RichTextShortcut\n\t\t\t\t\t\ttype=\"access\"\n\t\t\t\t\t\tcharacter=\"s\"\n\t\t\t\t\t\tonUse={ this.onRemoveFormat }\n\t\t\t\t\t/>\n\t\t\t\t\t<RichTextShortcut\n\t\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\t\tcharacter=\"l\"\n\t\t\t\t\t\tonUse={ this.addLink }\n\t\t\t\t\t/>\n\t\t\t\t\t<RichTextShortcut\n\t\t\t\t\t\ttype=\"primaryShift\"\n\t\t\t\t\t\tcharacter=\"l\"\n\t\t\t\t\t\tonUse={ this.onRemoveFormat }\n\t\t\t\t\t/>\n\t\t\t\t\t{ isActive && <RichTextToolbarButton\n\t\t\t\t\t\ticon=\"editor-unlink\"\n\t\t\t\t\t\ttitle={ __( 'Remove Affiliate Link' ) }\n\t\t\t\t\t\tclassName=\"ta-unlink-button\"\n\t\t\t\t\t\tonClick={ this.onRemoveFormat }\n\t\t\t\t\t\tisActive={ isActive }\n\t\t\t\t\t\tshortcutType=\"primaryShift\"\n\t\t\t\t\t\tshortcutCharacter=\"l\"\n\t\t\t\t\t/> }\n\t\t\t\t\t{ ! isActive && <RichTextToolbarButton\n\t\t\t\t\t\ticon={ <SVG xmlns=\"http://www.w3.org/2000/svg\" width=\"16.688\" height=\"9.875\" viewBox=\"0 0 16.688 9.875\"><Path id=\"TA.svg\" fill=\"black\" class=\"cls-1\" d=\"M2.115,15.12H4.847L6.836,7.7H9.777l0.63-2.381H1.821L1.177,7.7H4.118Zm4.758,0H9.829l1.177-1.751h3.782l0.238,1.751h2.858L16.357,5.245H13.7Zm5.5-3.866,1.835-2.816,0.35,2.816H12.378Z\" transform=\"translate(-1.188 -5.25)\"/></SVG> }\n\t\t\t\t\t\ttitle={ __( 'Affiliate Link' ) }\n\t\t\t\t\t\tclassName=\"ta-link-button\"\n\t\t\t\t\t\tonClick={ this.addLink }\n\t\t\t\t\t\tshortcutType=\"primary\"\n\t\t\t\t\t\tshortcutCharacter=\"l\"\n\t\t\t\t\t/> }\n\t\t\t\t\t<InlineAffiliateLinkUI\n\t\t\t\t\t\taddingLink={ this.state.addingLink }\n\t\t\t\t\t\tstopAddingLink={ this.stopAddingLink }\n\t\t\t\t\t\tisActive={ isActive }\n\t\t\t\t\t\tactiveAttributes={ activeAttributes }\n\t\t\t\t\t\tvalue={ value }\n\t\t\t\t\t\tonChange={ onChange }\n\t\t\t\t\t/>\n\t\t\t\t</Fragment>\n\t\t\t);\n\t\t}\n    } )\n}\n\n\n// WEBPACK FOOTER //\n// ./src/formats/ta-link/index.js","import classnames from \"classnames\";\nimport ThirstyPositionedAtSelection from './positioned-at-selection';\nimport { isValidHref } from './utils';\nimport ThirstyURLPopover from './url-popover';\nimport ThirstyURLInput from './url-input';\n\nconst { __ } = wp.i18n;\nconst { Component , createRef } = wp.element;\nconst { ExternalLink , ToggleControl , IconButton , withSpokenMessages } = wp.components;\nconst { LEFT, RIGHT, UP, DOWN, BACKSPACE, ENTER } = wp.keycodes;\nconst { prependHTTP , safeDecodeURI , filterURLForDisplay } = wp.url;\nconst { create , insert , isCollapsed , applyFormat , getTextContent , slice } = wp.richText;\n\nconst stopKeyPropagation = ( event ) => event.stopPropagation();\n\n/**\n * Generates the format object that will be applied to the link text.\n * \n * @since 3.6\n *\n * @param {string}  url    The href of the link.\n * @param {boolean} linkid Affiliate link ID.\n * @param {Object}  text   The text that is being hyperlinked.\n *\n * @return {Object} The final format object.\n */\nfunction createLinkFormat( { url , linkid , text } ) {\n\tconst format = {\n\t\ttype: \"ta/link\",\n\t\tattributes: {\n\t\t\turl,\n\t\t\tlinkid : linkid.toString()\n\t\t},\n\t};\n\n\treturn format;\n}\n\n/**\n * Check if input is being show.\n * \n * @since 3.6\n * \n * @param {Object} props Component props.\n * @param {Object} state Component state.\n */\nfunction isShowingInput( props , state ) {\n\treturn props.addingLink || state.editLink;\n}\n\n/**\n * Affiliate Link editor JSX element.\n * \n * @since 3.6\n * \n * @param {Object} param0 Component props (destructred).\n */\nconst LinkEditor = ( { value , onChangeInputValue , onKeyDown , submitLink, invalidLink , resetInvalidLink , autocompleteRef } ) => (\n\t// Disable reason: KeyPress must be suppressed so the block doesn't hide the toolbar\n\t/* eslint-disable jsx-a11y/no-noninteractive-element-interactions */\n\t<form\n\t\tclassName=\"editor-format-toolbar__link-container-content ta-link-search-popover\"\n\t\tonKeyPress={ stopKeyPropagation }\n\t\tonKeyDown={ onKeyDown }\n\t\tonSubmit={ submitLink }\n\t>\n\t\t<ThirstyURLInput\n\t\t\tvalue={ value }\n\t\t\tonChange={ onChangeInputValue }\n\t\t\tautocompleteRef={ autocompleteRef }\n\t\t\tinvalidLink={ invalidLink }\n\t\t\tresetInvalidLink={ resetInvalidLink }\n\t\t/>\n\t\t<IconButton icon=\"editor-break\" label={ __( 'Apply' ) } type=\"submit\" />\n\t</form>\n\t/* eslint-enable jsx-a11y/no-noninteractive-element-interactions */\n);\n\n/**\n * Affiliate link url viewer JSX element.\n * \n * @param {*} param0 Component props (destructred).\n */\nconst LinkViewerUrl = ( { url } ) => {\n\tconst prependedURL = prependHTTP( url );\n\tconst linkClassName = classnames( 'editor-format-toolbar__link-container-value', {\n\t\t'has-invalid-link': ! isValidHref( prependedURL ),\n\t} );\n\n\tif ( ! url ) {\n\t\treturn <span className={ linkClassName }></span>;\n\t}\n\n\treturn (\n\t\t<ExternalLink\n\t\t\tclassName={ linkClassName }\n\t\t\thref={ url }\n\t\t>\n\t\t\t{ filterURLForDisplay( safeDecodeURI( url ) ) }\n\t\t</ExternalLink>\n\t);\n};\n\n/**\n * Affiliate link viewer JSX element.\n * \n * @param {*} param0 Component props (destructred).\n */\nconst LinkViewer = ( { url, editLink } ) => {\n\treturn (\n\t\t// Disable reason: KeyPress must be suppressed so the block doesn't hide the toolbar\n\t\t/* eslint-disable jsx-a11y/no-static-element-interactions */\n\t\t<div\n\t\t\tclassName=\"editor-format-toolbar__link-container-content\"\n\t\t\tonKeyPress={ stopKeyPropagation }\n\t\t>\n\t\t\t<LinkViewerUrl url={ url } />\n\t\t\t<IconButton icon=\"edit\" label={ __( 'Edit' ) } onClick={ editLink } />\n\t\t</div>\n\t\t/* eslint-enable jsx-a11y/no-static-element-interactions */\n\t);\n};\n\n/**\n * Inline affiliate link UI Component.\n * \n * @since 3.6\n * \n * @param {*} param0 Component props (destructred).\n */\nclass InlineAffiliateLinkUI extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.editLink = this.editLink.bind( this );\n\t\tthis.submitLink = this.submitLink.bind( this );\n\t\tthis.onKeyDown = this.onKeyDown.bind( this );\n\t\tthis.onChangeInputValue = this.onChangeInputValue.bind( this );\n\t\tthis.onClickOutside = this.onClickOutside.bind( this );\n\t\tthis.resetState = this.resetState.bind( this );\n\t\tthis.autocompleteRef = createRef();\n\t\tthis.resetInvalidLink = this.resetInvalidLink.bind( this );\n\n\t\tthis.state = {\n\t\t\tinputValue : '',\n\t\t\tlinkid : 0,\n\t\t\tpost : null,\n\t\t\tinvalidLink : false\n\t\t};\n\t}\n\n\t/**\n\t * Stop the key event from propagating up to ObserveTyping.startTypingInTextField.\n\t * \n\t * @since 3.6\n\t * \n\t * @param {Object} event Event object.\n\t */\n\tonKeyDown( event ) {\n\t\tif ( [ LEFT, DOWN, RIGHT, UP, BACKSPACE, ENTER ].indexOf( event.keyCode ) > -1 ) {\n\t\t\tevent.stopPropagation();\n\t\t}\n\t}\n\n\t/**\n\t * Callback to set state when input value is changed.\n\t * \n\t * @since 3.6\n\t * \n\t * @param {*} inputValue \n\t * @param {*} post \n\t */\n\tonChangeInputValue( inputValue , post = null ) {\n\t\tconst linkid = post ? post.id : 0;\n\t\tthis.setState( { inputValue , linkid , post } );\n\t}\n\n\t/**\n\t * Callback to set state when edit affiliate link (already inserted) is triggered.\n\t * \n\t * @since 3.6\n\t * \n\t * @param {*} event \n\t */\n\teditLink( event ) {\n\t\tthis.setState( { editLink: true } );\n\t\tevent.preventDefault();\n\t}\n\n\t/**\n\t * Callback to apply the affiliate link format to the selected text or position in the active block.\n\t * \n\t * @since 3.6\n\t * \n\t * @param {*} event \n\t */\n\tsubmitLink( event ) {\n\t\tconst { isActive, value, onChange, speak } = this.props;\n\t\tconst { inputValue, linkid , post } = this.state;\n\t\tconst url = prependHTTP( inputValue );\n\t\tconst selectedText = getTextContent( slice( value ) );\n\t\tconst format = createLinkFormat( {\n\t\t\turl,\n\t\t\tlinkid,\n\t\t\ttext: selectedText,\n\t\t} );\n\n\t\tevent.preventDefault();\n\n\t\tif ( ! linkid || ! post ) {\n\t\t\tthis.setState( { invalidLink : true } )\n\t\t\treturn;\n\t\t} \n\n\t\tif ( isCollapsed( value ) && ! isActive ) {\n\t\t\tconst toInsert = applyFormat( create( { text: post.title } ), format, 0, url.length );\n\t\t\tonChange( insert( value, toInsert ) );\n\t\t} else {\n\t\t\tonChange( applyFormat( value, format ) );\n\t\t}\n\n\t\tthis.resetState();\n\n\t\tif ( ! isValidHref( url ) ) {\n\t\t\tspeak( __( 'Warning: the link has been inserted but may have errors. Please test it.' ), 'assertive' );\n\t\t} else if ( isActive ) {\n\t\t\tspeak( __( 'Link edited.' ), 'assertive' );\n\t\t} else {\n\t\t\tspeak( __( 'Link inserted' ), 'assertive' );\n\t\t}\n\t}\n\n\t/**\n\t * Callback to run when users clicks outside the popover UI.\n\t * \n\t * @since 3.6\n\t * \n\t * @param {*} event \n\t */\n\tonClickOutside( event ) {\n\t\t// The autocomplete suggestions list renders in a separate popover (in a portal),\n\t\t// so onClickOutside fails to detect that a click on a suggestion occured in the\n\t\t// LinkContainer. Detect clicks on autocomplete suggestions using a ref here, and\n\t\t// return to avoid the popover being closed.\n\t\tconst autocompleteElement = this.autocompleteRef.current;\n\t\tif ( autocompleteElement && autocompleteElement.contains( event.target ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.resetState();\n\t}\n\n\t/**\n\t * Reset state callback.\n\t * \n\t * @since 3.6\n\t */\n\tresetState() {\n\t\tthis.props.stopAddingLink();\n\t\tthis.setState( { inputValue : '' , editLink: false } );\n\t\tthis.resetInvalidLink();\n\t}\n\n\t/**\n\t * Reset invalid link state callback. Separated as we need to run this independently from resetState() callback.\n\t * \n\t * @since 3.6\n\t */\n\tresetInvalidLink() {\n\t\tthis.setState( { invalidLink : false } );\n\t}\n\n\t/**\n\t * Component render method.\n\t *\n\t * @since 3.6\n\t */\n\trender() {\n\t\tconst { isActive, activeAttributes: { url , linkid }, addingLink, value, onChange } = this.props;\n\n\t\tif ( ! isActive && ! addingLink ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { inputValue , invalidLink } = this.state;\n\t\tconst showInput = isShowingInput( this.props, this.state );\n\n\t\treturn (\n\t\t\t<ThirstyPositionedAtSelection\n\t\t\t\tkey={ `${ value.start }${ value.end }` /* Used to force rerender on selection change */ }\n\t\t\t>\n\t\t\t\t<ThirstyURLPopover\n\t\t\t\t\tonClickOutside={ this.onClickOutside }\n\t\t\t\t\tonClose={ this.resetState }\n\t\t\t\t\tfocusOnMount={ showInput ? 'firstElement' : false }\n\t\t\t\t\tinvalidLink={ invalidLink }\n\t\t\t\t>\n\t\t\t\t\t{ showInput ? (\n\t\t\t\t\t\t<LinkEditor\n\t\t\t\t\t\t\tvalue={ inputValue }\n\t\t\t\t\t\t\tonChangeInputValue={ this.onChangeInputValue }\n\t\t\t\t\t\t\tonKeyDown={ this.onKeyDown }\n\t\t\t\t\t\t\tsubmitLink={ this.submitLink }\n\t\t\t\t\t\t\tautocompleteRef={ this.autocompleteRef }\n\t\t\t\t\t\t\tupdateLinkId= { this.updateLinkId }\n\t\t\t\t\t\t\tinvalidLink={ invalidLink }\n\t\t\t\t\t\t\tresetInvalidLink={ this.resetInvalidLink }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<LinkViewer\n\t\t\t\t\t\t\turl={ url }\n\t\t\t\t\t\t\teditLink={ this.editLink }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</ThirstyURLPopover>\n\t\t\t</ThirstyPositionedAtSelection>\n\t\t);\n\t}\n}\n\nexport default withSpokenMessages( InlineAffiliateLinkUI );\n\n\n// WEBPACK FOOTER //\n// ./src/formats/ta-link/inline.js","const { Component } = wp.element;\nconst { getOffsetParent , getRectangleFromRange } = wp.dom;\n\n/**\n * Returns a style object for applying as `position: absolute` for an element\n * relative to the bottom-center of the current selection. Includes `top` and\n * `left` style properties.\n * \n * @since 3.6\n *\n * @return {Object} Style object.\n */\nfunction getCurrentCaretPositionStyle() {\n\tconst selection = window.getSelection();\n\n\t// Unlikely, but in the case there is no selection, return empty styles so\n\t// as to avoid a thrown error by `Selection#getRangeAt` on invalid index.\n\tif ( selection.rangeCount === 0 ) {\n\t\treturn {};\n\t}\n\n\t// Get position relative viewport.\n\tconst rect = getRectangleFromRange( selection.getRangeAt( 0 ) );\n\tlet top = rect.top + rect.height;\n\tlet left = rect.left + ( rect.width / 2 );\n\n\t// Offset by positioned parent, if one exists.\n\tconst offsetParent = getOffsetParent( selection.anchorNode );\n\tif ( offsetParent ) {\n\t\tconst parentRect = offsetParent.getBoundingClientRect();\n\t\ttop -= parentRect.top;\n\t\tleft -= parentRect.left;\n\t}\n\n\treturn { top, left };\n}\n\n/**\n * Component which renders itself positioned under the current caret selection.\n * The position is calculated at the time of the component being mounted, so it\n * should only be mounted after the desired selection has been made.\n * \n * @since 3.6\n *\n * @type {WPComponent}\n */\nclass ThirstyPositionedAtSelection extends Component {\n\n\t/**\n\t * Component constructor method.\n\t * \n\t * @since 3.6\n\t */\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.state = {\n\t\t\tstyle: getCurrentCaretPositionStyle(),\n\t\t};\n\t}\n\n\t/**\n\t * Component render method.\n\t * \n\t * @since 3.6\n\t */\n\trender() {\n\t\tconst { children } = this.props;\n\t\tconst { style } = this.state;\n\n\t\treturn (\n\t\t\t<div className=\"editor-format-toolbar__selection-position\" style={ style }>\n\t\t\t\t{ children }\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default ThirstyPositionedAtSelection;\n\n\n// WEBPACK FOOTER //\n// ./src/formats/ta-link/positioned-at-selection.js","const { startsWith } = lodash;\n\nconst {\n    getProtocol,\n\tisValidProtocol,\n\tgetAuthority,\n\tisValidAuthority,\n\tgetPath,\n\tisValidPath,\n\tgetQueryString,\n\tisValidQueryString,\n\tgetFragment,\n\tisValidFragment,\n} = wp.url;\n\n/**\n * Check for issues with the provided href.\n * \n * @since 3.6\n *\n * @param {string} href The href.\n * @return {boolean} Is the href invalid?\n */\nexport function isValidHref( href ) {\n\tif ( ! href ) {\n\t\treturn false;\n\t}\n\n\tconst trimmedHref = href.trim();\n\n\tif ( ! trimmedHref ) {\n\t\treturn false;\n\t}\n\n\t// Does the href start with something that looks like a URL protocol?\n\tif ( /^\\S+:/.test( trimmedHref ) ) {\n\t\tconst protocol = getProtocol( trimmedHref );\n\t\tif ( ! isValidProtocol( protocol ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Add some extra checks for http(s) URIs, since these are the most common use-case.\n\t\t// This ensures URIs with an http protocol have exactly two forward slashes following the protocol.\n\t\tif ( startsWith( protocol, 'http' ) && ! /^https?:\\/\\/[^\\/\\s]/i.test( trimmedHref ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst authority = getAuthority( trimmedHref );\n\t\tif ( ! isValidAuthority( authority ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst path = getPath( trimmedHref );\n\t\tif ( path && ! isValidPath( path ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst queryString = getQueryString( trimmedHref );\n\t\tif ( queryString && ! isValidQueryString( queryString ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst fragment = getFragment( trimmedHref );\n\t\tif ( fragment && ! isValidFragment( fragment ) ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t// Validate anchor links.\n\tif ( startsWith( trimmedHref, '#' ) && ! isValidFragment( trimmedHref ) ) {\n\t\treturn false;\n\t}\n\n\treturn true;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/formats/ta-link/utils.js","const { __ } = wp.i18n;\nconst { Component } = wp.element;\nconst { Popover , IconButton } = wp.components;\n\n/**\n * Custom URL Popover component.\n * \n * @since 3.6\n */\nclass ThirstyURLPopover extends Component {\n\n    /**\n     * Component constructor method.\n     * \n     * @since 3.6\n     */\n\tconstructor() {\n        super( ...arguments );\n        \n        this.toggleSettingsVisibility = this.toggleSettingsVisibility.bind( this );\n\n\t\tthis.state = {\n\t\t\tisSettingsExpanded: false,\n\t\t};\n    }\n    \n    /**\n     * Component constructor.\n     * \n     * @since 3.6\n     */\n    toggleSettingsVisibility() {\n\t\tthis.setState( {\n\t\t\tisSettingsExpanded: ! this.state.isSettingsExpanded,\n\t\t} );\n\t}\n\n    /**\n     * Component render method.\n     * \n     * @since 3.6\n     */\n\trender() {\n\t\tconst {\n\t\t\tchildren,\n\t\t\trenderSettings,\n\t\t\tonClose,\n            onClickOutside,\n            invalidLink,\n\t\t\tposition = 'bottom center',\n\t\t\tfocusOnMount = 'firstElement',\n\t\t} = this.props;\n\n\t\tconst {\n\t\t\tisSettingsExpanded,\n        } = this.state;\n        \n        const showSettings = !! renderSettings && isSettingsExpanded;\n\n\t\treturn (\n\t\t\t<Popover\n\t\t\t\tclassName=\"ta-url-popover editor-url-popover\"\n\t\t\t\tfocusOnMount={ focusOnMount }\n\t\t\t\tposition={ position }\n\t\t\t\tonClose={ onClose }\n\t\t\t\tonClickOutside={ onClickOutside }\n\t\t\t>\n\t\t\t\t<div className=\"editor-url-popover__row\">\n                    { children }\n                    { !! renderSettings && (\n\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\tclassName=\"editor-url-popover__settings-toggle\"\n\t\t\t\t\t\t\ticon=\"ellipsis\"\n\t\t\t\t\t\t\tlabel={ __( 'Link Settings' ) }\n\t\t\t\t\t\t\tonClick={ this.toggleSettingsVisibility }\n\t\t\t\t\t\t\taria-expanded={ isSettingsExpanded }\n\t\t\t\t\t\t/>\n                    ) }\n\t\t\t\t</div>\n                { showSettings && (\n\t\t\t\t\t<div className=\"editor-url-popover__row editor-url-popover__settings\">\n\t\t\t\t\t\t{ renderSettings() }\n\t\t\t\t\t</div>\n                ) }\n                { invalidLink && <div class=\"ta-invalid-link\">{ __( 'Invalid affiliate link' ) }</div> }\n\t\t\t</Popover>\n\t\t);\n\t}\n}\n\nexport default ThirstyURLPopover;\n\n\n// WEBPACK FOOTER //\n// ./src/formats/ta-link/url-popover.js","import classnames from 'classnames';\nimport scrollIntoView from 'dom-scroll-into-view';\n\nconst { __ } = wp.i18n;\nconst { throttle } = lodash;\nconst { Component , createRef } = wp.element;\nconst { UP, DOWN, ENTER, TAB } = wp.keycodes;\nconst { Spinner, withSpokenMessages, Popover } = wp.components;\nconst { withInstanceId } = wp.compose;\n\n// Since URLInput is rendered in the context of other inputs, but should be\n// considered a separate modal node, prevent keyboard events from propagating\n// as being considered from the input.\nconst stopEventPropagation = ( event ) => event.stopPropagation();\n\n/**\n * Custom URL Input component.\n * \n * @since 3.6\n */\nclass ThirstyURLInput extends Component {\n\n    /**\n     * Component constructor method.\n     * \n     * @since 3.6\n     * \n     * @param {*} param0 \n     */\n\tconstructor( { autocompleteRef } ) {\n\t\tsuper( ...arguments );\n\n\t\tthis.onChange = this.onChange.bind( this );\n\t\tthis.onKeyDown = this.onKeyDown.bind( this );\n\t\tthis.autocompleteRef = autocompleteRef || createRef();\n\t\tthis.inputRef = createRef();\n\t\tthis.updateSuggestions = throttle( this.updateSuggestions.bind( this ), 200 );\n\n\t\tthis.suggestionNodes = [];\n\n\t\tthis.state = {\n\t\t\tposts: [],\n\t\t\tshowSuggestions: false,\n\t\t\tselectedSuggestion: null,\n\t\t};\n\t}\n\n    /**\n     * Component did update method.\n     * \n     * @since 3.6\n     */\n\tcomponentDidUpdate() {\n\t\tconst { showSuggestions, selectedSuggestion } = this.state;\n\t\t// only have to worry about scrolling selected suggestion into view\n\t\t// when already expanded\n\t\tif ( showSuggestions && selectedSuggestion !== null && ! this.scrollingIntoView ) {\n\t\t\tthis.scrollingIntoView = true;\n\t\t\tscrollIntoView( this.suggestionNodes[ selectedSuggestion ], this.autocompleteRef.current, {\n\t\t\t\tonlyScrollIfNeeded: true,\n\t\t\t} );\n\n\t\t\tsetTimeout( () => {\n\t\t\t\tthis.scrollingIntoView = false;\n\t\t\t}, 100 );\n\t\t}\n\t}\n\n    /**\n     * Component unmount method.\n     * \n     * @since 3.6\n     */\n\tcomponentWillUnmount() {\n\t\tdelete this.suggestionsRequest;\n\t}\n\n    /**\n     * Bind suggestion to node.\n     * \n     * @param {*} index \n     */\n\tbindSuggestionNode( index ) {\n\t\treturn ( ref ) => {\n\t\t\tthis.suggestionNodes[ index ] = ref;\n\t\t};\n\t}\n\n    /**\n     * Callback to show suggestions based on value inputted on search field.\n     * \n     * @since 3.6\n     * \n     * @param {*} value \n     */\n\tupdateSuggestions( value ) {\n\t\t// Show the suggestions after typing at least 2 characters\n\t\t// and also for URLs\n\t\tif ( value.length < 2 || /^https?:/.test( value ) ) {\n\t\t\tthis.setState( {\n\t\t\t\tshowSuggestions: false,\n\t\t\t\tselectedSuggestion: null,\n\t\t\t\tloading: false,\n\t\t\t} );\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setState( {\n\t\t\tshowSuggestions: true,\n\t\t\tselectedSuggestion: null,\n\t\t\tloading: true,\n\t\t} );\n\n        const formData = new FormData();\n        formData.append( \"action\" , \"search_affiliate_links_query\" );\n        formData.append( \"keyword\" , value );\n        formData.append( \"paged\" , 1 );\n        formData.append( \"gutenberg\" , true );\n        \n        // We are getting data via the WP AJAX instead of rest API as it is not possible yet\n        // to filter results with category value. This is to prepare next update to add category filter.\n        const request = fetch( ajaxurl , {\n            method : \"POST\",\n            body   : formData\n        } );\n\n        request\n        .then( response => response.json() )\n        .then( ( response ) => {\n\n            if ( ! response.affiliate_links ) return;\n\n            const posts = response.affiliate_links;\n\n\t\t\t// A fetch Promise doesn't have an abort option. It's mimicked by\n\t\t\t// comparing the request reference in on the instance, which is\n\t\t\t// reset or deleted on subsequent requests or unmounting.\n\t\t\tif ( this.suggestionsRequest !== request ) {\n\t\t\t\treturn;\n            }\n\n\t\t\tthis.setState( {\n\t\t\t\tposts,\n\t\t\t\tloading: false,\n            } );\n\n\t\t\tif ( !! posts.length ) {\n\t\t\t\tthis.props.debouncedSpeak( sprintf( _n(\n\t\t\t\t\t'%d result found, use up and down arrow keys to navigate.',\n\t\t\t\t\t'%d results found, use up and down arrow keys to navigate.',\n\t\t\t\t\tposts.length\n\t\t\t\t), posts.length ), 'assertive' );\n\t\t\t} else {\n\t\t\t\tthis.props.debouncedSpeak( __( 'No results.' ), 'assertive' );\n            }\n\n\t\t} ).catch( () => {\n\t\t\tif ( this.suggestionsRequest === request ) {\n\t\t\t\tthis.setState( {\n\t\t\t\t\tloading: false,\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\n\t\tthis.suggestionsRequest = request;\n\t}\n\n    /**\n     * Search input value change event callback method.\n     * \n     * @since 3.6\n     * \n     * @param {*} event \n     */\n\tonChange( event ) {\n        this.props.resetInvalidLink();\n\t\tconst inputValue = event.target.value;\n\t\tthis.props.onChange( inputValue );\n\t\tthis.updateSuggestions( inputValue );\n\t}\n\n    /**\n     * Keydown event callback. Handles selecting result via keyboard.\n     * \n     * @since 3.6\n     * \n     * @param {*} event \n     */\n\tonKeyDown( event ) {\n\t\tconst { showSuggestions, selectedSuggestion, posts, loading } = this.state;\n\t\t// If the suggestions are not shown or loading, we shouldn't handle the arrow keys\n\t\t// We shouldn't preventDefault to allow block arrow keys navigation\n\t\tif ( ! showSuggestions || ! posts.length || loading ) {\n\t\t\t// In the Windows version of Firefox the up and down arrows don't move the caret\n\t\t\t// within an input field like they do for Mac Firefox/Chrome/Safari. This causes\n\t\t\t// a form of focus trapping that is disruptive to the user experience. This disruption\n\t\t\t// only happens if the caret is not in the first or last position in the text input.\n\t\t\t// See: https://github.com/WordPress/gutenberg/issues/5693#issuecomment-436684747\n\t\t\tswitch ( event.keyCode ) {\n\t\t\t\t// When UP is pressed, if the caret is at the start of the text, move it to the 0\n\t\t\t\t// position.\n\t\t\t\tcase UP: {\n\t\t\t\t\tif ( 0 !== event.target.selectionStart ) {\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\t// Set the input caret to position 0\n\t\t\t\t\t\tevent.target.setSelectionRange( 0, 0 );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t// When DOWN is pressed, if the caret is not at the end of the text, move it to the\n\t\t\t\t// last position.\n\t\t\t\tcase DOWN: {\n\t\t\t\t\tif ( this.props.value.length !== event.target.selectionStart ) {\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\t// Set the input caret to the last position\n\t\t\t\t\t\tevent.target.setSelectionRange( this.props.value.length, this.props.value.length );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst post = this.state.posts[ this.state.selectedSuggestion ];\n\n\t\tswitch ( event.keyCode ) {\n\t\t\tcase UP: {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tconst previousIndex = ! selectedSuggestion ? posts.length - 1 : selectedSuggestion - 1;\n\t\t\t\tthis.setState( {\n\t\t\t\t\tselectedSuggestion: previousIndex,\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase DOWN: {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tconst nextIndex = selectedSuggestion === null || ( selectedSuggestion === posts.length - 1 ) ? 0 : selectedSuggestion + 1;\n\t\t\t\tthis.setState( {\n\t\t\t\t\tselectedSuggestion: nextIndex,\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase TAB: {\n\t\t\t\tif ( this.state.selectedSuggestion !== null ) {\n\t\t\t\t\tthis.selectLink( post );\n\t\t\t\t\t// Announce a link has been selected when tabbing away from the input field.\n\t\t\t\t\tthis.props.speak( __( 'Link selected' ) );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase ENTER: {\n\t\t\t\tif ( this.state.selectedSuggestion !== null ) {\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tthis.selectLink( post );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n    /**\n     * Set state when an affiliate link is selected.\n     * \n     * @since 3.6\n     * \n     * @param {*} post \n     */\n\tselectLink( post ) {\n\t\tthis.props.onChange( post.link, post );\n\t\tthis.setState( {\n\t\t\tselectedSuggestion: null,\n\t\t\tshowSuggestions: false,\n\t\t} );\n\t}\n\n    /**\n     * Callback handler for when affiliate link is selected.\n     * \n     * @param {*} post \n     */\n\thandleOnClick( post ) {\n\t\tthis.selectLink( post );\n\t\t// Move focus to the input field when a link suggestion is clicked.\n\t\tthis.inputRef.current.focus();\n\t}\n\n    /**\n     * Component render method.\n     * \n     * @since 3.6\n     */\n\trender() {\n\t\tconst { value = '', autoFocus = true, instanceId , invalidLink } = this.props;\n\t\tconst { showSuggestions, posts, selectedSuggestion, loading } = this.state;\n\t\t/* eslint-disable jsx-a11y/no-autofocus */\n\t\treturn (\n\t\t\t<div className=\"editor-url-input\">\n\t\t\t\t<input\n\t\t\t\t\tautoFocus={ autoFocus }\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\taria-label={ __( 'URL' ) }\n\t\t\t\t\trequired\n\t\t\t\t\tvalue={ value }\n\t\t\t\t\tonChange={ this.onChange }\n\t\t\t\t\tonInput={ stopEventPropagation }\n\t\t\t\t\tplaceholder={ __( 'Paste URL or type to search' ) }\n\t\t\t\t\tonKeyDown={ this.onKeyDown }\n\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\taria-expanded={ showSuggestions }\n\t\t\t\t\taria-autocomplete=\"list\"\n\t\t\t\t\taria-owns={ `editor-url-input-suggestions-${ instanceId }` }\n\t\t\t\t\taria-activedescendant={ selectedSuggestion !== null ? `editor-url-input-suggestion-${ instanceId }-${ selectedSuggestion }` : undefined }\n\t\t\t\t\tref={ this.inputRef }\n\t\t\t\t/>\n\n\t\t\t\t{ ( loading ) && <Spinner /> }\n\n\t\t\t\t{ showSuggestions && !! posts.length && ! invalidLink &&\n\t\t\t\t\t<Popover position=\"bottom\" noArrow focusOnMount={ false }>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"editor-url-input__suggestions\"\n\t\t\t\t\t\t\tid={ `editor-url-input-suggestions-${ instanceId }` }\n\t\t\t\t\t\t\tref={ this.autocompleteRef }\n\t\t\t\t\t\t\trole=\"listbox\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ posts.map( ( post, index ) => (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tkey={ post.id }\n\t\t\t\t\t\t\t\t\trole=\"option\"\n\t\t\t\t\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t\t\t\t\t\tid={ `editor-url-input-suggestion-${ instanceId }-${ index }` }\n\t\t\t\t\t\t\t\t\tref={ this.bindSuggestionNode( index ) }\n\t\t\t\t\t\t\t\t\tclassName={ classnames( 'editor-url-input__suggestion', {\n\t\t\t\t\t\t\t\t\t\t'is-selected': index === selectedSuggestion,\n\t\t\t\t\t\t\t\t\t} ) }\n\t\t\t\t\t\t\t\t\tonClick={ () => this.handleOnClick( post ) }\n\t\t\t\t\t\t\t\t\taria-selected={ index === selectedSuggestion }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ post.title || __( '(no title)' ) }\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t) ) }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Popover>\n\t\t\t\t}\n\t\t\t</div>\n\t\t);\n\t\t/* eslint-enable jsx-a11y/no-autofocus */\n\t}\n}\n\nexport default withSpokenMessages( withInstanceId( ThirstyURLInput ) );\n\n\n// WEBPACK FOOTER //\n// ./src/formats/ta-link/url-input.js","'use strict';\n\nmodule.exports = require('./dom-scroll-into-view');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/dom-scroll-into-view/lib/index.js\n// module id = 15\n// module chunks = 0","'use strict';\n\nvar util = require('./util');\n\nfunction scrollIntoView(elem, container, config) {\n  config = config || {};\n  // document 归一化到 window\n  if (container.nodeType === 9) {\n    container = util.getWindow(container);\n  }\n\n  var allowHorizontalScroll = config.allowHorizontalScroll;\n  var onlyScrollIfNeeded = config.onlyScrollIfNeeded;\n  var alignWithTop = config.alignWithTop;\n  var alignWithLeft = config.alignWithLeft;\n  var offsetTop = config.offsetTop || 0;\n  var offsetLeft = config.offsetLeft || 0;\n  var offsetBottom = config.offsetBottom || 0;\n  var offsetRight = config.offsetRight || 0;\n\n  allowHorizontalScroll = allowHorizontalScroll === undefined ? true : allowHorizontalScroll;\n\n  var isWin = util.isWindow(container);\n  var elemOffset = util.offset(elem);\n  var eh = util.outerHeight(elem);\n  var ew = util.outerWidth(elem);\n  var containerOffset = undefined;\n  var ch = undefined;\n  var cw = undefined;\n  var containerScroll = undefined;\n  var diffTop = undefined;\n  var diffBottom = undefined;\n  var win = undefined;\n  var winScroll = undefined;\n  var ww = undefined;\n  var wh = undefined;\n\n  if (isWin) {\n    win = container;\n    wh = util.height(win);\n    ww = util.width(win);\n    winScroll = {\n      left: util.scrollLeft(win),\n      top: util.scrollTop(win)\n    };\n    // elem 相对 container 可视视窗的距离\n    diffTop = {\n      left: elemOffset.left - winScroll.left - offsetLeft,\n      top: elemOffset.top - winScroll.top - offsetTop\n    };\n    diffBottom = {\n      left: elemOffset.left + ew - (winScroll.left + ww) + offsetRight,\n      top: elemOffset.top + eh - (winScroll.top + wh) + offsetBottom\n    };\n    containerScroll = winScroll;\n  } else {\n    containerOffset = util.offset(container);\n    ch = container.clientHeight;\n    cw = container.clientWidth;\n    containerScroll = {\n      left: container.scrollLeft,\n      top: container.scrollTop\n    };\n    // elem 相对 container 可视视窗的距离\n    // 注意边框, offset 是边框到根节点\n    diffTop = {\n      left: elemOffset.left - (containerOffset.left + (parseFloat(util.css(container, 'borderLeftWidth')) || 0)) - offsetLeft,\n      top: elemOffset.top - (containerOffset.top + (parseFloat(util.css(container, 'borderTopWidth')) || 0)) - offsetTop\n    };\n    diffBottom = {\n      left: elemOffset.left + ew - (containerOffset.left + cw + (parseFloat(util.css(container, 'borderRightWidth')) || 0)) + offsetRight,\n      top: elemOffset.top + eh - (containerOffset.top + ch + (parseFloat(util.css(container, 'borderBottomWidth')) || 0)) + offsetBottom\n    };\n  }\n\n  if (diffTop.top < 0 || diffBottom.top > 0) {\n    // 强制向上\n    if (alignWithTop === true) {\n      util.scrollTop(container, containerScroll.top + diffTop.top);\n    } else if (alignWithTop === false) {\n      util.scrollTop(container, containerScroll.top + diffBottom.top);\n    } else {\n      // 自动调整\n      if (diffTop.top < 0) {\n        util.scrollTop(container, containerScroll.top + diffTop.top);\n      } else {\n        util.scrollTop(container, containerScroll.top + diffBottom.top);\n      }\n    }\n  } else {\n    if (!onlyScrollIfNeeded) {\n      alignWithTop = alignWithTop === undefined ? true : !!alignWithTop;\n      if (alignWithTop) {\n        util.scrollTop(container, containerScroll.top + diffTop.top);\n      } else {\n        util.scrollTop(container, containerScroll.top + diffBottom.top);\n      }\n    }\n  }\n\n  if (allowHorizontalScroll) {\n    if (diffTop.left < 0 || diffBottom.left > 0) {\n      // 强制向上\n      if (alignWithLeft === true) {\n        util.scrollLeft(container, containerScroll.left + diffTop.left);\n      } else if (alignWithLeft === false) {\n        util.scrollLeft(container, containerScroll.left + diffBottom.left);\n      } else {\n        // 自动调整\n        if (diffTop.left < 0) {\n          util.scrollLeft(container, containerScroll.left + diffTop.left);\n        } else {\n          util.scrollLeft(container, containerScroll.left + diffBottom.left);\n        }\n      }\n    } else {\n      if (!onlyScrollIfNeeded) {\n        alignWithLeft = alignWithLeft === undefined ? true : !!alignWithLeft;\n        if (alignWithLeft) {\n          util.scrollLeft(container, containerScroll.left + diffTop.left);\n        } else {\n          util.scrollLeft(container, containerScroll.left + diffBottom.left);\n        }\n      }\n    }\n  }\n}\n\nmodule.exports = scrollIntoView;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/dom-scroll-into-view/lib/dom-scroll-into-view.js\n// module id = 16\n// module chunks = 0","'use strict';\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar RE_NUM = /[\\-+]?(?:\\d*\\.|)\\d+(?:[eE][\\-+]?\\d+|)/.source;\n\nfunction getClientPosition(elem) {\n  var box = undefined;\n  var x = undefined;\n  var y = undefined;\n  var doc = elem.ownerDocument;\n  var body = doc.body;\n  var docElem = doc && doc.documentElement;\n  // 根据 GBS 最新数据，A-Grade Browsers 都已支持 getBoundingClientRect 方法，不用再考虑传统的实现方式\n  box = elem.getBoundingClientRect();\n\n  // 注：jQuery 还考虑减去 docElem.clientLeft/clientTop\n  // 但测试发现，这样反而会导致当 html 和 body 有边距/边框样式时，获取的值不正确\n  // 此外，ie6 会忽略 html 的 margin 值，幸运地是没有谁会去设置 html 的 margin\n\n  x = box.left;\n  y = box.top;\n\n  // In IE, most of the time, 2 extra pixels are added to the top and left\n  // due to the implicit 2-pixel inset border.  In IE6/7 quirks mode and\n  // IE6 standards mode, this border can be overridden by setting the\n  // document element's border to zero -- thus, we cannot rely on the\n  // offset always being 2 pixels.\n\n  // In quirks mode, the offset can be determined by querying the body's\n  // clientLeft/clientTop, but in standards mode, it is found by querying\n  // the document element's clientLeft/clientTop.  Since we already called\n  // getClientBoundingRect we have already forced a reflow, so it is not\n  // too expensive just to query them all.\n\n  // ie 下应该减去窗口的边框吧，毕竟默认 absolute 都是相对窗口定位的\n  // 窗口边框标准是设 documentElement ,quirks 时设置 body\n  // 最好禁止在 body 和 html 上边框 ，但 ie < 9 html 默认有 2px ，减去\n  // 但是非 ie 不可能设置窗口边框，body html 也不是窗口 ,ie 可以通过 html,body 设置\n  // 标准 ie 下 docElem.clientTop 就是 border-top\n  // ie7 html 即窗口边框改变不了。永远为 2\n  // 但标准 firefox/chrome/ie9 下 docElem.clientTop 是窗口边框，即使设了 border-top 也为 0\n\n  x -= docElem.clientLeft || body.clientLeft || 0;\n  y -= docElem.clientTop || body.clientTop || 0;\n\n  return {\n    left: x,\n    top: y\n  };\n}\n\nfunction getScroll(w, top) {\n  var ret = w['page' + (top ? 'Y' : 'X') + 'Offset'];\n  var method = 'scroll' + (top ? 'Top' : 'Left');\n  if (typeof ret !== 'number') {\n    var d = w.document;\n    // ie6,7,8 standard mode\n    ret = d.documentElement[method];\n    if (typeof ret !== 'number') {\n      // quirks mode\n      ret = d.body[method];\n    }\n  }\n  return ret;\n}\n\nfunction getScrollLeft(w) {\n  return getScroll(w);\n}\n\nfunction getScrollTop(w) {\n  return getScroll(w, true);\n}\n\nfunction getOffset(el) {\n  var pos = getClientPosition(el);\n  var doc = el.ownerDocument;\n  var w = doc.defaultView || doc.parentWindow;\n  pos.left += getScrollLeft(w);\n  pos.top += getScrollTop(w);\n  return pos;\n}\nfunction _getComputedStyle(elem, name, computedStyle_) {\n  var val = '';\n  var d = elem.ownerDocument;\n  var computedStyle = computedStyle_ || d.defaultView.getComputedStyle(elem, null);\n\n  // https://github.com/kissyteam/kissy/issues/61\n  if (computedStyle) {\n    val = computedStyle.getPropertyValue(name) || computedStyle[name];\n  }\n\n  return val;\n}\n\nvar _RE_NUM_NO_PX = new RegExp('^(' + RE_NUM + ')(?!px)[a-z%]+$', 'i');\nvar RE_POS = /^(top|right|bottom|left)$/;\nvar CURRENT_STYLE = 'currentStyle';\nvar RUNTIME_STYLE = 'runtimeStyle';\nvar LEFT = 'left';\nvar PX = 'px';\n\nfunction _getComputedStyleIE(elem, name) {\n  // currentStyle maybe null\n  // http://msdn.microsoft.com/en-us/library/ms535231.aspx\n  var ret = elem[CURRENT_STYLE] && elem[CURRENT_STYLE][name];\n\n  // 当 width/height 设置为百分比时，通过 pixelLeft 方式转换的 width/height 值\n  // 一开始就处理了! CUSTOM_STYLE.height,CUSTOM_STYLE.width ,cssHook 解决@2011-08-19\n  // 在 ie 下不对，需要直接用 offset 方式\n  // borderWidth 等值也有问题，但考虑到 borderWidth 设为百分比的概率很小，这里就不考虑了\n\n  // From the awesome hack by Dean Edwards\n  // http://erik.eae.net/archives/2007/07/27/18.54.15/#comment-102291\n  // If we're not dealing with a regular pixel number\n  // but a number that has a weird ending, we need to convert it to pixels\n  // exclude left right for relativity\n  if (_RE_NUM_NO_PX.test(ret) && !RE_POS.test(name)) {\n    // Remember the original values\n    var style = elem.style;\n    var left = style[LEFT];\n    var rsLeft = elem[RUNTIME_STYLE][LEFT];\n\n    // prevent flashing of content\n    elem[RUNTIME_STYLE][LEFT] = elem[CURRENT_STYLE][LEFT];\n\n    // Put in the new values to get a computed value out\n    style[LEFT] = name === 'fontSize' ? '1em' : ret || 0;\n    ret = style.pixelLeft + PX;\n\n    // Revert the changed values\n    style[LEFT] = left;\n\n    elem[RUNTIME_STYLE][LEFT] = rsLeft;\n  }\n  return ret === '' ? 'auto' : ret;\n}\n\nvar getComputedStyleX = undefined;\nif (typeof window !== 'undefined') {\n  getComputedStyleX = window.getComputedStyle ? _getComputedStyle : _getComputedStyleIE;\n}\n\nfunction each(arr, fn) {\n  for (var i = 0; i < arr.length; i++) {\n    fn(arr[i]);\n  }\n}\n\nfunction isBorderBoxFn(elem) {\n  return getComputedStyleX(elem, 'boxSizing') === 'border-box';\n}\n\nvar BOX_MODELS = ['margin', 'border', 'padding'];\nvar CONTENT_INDEX = -1;\nvar PADDING_INDEX = 2;\nvar BORDER_INDEX = 1;\nvar MARGIN_INDEX = 0;\n\nfunction swap(elem, options, callback) {\n  var old = {};\n  var style = elem.style;\n  var name = undefined;\n\n  // Remember the old values, and insert the new ones\n  for (name in options) {\n    if (options.hasOwnProperty(name)) {\n      old[name] = style[name];\n      style[name] = options[name];\n    }\n  }\n\n  callback.call(elem);\n\n  // Revert the old values\n  for (name in options) {\n    if (options.hasOwnProperty(name)) {\n      style[name] = old[name];\n    }\n  }\n}\n\nfunction getPBMWidth(elem, props, which) {\n  var value = 0;\n  var prop = undefined;\n  var j = undefined;\n  var i = undefined;\n  for (j = 0; j < props.length; j++) {\n    prop = props[j];\n    if (prop) {\n      for (i = 0; i < which.length; i++) {\n        var cssProp = undefined;\n        if (prop === 'border') {\n          cssProp = prop + which[i] + 'Width';\n        } else {\n          cssProp = prop + which[i];\n        }\n        value += parseFloat(getComputedStyleX(elem, cssProp)) || 0;\n      }\n    }\n  }\n  return value;\n}\n\n/**\n * A crude way of determining if an object is a window\n * @member util\n */\nfunction isWindow(obj) {\n  // must use == for ie8\n  /* eslint eqeqeq:0 */\n  return obj != null && obj == obj.window;\n}\n\nvar domUtils = {};\n\neach(['Width', 'Height'], function (name) {\n  domUtils['doc' + name] = function (refWin) {\n    var d = refWin.document;\n    return Math.max(\n    // firefox chrome documentElement.scrollHeight< body.scrollHeight\n    // ie standard mode : documentElement.scrollHeight> body.scrollHeight\n    d.documentElement['scroll' + name],\n    // quirks : documentElement.scrollHeight 最大等于可视窗口多一点？\n    d.body['scroll' + name], domUtils['viewport' + name](d));\n  };\n\n  domUtils['viewport' + name] = function (win) {\n    // pc browser includes scrollbar in window.innerWidth\n    var prop = 'client' + name;\n    var doc = win.document;\n    var body = doc.body;\n    var documentElement = doc.documentElement;\n    var documentElementProp = documentElement[prop];\n    // 标准模式取 documentElement\n    // backcompat 取 body\n    return doc.compatMode === 'CSS1Compat' && documentElementProp || body && body[prop] || documentElementProp;\n  };\n});\n\n/*\n 得到元素的大小信息\n @param elem\n @param name\n @param {String} [extra]  'padding' : (css width) + padding\n 'border' : (css width) + padding + border\n 'margin' : (css width) + padding + border + margin\n */\nfunction getWH(elem, name, extra) {\n  if (isWindow(elem)) {\n    return name === 'width' ? domUtils.viewportWidth(elem) : domUtils.viewportHeight(elem);\n  } else if (elem.nodeType === 9) {\n    return name === 'width' ? domUtils.docWidth(elem) : domUtils.docHeight(elem);\n  }\n  var which = name === 'width' ? ['Left', 'Right'] : ['Top', 'Bottom'];\n  var borderBoxValue = name === 'width' ? elem.offsetWidth : elem.offsetHeight;\n  var computedStyle = getComputedStyleX(elem);\n  var isBorderBox = isBorderBoxFn(elem, computedStyle);\n  var cssBoxValue = 0;\n  if (borderBoxValue == null || borderBoxValue <= 0) {\n    borderBoxValue = undefined;\n    // Fall back to computed then un computed css if necessary\n    cssBoxValue = getComputedStyleX(elem, name);\n    if (cssBoxValue == null || Number(cssBoxValue) < 0) {\n      cssBoxValue = elem.style[name] || 0;\n    }\n    // Normalize '', auto, and prepare for extra\n    cssBoxValue = parseFloat(cssBoxValue) || 0;\n  }\n  if (extra === undefined) {\n    extra = isBorderBox ? BORDER_INDEX : CONTENT_INDEX;\n  }\n  var borderBoxValueOrIsBorderBox = borderBoxValue !== undefined || isBorderBox;\n  var val = borderBoxValue || cssBoxValue;\n  if (extra === CONTENT_INDEX) {\n    if (borderBoxValueOrIsBorderBox) {\n      return val - getPBMWidth(elem, ['border', 'padding'], which, computedStyle);\n    }\n    return cssBoxValue;\n  }\n  if (borderBoxValueOrIsBorderBox) {\n    var padding = extra === PADDING_INDEX ? -getPBMWidth(elem, ['border'], which, computedStyle) : getPBMWidth(elem, ['margin'], which, computedStyle);\n    return val + (extra === BORDER_INDEX ? 0 : padding);\n  }\n  return cssBoxValue + getPBMWidth(elem, BOX_MODELS.slice(extra), which, computedStyle);\n}\n\nvar cssShow = {\n  position: 'absolute',\n  visibility: 'hidden',\n  display: 'block'\n};\n\n// fix #119 : https://github.com/kissyteam/kissy/issues/119\nfunction getWHIgnoreDisplay(elem) {\n  var val = undefined;\n  var args = arguments;\n  // in case elem is window\n  // elem.offsetWidth === undefined\n  if (elem.offsetWidth !== 0) {\n    val = getWH.apply(undefined, args);\n  } else {\n    swap(elem, cssShow, function () {\n      val = getWH.apply(undefined, args);\n    });\n  }\n  return val;\n}\n\nfunction css(el, name, v) {\n  var value = v;\n  if ((typeof name === 'undefined' ? 'undefined' : _typeof(name)) === 'object') {\n    for (var i in name) {\n      if (name.hasOwnProperty(i)) {\n        css(el, i, name[i]);\n      }\n    }\n    return undefined;\n  }\n  if (typeof value !== 'undefined') {\n    if (typeof value === 'number') {\n      value += 'px';\n    }\n    el.style[name] = value;\n    return undefined;\n  }\n  return getComputedStyleX(el, name);\n}\n\neach(['width', 'height'], function (name) {\n  var first = name.charAt(0).toUpperCase() + name.slice(1);\n  domUtils['outer' + first] = function (el, includeMargin) {\n    return el && getWHIgnoreDisplay(el, name, includeMargin ? MARGIN_INDEX : BORDER_INDEX);\n  };\n  var which = name === 'width' ? ['Left', 'Right'] : ['Top', 'Bottom'];\n\n  domUtils[name] = function (elem, val) {\n    if (val !== undefined) {\n      if (elem) {\n        var computedStyle = getComputedStyleX(elem);\n        var isBorderBox = isBorderBoxFn(elem);\n        if (isBorderBox) {\n          val += getPBMWidth(elem, ['padding', 'border'], which, computedStyle);\n        }\n        return css(elem, name, val);\n      }\n      return undefined;\n    }\n    return elem && getWHIgnoreDisplay(elem, name, CONTENT_INDEX);\n  };\n});\n\n// 设置 elem 相对 elem.ownerDocument 的坐标\nfunction setOffset(elem, offset) {\n  // set position first, in-case top/left are set even on static elem\n  if (css(elem, 'position') === 'static') {\n    elem.style.position = 'relative';\n  }\n\n  var old = getOffset(elem);\n  var ret = {};\n  var current = undefined;\n  var key = undefined;\n\n  for (key in offset) {\n    if (offset.hasOwnProperty(key)) {\n      current = parseFloat(css(elem, key)) || 0;\n      ret[key] = current + offset[key] - old[key];\n    }\n  }\n  css(elem, ret);\n}\n\nmodule.exports = _extends({\n  getWindow: function getWindow(node) {\n    var doc = node.ownerDocument || node;\n    return doc.defaultView || doc.parentWindow;\n  },\n  offset: function offset(el, value) {\n    if (typeof value !== 'undefined') {\n      setOffset(el, value);\n    } else {\n      return getOffset(el);\n    }\n  },\n\n  isWindow: isWindow,\n  each: each,\n  css: css,\n  clone: function clone(obj) {\n    var ret = {};\n    for (var i in obj) {\n      if (obj.hasOwnProperty(i)) {\n        ret[i] = obj[i];\n      }\n    }\n    var overflow = obj.overflow;\n    if (overflow) {\n      for (var i in obj) {\n        if (obj.hasOwnProperty(i)) {\n          ret.overflow[i] = obj.overflow[i];\n        }\n      }\n    }\n    return ret;\n  },\n  scrollLeft: function scrollLeft(w, v) {\n    if (isWindow(w)) {\n      if (v === undefined) {\n        return getScrollLeft(w);\n      }\n      window.scrollTo(v, getScrollTop(w));\n    } else {\n      if (v === undefined) {\n        return w.scrollLeft;\n      }\n      w.scrollLeft = v;\n    }\n  },\n  scrollTop: function scrollTop(w, v) {\n    if (isWindow(w)) {\n      if (v === undefined) {\n        return getScrollTop(w);\n      }\n      window.scrollTo(getScrollLeft(w), v);\n    } else {\n      if (v === undefined) {\n        return w.scrollTop;\n      }\n      w.scrollTop = v;\n    }\n  },\n\n  viewportWidth: 0,\n  viewportHeight: 0\n}, domUtils);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/dom-scroll-into-view/lib/util.js\n// module id = 17\n// module chunks = 0"],"sourceRoot":""}